{"version":3,"file":"C3bkP_Kp.js","sources":["../../../../../../node_modules/svelte/src/runtime/internal/each.js","../../../../../../node_modules/nostr-tools/node_modules/@noble/curves/node_modules/@noble/hashes/esm/_assert.js","../../../../../../node_modules/nostr-tools/node_modules/@noble/curves/node_modules/@noble/hashes/esm/crypto.js","../../../../../../node_modules/nostr-tools/node_modules/@noble/curves/node_modules/@noble/hashes/esm/utils.js","../../../../../../node_modules/nostr-tools/node_modules/@noble/curves/node_modules/@noble/hashes/esm/_sha2.js","../../../../../../node_modules/nostr-tools/node_modules/@noble/curves/node_modules/@noble/hashes/esm/sha256.js","../../../../../../node_modules/nostr-tools/node_modules/@noble/curves/esm/abstract/utils.js","../../../../../../node_modules/nostr-tools/node_modules/@noble/curves/esm/abstract/modular.js","../../../../../../node_modules/nostr-tools/node_modules/@noble/curves/esm/abstract/curve.js","../../../../../../node_modules/nostr-tools/node_modules/@noble/curves/esm/abstract/weierstrass.js","../../../../../../node_modules/nostr-tools/node_modules/@noble/curves/node_modules/@noble/hashes/esm/hmac.js","../../../../../../node_modules/nostr-tools/node_modules/@noble/curves/esm/_shortw_utils.js","../../../../../../node_modules/nostr-tools/node_modules/@noble/curves/esm/secp256k1.js","../../../../../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/crypto.js","../../../../../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/utils.js","../../../../../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/_assert.js","../../../../../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/_sha2.js","../../../../../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/sha256.js","../../../../../../node_modules/nostr-tools/node_modules/@scure/base/lib/esm/index.js","../../../../../../node_modules/@noble/ciphers/esm/_assert.js","../../../../../../node_modules/@noble/ciphers/esm/utils.js","../../../../../../node_modules/@noble/ciphers/esm/aes.js","../../../../../../node_modules/@noble/ciphers/esm/_poly1305.js","../../../../../../node_modules/@noble/ciphers/esm/_arx.js","../../../../../../node_modules/@noble/ciphers/esm/chacha.js","../../../../../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/hmac.js","../../../../../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/hkdf.js","../../../../../../node_modules/nostr-tools/lib/esm/index.js"],"sourcesContent":["import { transition_in, transition_out } from './transitions.js';\nimport { run_all } from './utils.js';\n\n// general each functions:\n\nexport function ensure_array_like(array_like_or_iterator) {\n\treturn array_like_or_iterator?.length !== undefined\n\t\t? array_like_or_iterator\n\t\t: Array.from(array_like_or_iterator);\n}\n\n// keyed each functions:\n\n/** @returns {void} */\nexport function destroy_block(block, lookup) {\n\tblock.d(1);\n\tlookup.delete(block.key);\n}\n\n/** @returns {void} */\nexport function outro_and_destroy_block(block, lookup) {\n\ttransition_out(block, 1, 1, () => {\n\t\tlookup.delete(block.key);\n\t});\n}\n\n/** @returns {void} */\nexport function fix_and_destroy_block(block, lookup) {\n\tblock.f();\n\tdestroy_block(block, lookup);\n}\n\n/** @returns {void} */\nexport function fix_and_outro_and_destroy_block(block, lookup) {\n\tblock.f();\n\toutro_and_destroy_block(block, lookup);\n}\n\n/** @returns {any[]} */\nexport function update_keyed_each(\n\told_blocks,\n\tdirty,\n\tget_key,\n\tdynamic,\n\tctx,\n\tlist,\n\tlookup,\n\tnode,\n\tdestroy,\n\tcreate_each_block,\n\tnext,\n\tget_context\n) {\n\tlet o = old_blocks.length;\n\tlet n = list.length;\n\tlet i = o;\n\tconst old_indexes = {};\n\twhile (i--) old_indexes[old_blocks[i].key] = i;\n\tconst new_blocks = [];\n\tconst new_lookup = new Map();\n\tconst deltas = new Map();\n\tconst updates = [];\n\ti = n;\n\twhile (i--) {\n\t\tconst child_ctx = get_context(ctx, list, i);\n\t\tconst key = get_key(child_ctx);\n\t\tlet block = lookup.get(key);\n\t\tif (!block) {\n\t\t\tblock = create_each_block(key, child_ctx);\n\t\t\tblock.c();\n\t\t} else if (dynamic) {\n\t\t\t// defer updates until all the DOM shuffling is done\n\t\t\tupdates.push(() => block.p(child_ctx, dirty));\n\t\t}\n\t\tnew_lookup.set(key, (new_blocks[i] = block));\n\t\tif (key in old_indexes) deltas.set(key, Math.abs(i - old_indexes[key]));\n\t}\n\tconst will_move = new Set();\n\tconst did_move = new Set();\n\t/** @returns {void} */\n\tfunction insert(block) {\n\t\ttransition_in(block, 1);\n\t\tblock.m(node, next);\n\t\tlookup.set(block.key, block);\n\t\tnext = block.first;\n\t\tn--;\n\t}\n\twhile (o && n) {\n\t\tconst new_block = new_blocks[n - 1];\n\t\tconst old_block = old_blocks[o - 1];\n\t\tconst new_key = new_block.key;\n\t\tconst old_key = old_block.key;\n\t\tif (new_block === old_block) {\n\t\t\t// do nothing\n\t\t\tnext = new_block.first;\n\t\t\to--;\n\t\t\tn--;\n\t\t} else if (!new_lookup.has(old_key)) {\n\t\t\t// remove old block\n\t\t\tdestroy(old_block, lookup);\n\t\t\to--;\n\t\t} else if (!lookup.has(new_key) || will_move.has(new_key)) {\n\t\t\tinsert(new_block);\n\t\t} else if (did_move.has(old_key)) {\n\t\t\to--;\n\t\t} else if (deltas.get(new_key) > deltas.get(old_key)) {\n\t\t\tdid_move.add(new_key);\n\t\t\tinsert(new_block);\n\t\t} else {\n\t\t\twill_move.add(old_key);\n\t\t\to--;\n\t\t}\n\t}\n\twhile (o--) {\n\t\tconst old_block = old_blocks[o];\n\t\tif (!new_lookup.has(old_block.key)) destroy(old_block, lookup);\n\t}\n\twhile (n) insert(new_blocks[n - 1]);\n\trun_all(updates);\n\treturn new_blocks;\n}\n\n/** @returns {void} */\nexport function validate_each_keys(ctx, list, get_context, get_key) {\n\tconst keys = new Map();\n\tfor (let i = 0; i < list.length; i++) {\n\t\tconst key = get_key(get_context(ctx, list, i));\n\t\tif (keys.has(key)) {\n\t\t\tlet value = '';\n\t\t\ttry {\n\t\t\t\tvalue = `with value '${String(key)}' `;\n\t\t\t} catch (e) {\n\t\t\t\t// can't stringify\n\t\t\t}\n\t\t\tthrow new Error(\n\t\t\t\t`Cannot have duplicate keys in a keyed each: Keys at index ${keys.get(\n\t\t\t\t\tkey\n\t\t\t\t)} and ${i} ${value}are duplicates`\n\t\t\t);\n\t\t}\n\t\tkeys.set(key, i);\n\t}\n}\n","function number(n) {\n    if (!Number.isSafeInteger(n) || n < 0)\n        throw new Error(`Wrong positive integer: ${n}`);\n}\nfunction bool(b) {\n    if (typeof b !== 'boolean')\n        throw new Error(`Expected boolean, not ${b}`);\n}\nfunction bytes(b, ...lengths) {\n    if (!(b instanceof Uint8Array))\n        throw new Error('Expected Uint8Array');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error(`Expected Uint8Array of length ${lengths}, not of length=${b.length}`);\n}\nfunction hash(hash) {\n    if (typeof hash !== 'function' || typeof hash.create !== 'function')\n        throw new Error('Hash should be wrapped by utils.wrapConstructor');\n    number(hash.outputLen);\n    number(hash.blockLen);\n}\nfunction exists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error('Hash instance has been destroyed');\n    if (checkFinished && instance.finished)\n        throw new Error('Hash#digest() has already been called');\n}\nfunction output(out, instance) {\n    bytes(out);\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error(`digestInto() expects output buffer of length at least ${min}`);\n    }\n}\nexport { number, bool, bytes, hash, exists, output };\nconst assert = { number, bool, bytes, hash, exists, output };\nexport default assert;\n//# sourceMappingURL=_assert.js.map","export const crypto = typeof globalThis === 'object' && 'crypto' in globalThis ? globalThis.crypto : undefined;\n//# sourceMappingURL=crypto.js.map","/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated, we can just drop the import.\nimport { crypto } from '@noble/hashes/crypto';\nconst u8a = (a) => a instanceof Uint8Array;\n// Cast array to different type\nexport const u8 = (arr) => new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\nexport const u32 = (arr) => new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n// Cast array to view\nexport const createView = (arr) => new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n// The rotate right (circular right shift) operation for uint32\nexport const rotr = (word, shift) => (word << (32 - shift)) | (word >>> shift);\n// big-endian hardware is rare. Just in case someone still decides to run hashes:\n// early-throw an error because we don't support BE yet.\nexport const isLE = new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44;\nif (!isLE)\n    throw new Error('Non little-endian hardware is not supported');\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const len = hex.length;\n    if (len % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + len);\n    const array = new Uint8Array(len / 2);\n    for (let i = 0; i < array.length; i++) {\n        const j = i * 2;\n        const hexByte = hex.slice(j, j + 2);\n        const byte = Number.parseInt(hexByte, 16);\n        if (Number.isNaN(byte) || byte < 0)\n            throw new Error('Invalid byte sequence');\n        array[i] = byte;\n    }\n    return array;\n}\n// There is no setImmediate in browser and setTimeout is slow.\n// call of async fn will return Promise, which will be fullfiled only on\n// next scheduler queue processing step and this is exactly what we need.\nexport const nextTick = async () => { };\n// Returns control to thread each 'tick' ms to avoid blocking\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    if (!u8a(data))\n        throw new Error(`expected Uint8Array, got ${typeof data}`);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    const r = new Uint8Array(arrays.reduce((sum, a) => sum + a.length, 0));\n    let pad = 0; // walk through each item, ensure they have proper type\n    arrays.forEach((a) => {\n        if (!u8a(a))\n            throw new Error('Uint8Array expected');\n        r.set(a, pad);\n        pad += a.length;\n    });\n    return r;\n}\n// For runtime check if class implements interface\nexport class Hash {\n    // Safe version that clones internal state\n    clone() {\n        return this._cloneInto();\n    }\n}\nconst toStr = {}.toString;\nexport function checkOpts(defaults, opts) {\n    if (opts !== undefined && toStr.call(opts) !== '[object Object]')\n        throw new Error('Options should be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\nexport function wrapConstructor(hashCons) {\n    const hashC = (msg) => hashCons().update(toBytes(msg)).digest();\n    const tmp = hashCons();\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = () => hashCons();\n    return hashC;\n}\nexport function wrapConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\nexport function wrapXOFConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\n/**\n * Secure PRNG. Uses `crypto.getRandomValues`, which defers to OS.\n */\nexport function randomBytes(bytesLength = 32) {\n    if (crypto && typeof crypto.getRandomValues === 'function') {\n        return crypto.getRandomValues(new Uint8Array(bytesLength));\n    }\n    throw new Error('crypto.getRandomValues must be defined');\n}\n//# sourceMappingURL=utils.js.map","import { exists, output } from './_assert.js';\nimport { Hash, createView, toBytes } from './utils.js';\n// Polyfill for Safari 14\nfunction setBigUint64(view, byteOffset, value, isLE) {\n    if (typeof view.setBigUint64 === 'function')\n        return view.setBigUint64(byteOffset, value, isLE);\n    const _32n = BigInt(32);\n    const _u32_max = BigInt(0xffffffff);\n    const wh = Number((value >> _32n) & _u32_max);\n    const wl = Number(value & _u32_max);\n    const h = isLE ? 4 : 0;\n    const l = isLE ? 0 : 4;\n    view.setUint32(byteOffset + h, wh, isLE);\n    view.setUint32(byteOffset + l, wl, isLE);\n}\n// Base SHA2 class (RFC 6234)\nexport class SHA2 extends Hash {\n    constructor(blockLen, outputLen, padOffset, isLE) {\n        super();\n        this.blockLen = blockLen;\n        this.outputLen = outputLen;\n        this.padOffset = padOffset;\n        this.isLE = isLE;\n        this.finished = false;\n        this.length = 0;\n        this.pos = 0;\n        this.destroyed = false;\n        this.buffer = new Uint8Array(blockLen);\n        this.view = createView(this.buffer);\n    }\n    update(data) {\n        exists(this);\n        const { view, buffer, blockLen } = this;\n        data = toBytes(data);\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input, cast it to view and process\n            if (take === blockLen) {\n                const dataView = createView(data);\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(dataView, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(view, 0);\n                this.pos = 0;\n            }\n        }\n        this.length += data.length;\n        this.roundClean();\n        return this;\n    }\n    digestInto(out) {\n        exists(this);\n        output(out, this);\n        this.finished = true;\n        // Padding\n        // We can avoid allocation of buffer for padding completely if it\n        // was previously not allocated here. But it won't change performance.\n        const { buffer, view, blockLen, isLE } = this;\n        let { pos } = this;\n        // append the bit '1' to the message\n        buffer[pos++] = 0b10000000;\n        this.buffer.subarray(pos).fill(0);\n        // we have less than padOffset left in buffer, so we cannot put length in current block, need process it and pad again\n        if (this.padOffset > blockLen - pos) {\n            this.process(view, 0);\n            pos = 0;\n        }\n        // Pad until full block byte with zeros\n        for (let i = pos; i < blockLen; i++)\n            buffer[i] = 0;\n        // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that\n        // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.\n        // So we just write lowest 64 bits of that value.\n        setBigUint64(view, blockLen - 8, BigInt(this.length * 8), isLE);\n        this.process(view, 0);\n        const oview = createView(out);\n        const len = this.outputLen;\n        // NOTE: we do division by 4 later, which should be fused in single op with modulo by JIT\n        if (len % 4)\n            throw new Error('_sha2: outputLen should be aligned to 32bit');\n        const outLen = len / 4;\n        const state = this.get();\n        if (outLen > state.length)\n            throw new Error('_sha2: outputLen bigger than state');\n        for (let i = 0; i < outLen; i++)\n            oview.setUint32(4 * i, state[i], isLE);\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n    _cloneInto(to) {\n        to || (to = new this.constructor());\n        to.set(...this.get());\n        const { blockLen, buffer, length, finished, destroyed, pos } = this;\n        to.length = length;\n        to.pos = pos;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        if (length % blockLen)\n            to.buffer.set(buffer);\n        return to;\n    }\n}\n//# sourceMappingURL=_sha2.js.map","import { SHA2 } from './_sha2.js';\nimport { rotr, wrapConstructor } from './utils.js';\n// SHA2-256 need to try 2^128 hashes to execute birthday attack.\n// BTC network is doing 2^67 hashes/sec as per early 2023.\n// Choice: a ? b : c\nconst Chi = (a, b, c) => (a & b) ^ (~a & c);\n// Majority function, true if any two inpust is true\nconst Maj = (a, b, c) => (a & b) ^ (a & c) ^ (b & c);\n// Round constants:\n// first 32 bits of the fractional parts of the cube roots of the first 64 primes 2..311)\n// prettier-ignore\nconst SHA256_K = /* @__PURE__ */ new Uint32Array([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\n// Initial state (first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19):\n// prettier-ignore\nconst IV = /* @__PURE__ */ new Uint32Array([\n    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19\n]);\n// Temporary buffer, not used to store anything between runs\n// Named this way because it matches specification.\nconst SHA256_W = /* @__PURE__ */ new Uint32Array(64);\nclass SHA256 extends SHA2 {\n    constructor() {\n        super(64, 32, 8, false);\n        // We cannot use array here since array allows indexing by variable\n        // which means optimizer/compiler cannot use registers.\n        this.A = IV[0] | 0;\n        this.B = IV[1] | 0;\n        this.C = IV[2] | 0;\n        this.D = IV[3] | 0;\n        this.E = IV[4] | 0;\n        this.F = IV[5] | 0;\n        this.G = IV[6] | 0;\n        this.H = IV[7] | 0;\n    }\n    get() {\n        const { A, B, C, D, E, F, G, H } = this;\n        return [A, B, C, D, E, F, G, H];\n    }\n    // prettier-ignore\n    set(A, B, C, D, E, F, G, H) {\n        this.A = A | 0;\n        this.B = B | 0;\n        this.C = C | 0;\n        this.D = D | 0;\n        this.E = E | 0;\n        this.F = F | 0;\n        this.G = G | 0;\n        this.H = H | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4)\n            SHA256_W[i] = view.getUint32(offset, false);\n        for (let i = 16; i < 64; i++) {\n            const W15 = SHA256_W[i - 15];\n            const W2 = SHA256_W[i - 2];\n            const s0 = rotr(W15, 7) ^ rotr(W15, 18) ^ (W15 >>> 3);\n            const s1 = rotr(W2, 17) ^ rotr(W2, 19) ^ (W2 >>> 10);\n            SHA256_W[i] = (s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16]) | 0;\n        }\n        // Compression function main loop, 64 rounds\n        let { A, B, C, D, E, F, G, H } = this;\n        for (let i = 0; i < 64; i++) {\n            const sigma1 = rotr(E, 6) ^ rotr(E, 11) ^ rotr(E, 25);\n            const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const sigma0 = rotr(A, 2) ^ rotr(A, 13) ^ rotr(A, 22);\n            const T2 = (sigma0 + Maj(A, B, C)) | 0;\n            H = G;\n            G = F;\n            F = E;\n            E = (D + T1) | 0;\n            D = C;\n            C = B;\n            B = A;\n            A = (T1 + T2) | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        A = (A + this.A) | 0;\n        B = (B + this.B) | 0;\n        C = (C + this.C) | 0;\n        D = (D + this.D) | 0;\n        E = (E + this.E) | 0;\n        F = (F + this.F) | 0;\n        G = (G + this.G) | 0;\n        H = (H + this.H) | 0;\n        this.set(A, B, C, D, E, F, G, H);\n    }\n    roundClean() {\n        SHA256_W.fill(0);\n    }\n    destroy() {\n        this.set(0, 0, 0, 0, 0, 0, 0, 0);\n        this.buffer.fill(0);\n    }\n}\n// Constants from https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf\nclass SHA224 extends SHA256 {\n    constructor() {\n        super();\n        this.A = 0xc1059ed8 | 0;\n        this.B = 0x367cd507 | 0;\n        this.C = 0x3070dd17 | 0;\n        this.D = 0xf70e5939 | 0;\n        this.E = 0xffc00b31 | 0;\n        this.F = 0x68581511 | 0;\n        this.G = 0x64f98fa7 | 0;\n        this.H = 0xbefa4fa4 | 0;\n        this.outputLen = 28;\n    }\n}\n/**\n * SHA2-256 hash function\n * @param message - data that would be hashed\n */\nexport const sha256 = /* @__PURE__ */ wrapConstructor(() => new SHA256());\nexport const sha224 = /* @__PURE__ */ wrapConstructor(() => new SHA224());\n//# sourceMappingURL=sha256.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// 100 lines of code in the file are duplicated from noble-hashes (utils).\n// This is OK: `abstract` directory does not use noble-hashes.\n// User may opt-in into using different hashing library. This way, noble-hashes\n// won't be included into their bundle.\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\nconst _2n = BigInt(2);\nconst u8a = (a) => a instanceof Uint8Array;\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\nexport function numberToHexUnpadded(num) {\n    const hex = num.toString(16);\n    return hex.length & 1 ? `0${hex}` : hex;\n}\nexport function hexToNumber(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    // Big Endian\n    return BigInt(hex === '' ? '0' : `0x${hex}`);\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const len = hex.length;\n    if (len % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + len);\n    const array = new Uint8Array(len / 2);\n    for (let i = 0; i < array.length; i++) {\n        const j = i * 2;\n        const hexByte = hex.slice(j, j + 2);\n        const byte = Number.parseInt(hexByte, 16);\n        if (Number.isNaN(byte) || byte < 0)\n            throw new Error('Invalid byte sequence');\n        array[i] = byte;\n    }\n    return array;\n}\n// BE: Big Endian, LE: Little Endian\nexport function bytesToNumberBE(bytes) {\n    return hexToNumber(bytesToHex(bytes));\n}\nexport function bytesToNumberLE(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    return hexToNumber(bytesToHex(Uint8Array.from(bytes).reverse()));\n}\nexport function numberToBytesBE(n, len) {\n    return hexToBytes(n.toString(16).padStart(len * 2, '0'));\n}\nexport function numberToBytesLE(n, len) {\n    return numberToBytesBE(n, len).reverse();\n}\n// Unpadded, rarely used\nexport function numberToVarBytesBE(n) {\n    return hexToBytes(numberToHexUnpadded(n));\n}\n/**\n * Takes hex string or Uint8Array, converts to Uint8Array.\n * Validates output length.\n * Will throw error for other types.\n * @param title descriptive title for an error e.g. 'private key'\n * @param hex hex string or Uint8Array\n * @param expectedLength optional, will compare to result array's length\n * @returns\n */\nexport function ensureBytes(title, hex, expectedLength) {\n    let res;\n    if (typeof hex === 'string') {\n        try {\n            res = hexToBytes(hex);\n        }\n        catch (e) {\n            throw new Error(`${title} must be valid hex string, got \"${hex}\". Cause: ${e}`);\n        }\n    }\n    else if (u8a(hex)) {\n        // Uint8Array.from() instead of hash.slice() because node.js Buffer\n        // is instance of Uint8Array, and its slice() creates **mutable** copy\n        res = Uint8Array.from(hex);\n    }\n    else {\n        throw new Error(`${title} must be hex string or Uint8Array`);\n    }\n    const len = res.length;\n    if (typeof expectedLength === 'number' && len !== expectedLength)\n        throw new Error(`${title} expected ${expectedLength} bytes, got ${len}`);\n    return res;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    const r = new Uint8Array(arrays.reduce((sum, a) => sum + a.length, 0));\n    let pad = 0; // walk through each item, ensure they have proper type\n    arrays.forEach((a) => {\n        if (!u8a(a))\n            throw new Error('Uint8Array expected');\n        r.set(a, pad);\n        pad += a.length;\n    });\n    return r;\n}\nexport function equalBytes(b1, b2) {\n    // We don't care about timing attacks here\n    if (b1.length !== b2.length)\n        return false;\n    for (let i = 0; i < b1.length; i++)\n        if (b1[i] !== b2[i])\n            return false;\n    return true;\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n// Bit operations\n/**\n * Calculates amount of bits in a bigint.\n * Same as `n.toString(2).length`\n */\nexport function bitLen(n) {\n    let len;\n    for (len = 0; n > _0n; n >>= _1n, len += 1)\n        ;\n    return len;\n}\n/**\n * Gets single bit at position.\n * NOTE: first bit position is 0 (same as arrays)\n * Same as `!!+Array.from(n.toString(2)).reverse()[pos]`\n */\nexport function bitGet(n, pos) {\n    return (n >> BigInt(pos)) & _1n;\n}\n/**\n * Sets single bit at position.\n */\nexport const bitSet = (n, pos, value) => {\n    return n | ((value ? _1n : _0n) << BigInt(pos));\n};\n/**\n * Calculate mask for N bits. Not using ** operator with bigints because of old engines.\n * Same as BigInt(`0b${Array(i).fill('1').join('')}`)\n */\nexport const bitMask = (n) => (_2n << BigInt(n - 1)) - _1n;\n// DRBG\nconst u8n = (data) => new Uint8Array(data); // creates Uint8Array\nconst u8fr = (arr) => Uint8Array.from(arr); // another shortcut\n/**\n * Minimal HMAC-DRBG from NIST 800-90 for RFC6979 sigs.\n * @returns function that will call DRBG until 2nd arg returns something meaningful\n * @example\n *   const drbg = createHmacDRBG<Key>(32, 32, hmac);\n *   drbg(seed, bytesToKey); // bytesToKey must return Key or undefined\n */\nexport function createHmacDrbg(hashLen, qByteLen, hmacFn) {\n    if (typeof hashLen !== 'number' || hashLen < 2)\n        throw new Error('hashLen must be a number');\n    if (typeof qByteLen !== 'number' || qByteLen < 2)\n        throw new Error('qByteLen must be a number');\n    if (typeof hmacFn !== 'function')\n        throw new Error('hmacFn must be a function');\n    // Step B, Step C: set hashLen to 8*ceil(hlen/8)\n    let v = u8n(hashLen); // Minimal non-full-spec HMAC-DRBG from NIST 800-90 for RFC6979 sigs.\n    let k = u8n(hashLen); // Steps B and C of RFC6979 3.2: set hashLen, in our case always same\n    let i = 0; // Iterations counter, will throw when over 1000\n    const reset = () => {\n        v.fill(1);\n        k.fill(0);\n        i = 0;\n    };\n    const h = (...b) => hmacFn(k, v, ...b); // hmac(k)(v, ...values)\n    const reseed = (seed = u8n()) => {\n        // HMAC-DRBG reseed() function. Steps D-G\n        k = h(u8fr([0x00]), seed); // k = hmac(k || v || 0x00 || seed)\n        v = h(); // v = hmac(k || v)\n        if (seed.length === 0)\n            return;\n        k = h(u8fr([0x01]), seed); // k = hmac(k || v || 0x01 || seed)\n        v = h(); // v = hmac(k || v)\n    };\n    const gen = () => {\n        // HMAC-DRBG generate() function\n        if (i++ >= 1000)\n            throw new Error('drbg: tried 1000 values');\n        let len = 0;\n        const out = [];\n        while (len < qByteLen) {\n            v = h();\n            const sl = v.slice();\n            out.push(sl);\n            len += v.length;\n        }\n        return concatBytes(...out);\n    };\n    const genUntil = (seed, pred) => {\n        reset();\n        reseed(seed); // Steps D-G\n        let res = undefined; // Step H: grind until k is in [1..n-1]\n        while (!(res = pred(gen())))\n            reseed();\n        reset();\n        return res;\n    };\n    return genUntil;\n}\n// Validating curves and fields\nconst validatorFns = {\n    bigint: (val) => typeof val === 'bigint',\n    function: (val) => typeof val === 'function',\n    boolean: (val) => typeof val === 'boolean',\n    string: (val) => typeof val === 'string',\n    stringOrUint8Array: (val) => typeof val === 'string' || val instanceof Uint8Array,\n    isSafeInteger: (val) => Number.isSafeInteger(val),\n    array: (val) => Array.isArray(val),\n    field: (val, object) => object.Fp.isValid(val),\n    hash: (val) => typeof val === 'function' && Number.isSafeInteger(val.outputLen),\n};\n// type Record<K extends string | number | symbol, T> = { [P in K]: T; }\nexport function validateObject(object, validators, optValidators = {}) {\n    const checkField = (fieldName, type, isOptional) => {\n        const checkVal = validatorFns[type];\n        if (typeof checkVal !== 'function')\n            throw new Error(`Invalid validator \"${type}\", expected function`);\n        const val = object[fieldName];\n        if (isOptional && val === undefined)\n            return;\n        if (!checkVal(val, object)) {\n            throw new Error(`Invalid param ${String(fieldName)}=${val} (${typeof val}), expected ${type}`);\n        }\n    };\n    for (const [fieldName, type] of Object.entries(validators))\n        checkField(fieldName, type, false);\n    for (const [fieldName, type] of Object.entries(optValidators))\n        checkField(fieldName, type, true);\n    return object;\n}\n// validate type tests\n// const o: { a: number; b: number; c: number } = { a: 1, b: 5, c: 6 };\n// const z0 = validateObject(o, { a: 'isSafeInteger' }, { c: 'bigint' }); // Ok!\n// // Should fail type-check\n// const z1 = validateObject(o, { a: 'tmp' }, { c: 'zz' });\n// const z2 = validateObject(o, { a: 'isSafeInteger' }, { c: 'zz' });\n// const z3 = validateObject(o, { test: 'boolean', z: 'bug' });\n// const z4 = validateObject(o, { a: 'boolean', z: 'bug' });\n//# sourceMappingURL=utils.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Utilities for modular arithmetics and finite fields\nimport { bitMask, numberToBytesBE, numberToBytesLE, bytesToNumberBE, bytesToNumberLE, ensureBytes, validateObject, } from './utils.js';\n// prettier-ignore\nconst _0n = BigInt(0), _1n = BigInt(1), _2n = BigInt(2), _3n = BigInt(3);\n// prettier-ignore\nconst _4n = BigInt(4), _5n = BigInt(5), _8n = BigInt(8);\n// prettier-ignore\nconst _9n = BigInt(9), _16n = BigInt(16);\n// Calculates a modulo b\nexport function mod(a, b) {\n    const result = a % b;\n    return result >= _0n ? result : b + result;\n}\n/**\n * Efficiently raise num to power and do modular division.\n * Unsafe in some contexts: uses ladder, so can expose bigint bits.\n * @example\n * pow(2n, 6n, 11n) // 64n % 11n == 9n\n */\n// TODO: use field version && remove\nexport function pow(num, power, modulo) {\n    if (modulo <= _0n || power < _0n)\n        throw new Error('Expected power/modulo > 0');\n    if (modulo === _1n)\n        return _0n;\n    let res = _1n;\n    while (power > _0n) {\n        if (power & _1n)\n            res = (res * num) % modulo;\n        num = (num * num) % modulo;\n        power >>= _1n;\n    }\n    return res;\n}\n// Does x ^ (2 ^ power) mod p. pow2(30, 4) == 30 ^ (2 ^ 4)\nexport function pow2(x, power, modulo) {\n    let res = x;\n    while (power-- > _0n) {\n        res *= res;\n        res %= modulo;\n    }\n    return res;\n}\n// Inverses number over modulo\nexport function invert(number, modulo) {\n    if (number === _0n || modulo <= _0n) {\n        throw new Error(`invert: expected positive integers, got n=${number} mod=${modulo}`);\n    }\n    // Euclidean GCD https://brilliant.org/wiki/extended-euclidean-algorithm/\n    // Fermat's little theorem \"CT-like\" version inv(n) = n^(m-2) mod m is 30x slower.\n    let a = mod(number, modulo);\n    let b = modulo;\n    // prettier-ignore\n    let x = _0n, y = _1n, u = _1n, v = _0n;\n    while (a !== _0n) {\n        // JIT applies optimization if those two lines follow each other\n        const q = b / a;\n        const r = b % a;\n        const m = x - u * q;\n        const n = y - v * q;\n        // prettier-ignore\n        b = a, a = r, x = u, y = v, u = m, v = n;\n    }\n    const gcd = b;\n    if (gcd !== _1n)\n        throw new Error('invert: does not exist');\n    return mod(x, modulo);\n}\n/**\n * Tonelli-Shanks square root search algorithm.\n * 1. https://eprint.iacr.org/2012/685.pdf (page 12)\n * 2. Square Roots from 1; 24, 51, 10 to Dan Shanks\n * Will start an infinite loop if field order P is not prime.\n * @param P field order\n * @returns function that takes field Fp (created from P) and number n\n */\nexport function tonelliShanks(P) {\n    // Legendre constant: used to calculate Legendre symbol (a | p),\n    // which denotes the value of a^((p-1)/2) (mod p).\n    // (a | p) ≡ 1    if a is a square (mod p)\n    // (a | p) ≡ -1   if a is not a square (mod p)\n    // (a | p) ≡ 0    if a ≡ 0 (mod p)\n    const legendreC = (P - _1n) / _2n;\n    let Q, S, Z;\n    // Step 1: By factoring out powers of 2 from p - 1,\n    // find q and s such that p - 1 = q*(2^s) with q odd\n    for (Q = P - _1n, S = 0; Q % _2n === _0n; Q /= _2n, S++)\n        ;\n    // Step 2: Select a non-square z such that (z | p) ≡ -1 and set c ≡ zq\n    for (Z = _2n; Z < P && pow(Z, legendreC, P) !== P - _1n; Z++)\n        ;\n    // Fast-path\n    if (S === 1) {\n        const p1div4 = (P + _1n) / _4n;\n        return function tonelliFast(Fp, n) {\n            const root = Fp.pow(n, p1div4);\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // Slow-path\n    const Q1div2 = (Q + _1n) / _2n;\n    return function tonelliSlow(Fp, n) {\n        // Step 0: Check that n is indeed a square: (n | p) should not be ≡ -1\n        if (Fp.pow(n, legendreC) === Fp.neg(Fp.ONE))\n            throw new Error('Cannot find square root');\n        let r = S;\n        // TODO: will fail at Fp2/etc\n        let g = Fp.pow(Fp.mul(Fp.ONE, Z), Q); // will update both x and b\n        let x = Fp.pow(n, Q1div2); // first guess at the square root\n        let b = Fp.pow(n, Q); // first guess at the fudge factor\n        while (!Fp.eql(b, Fp.ONE)) {\n            if (Fp.eql(b, Fp.ZERO))\n                return Fp.ZERO; // https://en.wikipedia.org/wiki/Tonelli%E2%80%93Shanks_algorithm (4. If t = 0, return r = 0)\n            // Find m such b^(2^m)==1\n            let m = 1;\n            for (let t2 = Fp.sqr(b); m < r; m++) {\n                if (Fp.eql(t2, Fp.ONE))\n                    break;\n                t2 = Fp.sqr(t2); // t2 *= t2\n            }\n            // NOTE: r-m-1 can be bigger than 32, need to convert to bigint before shift, otherwise there will be overflow\n            const ge = Fp.pow(g, _1n << BigInt(r - m - 1)); // ge = 2^(r-m-1)\n            g = Fp.sqr(ge); // g = ge * ge\n            x = Fp.mul(x, ge); // x *= ge\n            b = Fp.mul(b, g); // b *= g\n            r = m;\n        }\n        return x;\n    };\n}\nexport function FpSqrt(P) {\n    // NOTE: different algorithms can give different roots, it is up to user to decide which one they want.\n    // For example there is FpSqrtOdd/FpSqrtEven to choice root based on oddness (used for hash-to-curve).\n    // P ≡ 3 (mod 4)\n    // √n = n^((P+1)/4)\n    if (P % _4n === _3n) {\n        // Not all roots possible!\n        // const ORDER =\n        //   0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn;\n        // const NUM = 72057594037927816n;\n        const p1div4 = (P + _1n) / _4n;\n        return function sqrt3mod4(Fp, n) {\n            const root = Fp.pow(n, p1div4);\n            // Throw if root**2 != n\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // Atkin algorithm for q ≡ 5 (mod 8), https://eprint.iacr.org/2012/685.pdf (page 10)\n    if (P % _8n === _5n) {\n        const c1 = (P - _5n) / _8n;\n        return function sqrt5mod8(Fp, n) {\n            const n2 = Fp.mul(n, _2n);\n            const v = Fp.pow(n2, c1);\n            const nv = Fp.mul(n, v);\n            const i = Fp.mul(Fp.mul(nv, _2n), v);\n            const root = Fp.mul(nv, Fp.sub(i, Fp.ONE));\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // P ≡ 9 (mod 16)\n    if (P % _16n === _9n) {\n        // NOTE: tonelli is too slow for bls-Fp2 calculations even on start\n        // Means we cannot use sqrt for constants at all!\n        //\n        // const c1 = Fp.sqrt(Fp.negate(Fp.ONE)); //  1. c1 = sqrt(-1) in F, i.e., (c1^2) == -1 in F\n        // const c2 = Fp.sqrt(c1);                //  2. c2 = sqrt(c1) in F, i.e., (c2^2) == c1 in F\n        // const c3 = Fp.sqrt(Fp.negate(c1));     //  3. c3 = sqrt(-c1) in F, i.e., (c3^2) == -c1 in F\n        // const c4 = (P + _7n) / _16n;           //  4. c4 = (q + 7) / 16        # Integer arithmetic\n        // sqrt = (x) => {\n        //   let tv1 = Fp.pow(x, c4);             //  1. tv1 = x^c4\n        //   let tv2 = Fp.mul(c1, tv1);           //  2. tv2 = c1 * tv1\n        //   const tv3 = Fp.mul(c2, tv1);         //  3. tv3 = c2 * tv1\n        //   let tv4 = Fp.mul(c3, tv1);           //  4. tv4 = c3 * tv1\n        //   const e1 = Fp.equals(Fp.square(tv2), x); //  5.  e1 = (tv2^2) == x\n        //   const e2 = Fp.equals(Fp.square(tv3), x); //  6.  e2 = (tv3^2) == x\n        //   tv1 = Fp.cmov(tv1, tv2, e1); //  7. tv1 = CMOV(tv1, tv2, e1)  # Select tv2 if (tv2^2) == x\n        //   tv2 = Fp.cmov(tv4, tv3, e2); //  8. tv2 = CMOV(tv4, tv3, e2)  # Select tv3 if (tv3^2) == x\n        //   const e3 = Fp.equals(Fp.square(tv2), x); //  9.  e3 = (tv2^2) == x\n        //   return Fp.cmov(tv1, tv2, e3); //  10.  z = CMOV(tv1, tv2, e3)  # Select the sqrt from tv1 and tv2\n        // }\n    }\n    // Other cases: Tonelli-Shanks algorithm\n    return tonelliShanks(P);\n}\n// Little-endian check for first LE bit (last BE bit);\nexport const isNegativeLE = (num, modulo) => (mod(num, modulo) & _1n) === _1n;\n// prettier-ignore\nconst FIELD_FIELDS = [\n    'create', 'isValid', 'is0', 'neg', 'inv', 'sqrt', 'sqr',\n    'eql', 'add', 'sub', 'mul', 'pow', 'div',\n    'addN', 'subN', 'mulN', 'sqrN'\n];\nexport function validateField(field) {\n    const initial = {\n        ORDER: 'bigint',\n        MASK: 'bigint',\n        BYTES: 'isSafeInteger',\n        BITS: 'isSafeInteger',\n    };\n    const opts = FIELD_FIELDS.reduce((map, val) => {\n        map[val] = 'function';\n        return map;\n    }, initial);\n    return validateObject(field, opts);\n}\n// Generic field functions\n/**\n * Same as `pow` but for Fp: non-constant-time.\n * Unsafe in some contexts: uses ladder, so can expose bigint bits.\n */\nexport function FpPow(f, num, power) {\n    // Should have same speed as pow for bigints\n    // TODO: benchmark!\n    if (power < _0n)\n        throw new Error('Expected power > 0');\n    if (power === _0n)\n        return f.ONE;\n    if (power === _1n)\n        return num;\n    let p = f.ONE;\n    let d = num;\n    while (power > _0n) {\n        if (power & _1n)\n            p = f.mul(p, d);\n        d = f.sqr(d);\n        power >>= _1n;\n    }\n    return p;\n}\n/**\n * Efficiently invert an array of Field elements.\n * `inv(0)` will return `undefined` here: make sure to throw an error.\n */\nexport function FpInvertBatch(f, nums) {\n    const tmp = new Array(nums.length);\n    // Walk from first to last, multiply them by each other MOD p\n    const lastMultiplied = nums.reduce((acc, num, i) => {\n        if (f.is0(num))\n            return acc;\n        tmp[i] = acc;\n        return f.mul(acc, num);\n    }, f.ONE);\n    // Invert last element\n    const inverted = f.inv(lastMultiplied);\n    // Walk from last to first, multiply them by inverted each other MOD p\n    nums.reduceRight((acc, num, i) => {\n        if (f.is0(num))\n            return acc;\n        tmp[i] = f.mul(acc, tmp[i]);\n        return f.mul(acc, num);\n    }, inverted);\n    return tmp;\n}\nexport function FpDiv(f, lhs, rhs) {\n    return f.mul(lhs, typeof rhs === 'bigint' ? invert(rhs, f.ORDER) : f.inv(rhs));\n}\n// This function returns True whenever the value x is a square in the field F.\nexport function FpIsSquare(f) {\n    const legendreConst = (f.ORDER - _1n) / _2n; // Integer arithmetic\n    return (x) => {\n        const p = f.pow(x, legendreConst);\n        return f.eql(p, f.ZERO) || f.eql(p, f.ONE);\n    };\n}\n// CURVE.n lengths\nexport function nLength(n, nBitLength) {\n    // Bit size, byte size of CURVE.n\n    const _nBitLength = nBitLength !== undefined ? nBitLength : n.toString(2).length;\n    const nByteLength = Math.ceil(_nBitLength / 8);\n    return { nBitLength: _nBitLength, nByteLength };\n}\n/**\n * Initializes a finite field over prime. **Non-primes are not supported.**\n * Do not init in loop: slow. Very fragile: always run a benchmark on a change.\n * Major performance optimizations:\n * * a) denormalized operations like mulN instead of mul\n * * b) same object shape: never add or remove keys\n * * c) Object.freeze\n * @param ORDER prime positive bigint\n * @param bitLen how many bits the field consumes\n * @param isLE (def: false) if encoding / decoding should be in little-endian\n * @param redef optional faster redefinitions of sqrt and other methods\n */\nexport function Field(ORDER, bitLen, isLE = false, redef = {}) {\n    if (ORDER <= _0n)\n        throw new Error(`Expected Field ORDER > 0, got ${ORDER}`);\n    const { nBitLength: BITS, nByteLength: BYTES } = nLength(ORDER, bitLen);\n    if (BYTES > 2048)\n        throw new Error('Field lengths over 2048 bytes are not supported');\n    const sqrtP = FpSqrt(ORDER);\n    const f = Object.freeze({\n        ORDER,\n        BITS,\n        BYTES,\n        MASK: bitMask(BITS),\n        ZERO: _0n,\n        ONE: _1n,\n        create: (num) => mod(num, ORDER),\n        isValid: (num) => {\n            if (typeof num !== 'bigint')\n                throw new Error(`Invalid field element: expected bigint, got ${typeof num}`);\n            return _0n <= num && num < ORDER; // 0 is valid element, but it's not invertible\n        },\n        is0: (num) => num === _0n,\n        isOdd: (num) => (num & _1n) === _1n,\n        neg: (num) => mod(-num, ORDER),\n        eql: (lhs, rhs) => lhs === rhs,\n        sqr: (num) => mod(num * num, ORDER),\n        add: (lhs, rhs) => mod(lhs + rhs, ORDER),\n        sub: (lhs, rhs) => mod(lhs - rhs, ORDER),\n        mul: (lhs, rhs) => mod(lhs * rhs, ORDER),\n        pow: (num, power) => FpPow(f, num, power),\n        div: (lhs, rhs) => mod(lhs * invert(rhs, ORDER), ORDER),\n        // Same as above, but doesn't normalize\n        sqrN: (num) => num * num,\n        addN: (lhs, rhs) => lhs + rhs,\n        subN: (lhs, rhs) => lhs - rhs,\n        mulN: (lhs, rhs) => lhs * rhs,\n        inv: (num) => invert(num, ORDER),\n        sqrt: redef.sqrt || ((n) => sqrtP(f, n)),\n        invertBatch: (lst) => FpInvertBatch(f, lst),\n        // TODO: do we really need constant cmov?\n        // We don't have const-time bigints anyway, so probably will be not very useful\n        cmov: (a, b, c) => (c ? b : a),\n        toBytes: (num) => (isLE ? numberToBytesLE(num, BYTES) : numberToBytesBE(num, BYTES)),\n        fromBytes: (bytes) => {\n            if (bytes.length !== BYTES)\n                throw new Error(`Fp.fromBytes: expected ${BYTES}, got ${bytes.length}`);\n            return isLE ? bytesToNumberLE(bytes) : bytesToNumberBE(bytes);\n        },\n    });\n    return Object.freeze(f);\n}\nexport function FpSqrtOdd(Fp, elm) {\n    if (!Fp.isOdd)\n        throw new Error(`Field doesn't have isOdd`);\n    const root = Fp.sqrt(elm);\n    return Fp.isOdd(root) ? root : Fp.neg(root);\n}\nexport function FpSqrtEven(Fp, elm) {\n    if (!Fp.isOdd)\n        throw new Error(`Field doesn't have isOdd`);\n    const root = Fp.sqrt(elm);\n    return Fp.isOdd(root) ? Fp.neg(root) : root;\n}\n/**\n * \"Constant-time\" private key generation utility.\n * Same as mapKeyToField, but accepts less bytes (40 instead of 48 for 32-byte field).\n * Which makes it slightly more biased, less secure.\n * @deprecated use mapKeyToField instead\n */\nexport function hashToPrivateScalar(hash, groupOrder, isLE = false) {\n    hash = ensureBytes('privateHash', hash);\n    const hashLen = hash.length;\n    const minLen = nLength(groupOrder).nByteLength + 8;\n    if (minLen < 24 || hashLen < minLen || hashLen > 1024)\n        throw new Error(`hashToPrivateScalar: expected ${minLen}-1024 bytes of input, got ${hashLen}`);\n    const num = isLE ? bytesToNumberLE(hash) : bytesToNumberBE(hash);\n    return mod(num, groupOrder - _1n) + _1n;\n}\n/**\n * Returns total number of bytes consumed by the field element.\n * For example, 32 bytes for usual 256-bit weierstrass curve.\n * @param fieldOrder number of field elements, usually CURVE.n\n * @returns byte length of field\n */\nexport function getFieldBytesLength(fieldOrder) {\n    if (typeof fieldOrder !== 'bigint')\n        throw new Error('field order must be bigint');\n    const bitLength = fieldOrder.toString(2).length;\n    return Math.ceil(bitLength / 8);\n}\n/**\n * Returns minimal amount of bytes that can be safely reduced\n * by field order.\n * Should be 2^-128 for 128-bit curve such as P256.\n * @param fieldOrder number of field elements, usually CURVE.n\n * @returns byte length of target hash\n */\nexport function getMinHashLength(fieldOrder) {\n    const length = getFieldBytesLength(fieldOrder);\n    return length + Math.ceil(length / 2);\n}\n/**\n * \"Constant-time\" private key generation utility.\n * Can take (n + n/2) or more bytes of uniform input e.g. from CSPRNG or KDF\n * and convert them into private scalar, with the modulo bias being negligible.\n * Needs at least 48 bytes of input for 32-byte private key.\n * https://research.kudelskisecurity.com/2020/07/28/the-definitive-guide-to-modulo-bias-and-how-to-avoid-it/\n * FIPS 186-5, A.2 https://csrc.nist.gov/publications/detail/fips/186/5/final\n * RFC 9380, https://www.rfc-editor.org/rfc/rfc9380#section-5\n * @param hash hash output from SHA3 or a similar function\n * @param groupOrder size of subgroup - (e.g. secp256k1.CURVE.n)\n * @param isLE interpret hash bytes as LE num\n * @returns valid private scalar\n */\nexport function mapHashToField(key, fieldOrder, isLE = false) {\n    const len = key.length;\n    const fieldLen = getFieldBytesLength(fieldOrder);\n    const minLen = getMinHashLength(fieldOrder);\n    // No small numbers: need to understand bias story. No huge numbers: easier to detect JS timings.\n    if (len < 16 || len < minLen || len > 1024)\n        throw new Error(`expected ${minLen}-1024 bytes of input, got ${len}`);\n    const num = isLE ? bytesToNumberBE(key) : bytesToNumberLE(key);\n    // `mod(x, 11)` can sometimes produce 0. `mod(x, 10) + 1` is the same, but no 0\n    const reduced = mod(num, fieldOrder - _1n) + _1n;\n    return isLE ? numberToBytesLE(reduced, fieldLen) : numberToBytesBE(reduced, fieldLen);\n}\n//# sourceMappingURL=modular.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Abelian group utilities\nimport { validateField, nLength } from './modular.js';\nimport { validateObject } from './utils.js';\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\n// Elliptic curve multiplication of Point by scalar. Fragile.\n// Scalars should always be less than curve order: this should be checked inside of a curve itself.\n// Creates precomputation tables for fast multiplication:\n// - private scalar is split by fixed size windows of W bits\n// - every window point is collected from window's table & added to accumulator\n// - since windows are different, same point inside tables won't be accessed more than once per calc\n// - each multiplication is 'Math.ceil(CURVE_ORDER / 𝑊) + 1' point additions (fixed for any scalar)\n// - +1 window is neccessary for wNAF\n// - wNAF reduces table size: 2x less memory + 2x faster generation, but 10% slower multiplication\n// TODO: Research returning 2d JS array of windows, instead of a single window. This would allow\n// windows to be in different memory locations\nexport function wNAF(c, bits) {\n    const constTimeNegate = (condition, item) => {\n        const neg = item.negate();\n        return condition ? neg : item;\n    };\n    const opts = (W) => {\n        const windows = Math.ceil(bits / W) + 1; // +1, because\n        const windowSize = 2 ** (W - 1); // -1 because we skip zero\n        return { windows, windowSize };\n    };\n    return {\n        constTimeNegate,\n        // non-const time multiplication ladder\n        unsafeLadder(elm, n) {\n            let p = c.ZERO;\n            let d = elm;\n            while (n > _0n) {\n                if (n & _1n)\n                    p = p.add(d);\n                d = d.double();\n                n >>= _1n;\n            }\n            return p;\n        },\n        /**\n         * Creates a wNAF precomputation window. Used for caching.\n         * Default window size is set by `utils.precompute()` and is equal to 8.\n         * Number of precomputed points depends on the curve size:\n         * 2^(𝑊−1) * (Math.ceil(𝑛 / 𝑊) + 1), where:\n         * - 𝑊 is the window size\n         * - 𝑛 is the bitlength of the curve order.\n         * For a 256-bit curve and window size 8, the number of precomputed points is 128 * 33 = 4224.\n         * @returns precomputed point tables flattened to a single array\n         */\n        precomputeWindow(elm, W) {\n            const { windows, windowSize } = opts(W);\n            const points = [];\n            let p = elm;\n            let base = p;\n            for (let window = 0; window < windows; window++) {\n                base = p;\n                points.push(base);\n                // =1, because we skip zero\n                for (let i = 1; i < windowSize; i++) {\n                    base = base.add(p);\n                    points.push(base);\n                }\n                p = base.double();\n            }\n            return points;\n        },\n        /**\n         * Implements ec multiplication using precomputed tables and w-ary non-adjacent form.\n         * @param W window size\n         * @param precomputes precomputed tables\n         * @param n scalar (we don't check here, but should be less than curve order)\n         * @returns real and fake (for const-time) points\n         */\n        wNAF(W, precomputes, n) {\n            // TODO: maybe check that scalar is less than group order? wNAF behavious is undefined otherwise\n            // But need to carefully remove other checks before wNAF. ORDER == bits here\n            const { windows, windowSize } = opts(W);\n            let p = c.ZERO;\n            let f = c.BASE;\n            const mask = BigInt(2 ** W - 1); // Create mask with W ones: 0b1111 for W=4 etc.\n            const maxNumber = 2 ** W;\n            const shiftBy = BigInt(W);\n            for (let window = 0; window < windows; window++) {\n                const offset = window * windowSize;\n                // Extract W bits.\n                let wbits = Number(n & mask);\n                // Shift number by W bits.\n                n >>= shiftBy;\n                // If the bits are bigger than max size, we'll split those.\n                // +224 => 256 - 32\n                if (wbits > windowSize) {\n                    wbits -= maxNumber;\n                    n += _1n;\n                }\n                // This code was first written with assumption that 'f' and 'p' will never be infinity point:\n                // since each addition is multiplied by 2 ** W, it cannot cancel each other. However,\n                // there is negate now: it is possible that negated element from low value\n                // would be the same as high element, which will create carry into next window.\n                // It's not obvious how this can fail, but still worth investigating later.\n                // Check if we're onto Zero point.\n                // Add random point inside current window to f.\n                const offset1 = offset;\n                const offset2 = offset + Math.abs(wbits) - 1; // -1 because we skip zero\n                const cond1 = window % 2 !== 0;\n                const cond2 = wbits < 0;\n                if (wbits === 0) {\n                    // The most important part for const-time getPublicKey\n                    f = f.add(constTimeNegate(cond1, precomputes[offset1]));\n                }\n                else {\n                    p = p.add(constTimeNegate(cond2, precomputes[offset2]));\n                }\n            }\n            // JIT-compiler should not eliminate f here, since it will later be used in normalizeZ()\n            // Even if the variable is still unused, there are some checks which will\n            // throw an exception, so compiler needs to prove they won't happen, which is hard.\n            // At this point there is a way to F be infinity-point even if p is not,\n            // which makes it less const-time: around 1 bigint multiply.\n            return { p, f };\n        },\n        wNAFCached(P, precomputesMap, n, transform) {\n            // @ts-ignore\n            const W = P._WINDOW_SIZE || 1;\n            // Calculate precomputes on a first run, reuse them after\n            let comp = precomputesMap.get(P);\n            if (!comp) {\n                comp = this.precomputeWindow(P, W);\n                if (W !== 1) {\n                    precomputesMap.set(P, transform(comp));\n                }\n            }\n            return this.wNAF(W, comp, n);\n        },\n    };\n}\nexport function validateBasic(curve) {\n    validateField(curve.Fp);\n    validateObject(curve, {\n        n: 'bigint',\n        h: 'bigint',\n        Gx: 'field',\n        Gy: 'field',\n    }, {\n        nBitLength: 'isSafeInteger',\n        nByteLength: 'isSafeInteger',\n    });\n    // Set defaults\n    return Object.freeze({\n        ...nLength(curve.n, curve.nBitLength),\n        ...curve,\n        ...{ p: curve.Fp.ORDER },\n    });\n}\n//# sourceMappingURL=curve.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Short Weierstrass curve. The formula is: y² = x³ + ax + b\nimport * as mod from './modular.js';\nimport * as ut from './utils.js';\nimport { ensureBytes } from './utils.js';\nimport { wNAF, validateBasic } from './curve.js';\nfunction validatePointOpts(curve) {\n    const opts = validateBasic(curve);\n    ut.validateObject(opts, {\n        a: 'field',\n        b: 'field',\n    }, {\n        allowedPrivateKeyLengths: 'array',\n        wrapPrivateKey: 'boolean',\n        isTorsionFree: 'function',\n        clearCofactor: 'function',\n        allowInfinityPoint: 'boolean',\n        fromBytes: 'function',\n        toBytes: 'function',\n    });\n    const { endo, Fp, a } = opts;\n    if (endo) {\n        if (!Fp.eql(a, Fp.ZERO)) {\n            throw new Error('Endomorphism can only be defined for Koblitz curves that have a=0');\n        }\n        if (typeof endo !== 'object' ||\n            typeof endo.beta !== 'bigint' ||\n            typeof endo.splitScalar !== 'function') {\n            throw new Error('Expected endomorphism with beta: bigint and splitScalar: function');\n        }\n    }\n    return Object.freeze({ ...opts });\n}\n// ASN.1 DER encoding utilities\nconst { bytesToNumberBE: b2n, hexToBytes: h2b } = ut;\nexport const DER = {\n    // asn.1 DER encoding utils\n    Err: class DERErr extends Error {\n        constructor(m = '') {\n            super(m);\n        }\n    },\n    _parseInt(data) {\n        const { Err: E } = DER;\n        if (data.length < 2 || data[0] !== 0x02)\n            throw new E('Invalid signature integer tag');\n        const len = data[1];\n        const res = data.subarray(2, len + 2);\n        if (!len || res.length !== len)\n            throw new E('Invalid signature integer: wrong length');\n        // https://crypto.stackexchange.com/a/57734 Leftmost bit of first byte is 'negative' flag,\n        // since we always use positive integers here. It must always be empty:\n        // - add zero byte if exists\n        // - if next byte doesn't have a flag, leading zero is not allowed (minimal encoding)\n        if (res[0] & 0b10000000)\n            throw new E('Invalid signature integer: negative');\n        if (res[0] === 0x00 && !(res[1] & 0b10000000))\n            throw new E('Invalid signature integer: unnecessary leading zero');\n        return { d: b2n(res), l: data.subarray(len + 2) }; // d is data, l is left\n    },\n    toSig(hex) {\n        // parse DER signature\n        const { Err: E } = DER;\n        const data = typeof hex === 'string' ? h2b(hex) : hex;\n        if (!(data instanceof Uint8Array))\n            throw new Error('ui8a expected');\n        let l = data.length;\n        if (l < 2 || data[0] != 0x30)\n            throw new E('Invalid signature tag');\n        if (data[1] !== l - 2)\n            throw new E('Invalid signature: incorrect length');\n        const { d: r, l: sBytes } = DER._parseInt(data.subarray(2));\n        const { d: s, l: rBytesLeft } = DER._parseInt(sBytes);\n        if (rBytesLeft.length)\n            throw new E('Invalid signature: left bytes after parsing');\n        return { r, s };\n    },\n    hexFromSig(sig) {\n        // Add leading zero if first byte has negative bit enabled. More details in '_parseInt'\n        const slice = (s) => (Number.parseInt(s[0], 16) & 0b1000 ? '00' + s : s);\n        const h = (num) => {\n            const hex = num.toString(16);\n            return hex.length & 1 ? `0${hex}` : hex;\n        };\n        const s = slice(h(sig.s));\n        const r = slice(h(sig.r));\n        const shl = s.length / 2;\n        const rhl = r.length / 2;\n        const sl = h(shl);\n        const rl = h(rhl);\n        return `30${h(rhl + shl + 4)}02${rl}${r}02${sl}${s}`;\n    },\n};\n// Be friendly to bad ECMAScript parsers by not using bigint literals\n// prettier-ignore\nconst _0n = BigInt(0), _1n = BigInt(1), _2n = BigInt(2), _3n = BigInt(3), _4n = BigInt(4);\nexport function weierstrassPoints(opts) {\n    const CURVE = validatePointOpts(opts);\n    const { Fp } = CURVE; // All curves has same field / group length as for now, but they can differ\n    const toBytes = CURVE.toBytes ||\n        ((_c, point, _isCompressed) => {\n            const a = point.toAffine();\n            return ut.concatBytes(Uint8Array.from([0x04]), Fp.toBytes(a.x), Fp.toBytes(a.y));\n        });\n    const fromBytes = CURVE.fromBytes ||\n        ((bytes) => {\n            // const head = bytes[0];\n            const tail = bytes.subarray(1);\n            // if (head !== 0x04) throw new Error('Only non-compressed encoding is supported');\n            const x = Fp.fromBytes(tail.subarray(0, Fp.BYTES));\n            const y = Fp.fromBytes(tail.subarray(Fp.BYTES, 2 * Fp.BYTES));\n            return { x, y };\n        });\n    /**\n     * y² = x³ + ax + b: Short weierstrass curve formula\n     * @returns y²\n     */\n    function weierstrassEquation(x) {\n        const { a, b } = CURVE;\n        const x2 = Fp.sqr(x); // x * x\n        const x3 = Fp.mul(x2, x); // x2 * x\n        return Fp.add(Fp.add(x3, Fp.mul(x, a)), b); // x3 + a * x + b\n    }\n    // Validate whether the passed curve params are valid.\n    // We check if curve equation works for generator point.\n    // `assertValidity()` won't work: `isTorsionFree()` is not available at this point in bls12-381.\n    // ProjectivePoint class has not been initialized yet.\n    if (!Fp.eql(Fp.sqr(CURVE.Gy), weierstrassEquation(CURVE.Gx)))\n        throw new Error('bad generator point: equation left != right');\n    // Valid group elements reside in range 1..n-1\n    function isWithinCurveOrder(num) {\n        return typeof num === 'bigint' && _0n < num && num < CURVE.n;\n    }\n    function assertGE(num) {\n        if (!isWithinCurveOrder(num))\n            throw new Error('Expected valid bigint: 0 < bigint < curve.n');\n    }\n    // Validates if priv key is valid and converts it to bigint.\n    // Supports options allowedPrivateKeyLengths and wrapPrivateKey.\n    function normPrivateKeyToScalar(key) {\n        const { allowedPrivateKeyLengths: lengths, nByteLength, wrapPrivateKey, n } = CURVE;\n        if (lengths && typeof key !== 'bigint') {\n            if (key instanceof Uint8Array)\n                key = ut.bytesToHex(key);\n            // Normalize to hex string, pad. E.g. P521 would norm 130-132 char hex to 132-char bytes\n            if (typeof key !== 'string' || !lengths.includes(key.length))\n                throw new Error('Invalid key');\n            key = key.padStart(nByteLength * 2, '0');\n        }\n        let num;\n        try {\n            num =\n                typeof key === 'bigint'\n                    ? key\n                    : ut.bytesToNumberBE(ensureBytes('private key', key, nByteLength));\n        }\n        catch (error) {\n            throw new Error(`private key must be ${nByteLength} bytes, hex or bigint, not ${typeof key}`);\n        }\n        if (wrapPrivateKey)\n            num = mod.mod(num, n); // disabled by default, enabled for BLS\n        assertGE(num); // num in range [1..N-1]\n        return num;\n    }\n    const pointPrecomputes = new Map();\n    function assertPrjPoint(other) {\n        if (!(other instanceof Point))\n            throw new Error('ProjectivePoint expected');\n    }\n    /**\n     * Projective Point works in 3d / projective (homogeneous) coordinates: (x, y, z) ∋ (x=x/z, y=y/z)\n     * Default Point works in 2d / affine coordinates: (x, y)\n     * We're doing calculations in projective, because its operations don't require costly inversion.\n     */\n    class Point {\n        constructor(px, py, pz) {\n            this.px = px;\n            this.py = py;\n            this.pz = pz;\n            if (px == null || !Fp.isValid(px))\n                throw new Error('x required');\n            if (py == null || !Fp.isValid(py))\n                throw new Error('y required');\n            if (pz == null || !Fp.isValid(pz))\n                throw new Error('z required');\n        }\n        // Does not validate if the point is on-curve.\n        // Use fromHex instead, or call assertValidity() later.\n        static fromAffine(p) {\n            const { x, y } = p || {};\n            if (!p || !Fp.isValid(x) || !Fp.isValid(y))\n                throw new Error('invalid affine point');\n            if (p instanceof Point)\n                throw new Error('projective point not allowed');\n            const is0 = (i) => Fp.eql(i, Fp.ZERO);\n            // fromAffine(x:0, y:0) would produce (x:0, y:0, z:1), but we need (x:0, y:1, z:0)\n            if (is0(x) && is0(y))\n                return Point.ZERO;\n            return new Point(x, y, Fp.ONE);\n        }\n        get x() {\n            return this.toAffine().x;\n        }\n        get y() {\n            return this.toAffine().y;\n        }\n        /**\n         * Takes a bunch of Projective Points but executes only one\n         * inversion on all of them. Inversion is very slow operation,\n         * so this improves performance massively.\n         * Optimization: converts a list of projective points to a list of identical points with Z=1.\n         */\n        static normalizeZ(points) {\n            const toInv = Fp.invertBatch(points.map((p) => p.pz));\n            return points.map((p, i) => p.toAffine(toInv[i])).map(Point.fromAffine);\n        }\n        /**\n         * Converts hash string or Uint8Array to Point.\n         * @param hex short/long ECDSA hex\n         */\n        static fromHex(hex) {\n            const P = Point.fromAffine(fromBytes(ensureBytes('pointHex', hex)));\n            P.assertValidity();\n            return P;\n        }\n        // Multiplies generator point by privateKey.\n        static fromPrivateKey(privateKey) {\n            return Point.BASE.multiply(normPrivateKeyToScalar(privateKey));\n        }\n        // \"Private method\", don't use it directly\n        _setWindowSize(windowSize) {\n            this._WINDOW_SIZE = windowSize;\n            pointPrecomputes.delete(this);\n        }\n        // A point on curve is valid if it conforms to equation.\n        assertValidity() {\n            if (this.is0()) {\n                // (0, 1, 0) aka ZERO is invalid in most contexts.\n                // In BLS, ZERO can be serialized, so we allow it.\n                // (0, 0, 0) is wrong representation of ZERO and is always invalid.\n                if (CURVE.allowInfinityPoint && !Fp.is0(this.py))\n                    return;\n                throw new Error('bad point: ZERO');\n            }\n            // Some 3rd-party test vectors require different wording between here & `fromCompressedHex`\n            const { x, y } = this.toAffine();\n            // Check if x, y are valid field elements\n            if (!Fp.isValid(x) || !Fp.isValid(y))\n                throw new Error('bad point: x or y not FE');\n            const left = Fp.sqr(y); // y²\n            const right = weierstrassEquation(x); // x³ + ax + b\n            if (!Fp.eql(left, right))\n                throw new Error('bad point: equation left != right');\n            if (!this.isTorsionFree())\n                throw new Error('bad point: not in prime-order subgroup');\n        }\n        hasEvenY() {\n            const { y } = this.toAffine();\n            if (Fp.isOdd)\n                return !Fp.isOdd(y);\n            throw new Error(\"Field doesn't support isOdd\");\n        }\n        /**\n         * Compare one point to another.\n         */\n        equals(other) {\n            assertPrjPoint(other);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            const { px: X2, py: Y2, pz: Z2 } = other;\n            const U1 = Fp.eql(Fp.mul(X1, Z2), Fp.mul(X2, Z1));\n            const U2 = Fp.eql(Fp.mul(Y1, Z2), Fp.mul(Y2, Z1));\n            return U1 && U2;\n        }\n        /**\n         * Flips point to one corresponding to (x, -y) in Affine coordinates.\n         */\n        negate() {\n            return new Point(this.px, Fp.neg(this.py), this.pz);\n        }\n        // Renes-Costello-Batina exception-free doubling formula.\n        // There is 30% faster Jacobian formula, but it is not complete.\n        // https://eprint.iacr.org/2015/1060, algorithm 3\n        // Cost: 8M + 3S + 3*a + 2*b3 + 15add.\n        double() {\n            const { a, b } = CURVE;\n            const b3 = Fp.mul(b, _3n);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            let X3 = Fp.ZERO, Y3 = Fp.ZERO, Z3 = Fp.ZERO; // prettier-ignore\n            let t0 = Fp.mul(X1, X1); // step 1\n            let t1 = Fp.mul(Y1, Y1);\n            let t2 = Fp.mul(Z1, Z1);\n            let t3 = Fp.mul(X1, Y1);\n            t3 = Fp.add(t3, t3); // step 5\n            Z3 = Fp.mul(X1, Z1);\n            Z3 = Fp.add(Z3, Z3);\n            X3 = Fp.mul(a, Z3);\n            Y3 = Fp.mul(b3, t2);\n            Y3 = Fp.add(X3, Y3); // step 10\n            X3 = Fp.sub(t1, Y3);\n            Y3 = Fp.add(t1, Y3);\n            Y3 = Fp.mul(X3, Y3);\n            X3 = Fp.mul(t3, X3);\n            Z3 = Fp.mul(b3, Z3); // step 15\n            t2 = Fp.mul(a, t2);\n            t3 = Fp.sub(t0, t2);\n            t3 = Fp.mul(a, t3);\n            t3 = Fp.add(t3, Z3);\n            Z3 = Fp.add(t0, t0); // step 20\n            t0 = Fp.add(Z3, t0);\n            t0 = Fp.add(t0, t2);\n            t0 = Fp.mul(t0, t3);\n            Y3 = Fp.add(Y3, t0);\n            t2 = Fp.mul(Y1, Z1); // step 25\n            t2 = Fp.add(t2, t2);\n            t0 = Fp.mul(t2, t3);\n            X3 = Fp.sub(X3, t0);\n            Z3 = Fp.mul(t2, t1);\n            Z3 = Fp.add(Z3, Z3); // step 30\n            Z3 = Fp.add(Z3, Z3);\n            return new Point(X3, Y3, Z3);\n        }\n        // Renes-Costello-Batina exception-free addition formula.\n        // There is 30% faster Jacobian formula, but it is not complete.\n        // https://eprint.iacr.org/2015/1060, algorithm 1\n        // Cost: 12M + 0S + 3*a + 3*b3 + 23add.\n        add(other) {\n            assertPrjPoint(other);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            const { px: X2, py: Y2, pz: Z2 } = other;\n            let X3 = Fp.ZERO, Y3 = Fp.ZERO, Z3 = Fp.ZERO; // prettier-ignore\n            const a = CURVE.a;\n            const b3 = Fp.mul(CURVE.b, _3n);\n            let t0 = Fp.mul(X1, X2); // step 1\n            let t1 = Fp.mul(Y1, Y2);\n            let t2 = Fp.mul(Z1, Z2);\n            let t3 = Fp.add(X1, Y1);\n            let t4 = Fp.add(X2, Y2); // step 5\n            t3 = Fp.mul(t3, t4);\n            t4 = Fp.add(t0, t1);\n            t3 = Fp.sub(t3, t4);\n            t4 = Fp.add(X1, Z1);\n            let t5 = Fp.add(X2, Z2); // step 10\n            t4 = Fp.mul(t4, t5);\n            t5 = Fp.add(t0, t2);\n            t4 = Fp.sub(t4, t5);\n            t5 = Fp.add(Y1, Z1);\n            X3 = Fp.add(Y2, Z2); // step 15\n            t5 = Fp.mul(t5, X3);\n            X3 = Fp.add(t1, t2);\n            t5 = Fp.sub(t5, X3);\n            Z3 = Fp.mul(a, t4);\n            X3 = Fp.mul(b3, t2); // step 20\n            Z3 = Fp.add(X3, Z3);\n            X3 = Fp.sub(t1, Z3);\n            Z3 = Fp.add(t1, Z3);\n            Y3 = Fp.mul(X3, Z3);\n            t1 = Fp.add(t0, t0); // step 25\n            t1 = Fp.add(t1, t0);\n            t2 = Fp.mul(a, t2);\n            t4 = Fp.mul(b3, t4);\n            t1 = Fp.add(t1, t2);\n            t2 = Fp.sub(t0, t2); // step 30\n            t2 = Fp.mul(a, t2);\n            t4 = Fp.add(t4, t2);\n            t0 = Fp.mul(t1, t4);\n            Y3 = Fp.add(Y3, t0);\n            t0 = Fp.mul(t5, t4); // step 35\n            X3 = Fp.mul(t3, X3);\n            X3 = Fp.sub(X3, t0);\n            t0 = Fp.mul(t3, t1);\n            Z3 = Fp.mul(t5, Z3);\n            Z3 = Fp.add(Z3, t0); // step 40\n            return new Point(X3, Y3, Z3);\n        }\n        subtract(other) {\n            return this.add(other.negate());\n        }\n        is0() {\n            return this.equals(Point.ZERO);\n        }\n        wNAF(n) {\n            return wnaf.wNAFCached(this, pointPrecomputes, n, (comp) => {\n                const toInv = Fp.invertBatch(comp.map((p) => p.pz));\n                return comp.map((p, i) => p.toAffine(toInv[i])).map(Point.fromAffine);\n            });\n        }\n        /**\n         * Non-constant-time multiplication. Uses double-and-add algorithm.\n         * It's faster, but should only be used when you don't care about\n         * an exposed private key e.g. sig verification, which works over *public* keys.\n         */\n        multiplyUnsafe(n) {\n            const I = Point.ZERO;\n            if (n === _0n)\n                return I;\n            assertGE(n); // Will throw on 0\n            if (n === _1n)\n                return this;\n            const { endo } = CURVE;\n            if (!endo)\n                return wnaf.unsafeLadder(this, n);\n            // Apply endomorphism\n            let { k1neg, k1, k2neg, k2 } = endo.splitScalar(n);\n            let k1p = I;\n            let k2p = I;\n            let d = this;\n            while (k1 > _0n || k2 > _0n) {\n                if (k1 & _1n)\n                    k1p = k1p.add(d);\n                if (k2 & _1n)\n                    k2p = k2p.add(d);\n                d = d.double();\n                k1 >>= _1n;\n                k2 >>= _1n;\n            }\n            if (k1neg)\n                k1p = k1p.negate();\n            if (k2neg)\n                k2p = k2p.negate();\n            k2p = new Point(Fp.mul(k2p.px, endo.beta), k2p.py, k2p.pz);\n            return k1p.add(k2p);\n        }\n        /**\n         * Constant time multiplication.\n         * Uses wNAF method. Windowed method may be 10% faster,\n         * but takes 2x longer to generate and consumes 2x memory.\n         * Uses precomputes when available.\n         * Uses endomorphism for Koblitz curves.\n         * @param scalar by which the point would be multiplied\n         * @returns New point\n         */\n        multiply(scalar) {\n            assertGE(scalar);\n            let n = scalar;\n            let point, fake; // Fake point is used to const-time mult\n            const { endo } = CURVE;\n            if (endo) {\n                const { k1neg, k1, k2neg, k2 } = endo.splitScalar(n);\n                let { p: k1p, f: f1p } = this.wNAF(k1);\n                let { p: k2p, f: f2p } = this.wNAF(k2);\n                k1p = wnaf.constTimeNegate(k1neg, k1p);\n                k2p = wnaf.constTimeNegate(k2neg, k2p);\n                k2p = new Point(Fp.mul(k2p.px, endo.beta), k2p.py, k2p.pz);\n                point = k1p.add(k2p);\n                fake = f1p.add(f2p);\n            }\n            else {\n                const { p, f } = this.wNAF(n);\n                point = p;\n                fake = f;\n            }\n            // Normalize `z` for both points, but return only real one\n            return Point.normalizeZ([point, fake])[0];\n        }\n        /**\n         * Efficiently calculate `aP + bQ`. Unsafe, can expose private key, if used incorrectly.\n         * Not using Strauss-Shamir trick: precomputation tables are faster.\n         * The trick could be useful if both P and Q are not G (not in our case).\n         * @returns non-zero affine point\n         */\n        multiplyAndAddUnsafe(Q, a, b) {\n            const G = Point.BASE; // No Strauss-Shamir trick: we have 10% faster G precomputes\n            const mul = (P, a // Select faster multiply() method\n            ) => (a === _0n || a === _1n || !P.equals(G) ? P.multiplyUnsafe(a) : P.multiply(a));\n            const sum = mul(this, a).add(mul(Q, b));\n            return sum.is0() ? undefined : sum;\n        }\n        // Converts Projective point to affine (x, y) coordinates.\n        // Can accept precomputed Z^-1 - for example, from invertBatch.\n        // (x, y, z) ∋ (x=x/z, y=y/z)\n        toAffine(iz) {\n            const { px: x, py: y, pz: z } = this;\n            const is0 = this.is0();\n            // If invZ was 0, we return zero point. However we still want to execute\n            // all operations, so we replace invZ with a random number, 1.\n            if (iz == null)\n                iz = is0 ? Fp.ONE : Fp.inv(z);\n            const ax = Fp.mul(x, iz);\n            const ay = Fp.mul(y, iz);\n            const zz = Fp.mul(z, iz);\n            if (is0)\n                return { x: Fp.ZERO, y: Fp.ZERO };\n            if (!Fp.eql(zz, Fp.ONE))\n                throw new Error('invZ was invalid');\n            return { x: ax, y: ay };\n        }\n        isTorsionFree() {\n            const { h: cofactor, isTorsionFree } = CURVE;\n            if (cofactor === _1n)\n                return true; // No subgroups, always torsion-free\n            if (isTorsionFree)\n                return isTorsionFree(Point, this);\n            throw new Error('isTorsionFree() has not been declared for the elliptic curve');\n        }\n        clearCofactor() {\n            const { h: cofactor, clearCofactor } = CURVE;\n            if (cofactor === _1n)\n                return this; // Fast-path\n            if (clearCofactor)\n                return clearCofactor(Point, this);\n            return this.multiplyUnsafe(CURVE.h);\n        }\n        toRawBytes(isCompressed = true) {\n            this.assertValidity();\n            return toBytes(Point, this, isCompressed);\n        }\n        toHex(isCompressed = true) {\n            return ut.bytesToHex(this.toRawBytes(isCompressed));\n        }\n    }\n    Point.BASE = new Point(CURVE.Gx, CURVE.Gy, Fp.ONE);\n    Point.ZERO = new Point(Fp.ZERO, Fp.ONE, Fp.ZERO);\n    const _bits = CURVE.nBitLength;\n    const wnaf = wNAF(Point, CURVE.endo ? Math.ceil(_bits / 2) : _bits);\n    // Validate if generator point is on curve\n    return {\n        CURVE,\n        ProjectivePoint: Point,\n        normPrivateKeyToScalar,\n        weierstrassEquation,\n        isWithinCurveOrder,\n    };\n}\nfunction validateOpts(curve) {\n    const opts = validateBasic(curve);\n    ut.validateObject(opts, {\n        hash: 'hash',\n        hmac: 'function',\n        randomBytes: 'function',\n    }, {\n        bits2int: 'function',\n        bits2int_modN: 'function',\n        lowS: 'boolean',\n    });\n    return Object.freeze({ lowS: true, ...opts });\n}\nexport function weierstrass(curveDef) {\n    const CURVE = validateOpts(curveDef);\n    const { Fp, n: CURVE_ORDER } = CURVE;\n    const compressedLen = Fp.BYTES + 1; // e.g. 33 for 32\n    const uncompressedLen = 2 * Fp.BYTES + 1; // e.g. 65 for 32\n    function isValidFieldElement(num) {\n        return _0n < num && num < Fp.ORDER; // 0 is banned since it's not invertible FE\n    }\n    function modN(a) {\n        return mod.mod(a, CURVE_ORDER);\n    }\n    function invN(a) {\n        return mod.invert(a, CURVE_ORDER);\n    }\n    const { ProjectivePoint: Point, normPrivateKeyToScalar, weierstrassEquation, isWithinCurveOrder, } = weierstrassPoints({\n        ...CURVE,\n        toBytes(_c, point, isCompressed) {\n            const a = point.toAffine();\n            const x = Fp.toBytes(a.x);\n            const cat = ut.concatBytes;\n            if (isCompressed) {\n                return cat(Uint8Array.from([point.hasEvenY() ? 0x02 : 0x03]), x);\n            }\n            else {\n                return cat(Uint8Array.from([0x04]), x, Fp.toBytes(a.y));\n            }\n        },\n        fromBytes(bytes) {\n            const len = bytes.length;\n            const head = bytes[0];\n            const tail = bytes.subarray(1);\n            // this.assertValidity() is done inside of fromHex\n            if (len === compressedLen && (head === 0x02 || head === 0x03)) {\n                const x = ut.bytesToNumberBE(tail);\n                if (!isValidFieldElement(x))\n                    throw new Error('Point is not on curve');\n                const y2 = weierstrassEquation(x); // y² = x³ + ax + b\n                let y = Fp.sqrt(y2); // y = y² ^ (p+1)/4\n                const isYOdd = (y & _1n) === _1n;\n                // ECDSA\n                const isHeadOdd = (head & 1) === 1;\n                if (isHeadOdd !== isYOdd)\n                    y = Fp.neg(y);\n                return { x, y };\n            }\n            else if (len === uncompressedLen && head === 0x04) {\n                const x = Fp.fromBytes(tail.subarray(0, Fp.BYTES));\n                const y = Fp.fromBytes(tail.subarray(Fp.BYTES, 2 * Fp.BYTES));\n                return { x, y };\n            }\n            else {\n                throw new Error(`Point of length ${len} was invalid. Expected ${compressedLen} compressed bytes or ${uncompressedLen} uncompressed bytes`);\n            }\n        },\n    });\n    const numToNByteStr = (num) => ut.bytesToHex(ut.numberToBytesBE(num, CURVE.nByteLength));\n    function isBiggerThanHalfOrder(number) {\n        const HALF = CURVE_ORDER >> _1n;\n        return number > HALF;\n    }\n    function normalizeS(s) {\n        return isBiggerThanHalfOrder(s) ? modN(-s) : s;\n    }\n    // slice bytes num\n    const slcNum = (b, from, to) => ut.bytesToNumberBE(b.slice(from, to));\n    /**\n     * ECDSA signature with its (r, s) properties. Supports DER & compact representations.\n     */\n    class Signature {\n        constructor(r, s, recovery) {\n            this.r = r;\n            this.s = s;\n            this.recovery = recovery;\n            this.assertValidity();\n        }\n        // pair (bytes of r, bytes of s)\n        static fromCompact(hex) {\n            const l = CURVE.nByteLength;\n            hex = ensureBytes('compactSignature', hex, l * 2);\n            return new Signature(slcNum(hex, 0, l), slcNum(hex, l, 2 * l));\n        }\n        // DER encoded ECDSA signature\n        // https://bitcoin.stackexchange.com/questions/57644/what-are-the-parts-of-a-bitcoin-transaction-input-script\n        static fromDER(hex) {\n            const { r, s } = DER.toSig(ensureBytes('DER', hex));\n            return new Signature(r, s);\n        }\n        assertValidity() {\n            // can use assertGE here\n            if (!isWithinCurveOrder(this.r))\n                throw new Error('r must be 0 < r < CURVE.n');\n            if (!isWithinCurveOrder(this.s))\n                throw new Error('s must be 0 < s < CURVE.n');\n        }\n        addRecoveryBit(recovery) {\n            return new Signature(this.r, this.s, recovery);\n        }\n        recoverPublicKey(msgHash) {\n            const { r, s, recovery: rec } = this;\n            const h = bits2int_modN(ensureBytes('msgHash', msgHash)); // Truncate hash\n            if (rec == null || ![0, 1, 2, 3].includes(rec))\n                throw new Error('recovery id invalid');\n            const radj = rec === 2 || rec === 3 ? r + CURVE.n : r;\n            if (radj >= Fp.ORDER)\n                throw new Error('recovery id 2 or 3 invalid');\n            const prefix = (rec & 1) === 0 ? '02' : '03';\n            const R = Point.fromHex(prefix + numToNByteStr(radj));\n            const ir = invN(radj); // r^-1\n            const u1 = modN(-h * ir); // -hr^-1\n            const u2 = modN(s * ir); // sr^-1\n            const Q = Point.BASE.multiplyAndAddUnsafe(R, u1, u2); // (sr^-1)R-(hr^-1)G = -(hr^-1)G + (sr^-1)\n            if (!Q)\n                throw new Error('point at infinify'); // unsafe is fine: no priv data leaked\n            Q.assertValidity();\n            return Q;\n        }\n        // Signatures should be low-s, to prevent malleability.\n        hasHighS() {\n            return isBiggerThanHalfOrder(this.s);\n        }\n        normalizeS() {\n            return this.hasHighS() ? new Signature(this.r, modN(-this.s), this.recovery) : this;\n        }\n        // DER-encoded\n        toDERRawBytes() {\n            return ut.hexToBytes(this.toDERHex());\n        }\n        toDERHex() {\n            return DER.hexFromSig({ r: this.r, s: this.s });\n        }\n        // padded bytes of r, then padded bytes of s\n        toCompactRawBytes() {\n            return ut.hexToBytes(this.toCompactHex());\n        }\n        toCompactHex() {\n            return numToNByteStr(this.r) + numToNByteStr(this.s);\n        }\n    }\n    const utils = {\n        isValidPrivateKey(privateKey) {\n            try {\n                normPrivateKeyToScalar(privateKey);\n                return true;\n            }\n            catch (error) {\n                return false;\n            }\n        },\n        normPrivateKeyToScalar: normPrivateKeyToScalar,\n        /**\n         * Produces cryptographically secure private key from random of size\n         * (groupLen + ceil(groupLen / 2)) with modulo bias being negligible.\n         */\n        randomPrivateKey: () => {\n            const length = mod.getMinHashLength(CURVE.n);\n            return mod.mapHashToField(CURVE.randomBytes(length), CURVE.n);\n        },\n        /**\n         * Creates precompute table for an arbitrary EC point. Makes point \"cached\".\n         * Allows to massively speed-up `point.multiply(scalar)`.\n         * @returns cached point\n         * @example\n         * const fast = utils.precompute(8, ProjectivePoint.fromHex(someonesPubKey));\n         * fast.multiply(privKey); // much faster ECDH now\n         */\n        precompute(windowSize = 8, point = Point.BASE) {\n            point._setWindowSize(windowSize);\n            point.multiply(BigInt(3)); // 3 is arbitrary, just need any number here\n            return point;\n        },\n    };\n    /**\n     * Computes public key for a private key. Checks for validity of the private key.\n     * @param privateKey private key\n     * @param isCompressed whether to return compact (default), or full key\n     * @returns Public key, full when isCompressed=false; short when isCompressed=true\n     */\n    function getPublicKey(privateKey, isCompressed = true) {\n        return Point.fromPrivateKey(privateKey).toRawBytes(isCompressed);\n    }\n    /**\n     * Quick and dirty check for item being public key. Does not validate hex, or being on-curve.\n     */\n    function isProbPub(item) {\n        const arr = item instanceof Uint8Array;\n        const str = typeof item === 'string';\n        const len = (arr || str) && item.length;\n        if (arr)\n            return len === compressedLen || len === uncompressedLen;\n        if (str)\n            return len === 2 * compressedLen || len === 2 * uncompressedLen;\n        if (item instanceof Point)\n            return true;\n        return false;\n    }\n    /**\n     * ECDH (Elliptic Curve Diffie Hellman).\n     * Computes shared public key from private key and public key.\n     * Checks: 1) private key validity 2) shared key is on-curve.\n     * Does NOT hash the result.\n     * @param privateA private key\n     * @param publicB different public key\n     * @param isCompressed whether to return compact (default), or full key\n     * @returns shared public key\n     */\n    function getSharedSecret(privateA, publicB, isCompressed = true) {\n        if (isProbPub(privateA))\n            throw new Error('first arg must be private key');\n        if (!isProbPub(publicB))\n            throw new Error('second arg must be public key');\n        const b = Point.fromHex(publicB); // check for being on-curve\n        return b.multiply(normPrivateKeyToScalar(privateA)).toRawBytes(isCompressed);\n    }\n    // RFC6979: ensure ECDSA msg is X bytes and < N. RFC suggests optional truncating via bits2octets.\n    // FIPS 186-4 4.6 suggests the leftmost min(nBitLen, outLen) bits, which matches bits2int.\n    // bits2int can produce res>N, we can do mod(res, N) since the bitLen is the same.\n    // int2octets can't be used; pads small msgs with 0: unacceptatble for trunc as per RFC vectors\n    const bits2int = CURVE.bits2int ||\n        function (bytes) {\n            // For curves with nBitLength % 8 !== 0: bits2octets(bits2octets(m)) !== bits2octets(m)\n            // for some cases, since bytes.length * 8 is not actual bitLength.\n            const num = ut.bytesToNumberBE(bytes); // check for == u8 done here\n            const delta = bytes.length * 8 - CURVE.nBitLength; // truncate to nBitLength leftmost bits\n            return delta > 0 ? num >> BigInt(delta) : num;\n        };\n    const bits2int_modN = CURVE.bits2int_modN ||\n        function (bytes) {\n            return modN(bits2int(bytes)); // can't use bytesToNumberBE here\n        };\n    // NOTE: pads output with zero as per spec\n    const ORDER_MASK = ut.bitMask(CURVE.nBitLength);\n    /**\n     * Converts to bytes. Checks if num in `[0..ORDER_MASK-1]` e.g.: `[0..2^256-1]`.\n     */\n    function int2octets(num) {\n        if (typeof num !== 'bigint')\n            throw new Error('bigint expected');\n        if (!(_0n <= num && num < ORDER_MASK))\n            throw new Error(`bigint expected < 2^${CURVE.nBitLength}`);\n        // works with order, can have different size than numToField!\n        return ut.numberToBytesBE(num, CURVE.nByteLength);\n    }\n    // Steps A, D of RFC6979 3.2\n    // Creates RFC6979 seed; converts msg/privKey to numbers.\n    // Used only in sign, not in verify.\n    // NOTE: we cannot assume here that msgHash has same amount of bytes as curve order, this will be wrong at least for P521.\n    // Also it can be bigger for P224 + SHA256\n    function prepSig(msgHash, privateKey, opts = defaultSigOpts) {\n        if (['recovered', 'canonical'].some((k) => k in opts))\n            throw new Error('sign() legacy options not supported');\n        const { hash, randomBytes } = CURVE;\n        let { lowS, prehash, extraEntropy: ent } = opts; // generates low-s sigs by default\n        if (lowS == null)\n            lowS = true; // RFC6979 3.2: we skip step A, because we already provide hash\n        msgHash = ensureBytes('msgHash', msgHash);\n        if (prehash)\n            msgHash = ensureBytes('prehashed msgHash', hash(msgHash));\n        // We can't later call bits2octets, since nested bits2int is broken for curves\n        // with nBitLength % 8 !== 0. Because of that, we unwrap it here as int2octets call.\n        // const bits2octets = (bits) => int2octets(bits2int_modN(bits))\n        const h1int = bits2int_modN(msgHash);\n        const d = normPrivateKeyToScalar(privateKey); // validate private key, convert to bigint\n        const seedArgs = [int2octets(d), int2octets(h1int)];\n        // extraEntropy. RFC6979 3.6: additional k' (optional).\n        if (ent != null) {\n            // K = HMAC_K(V || 0x00 || int2octets(x) || bits2octets(h1) || k')\n            const e = ent === true ? randomBytes(Fp.BYTES) : ent; // generate random bytes OR pass as-is\n            seedArgs.push(ensureBytes('extraEntropy', e)); // check for being bytes\n        }\n        const seed = ut.concatBytes(...seedArgs); // Step D of RFC6979 3.2\n        const m = h1int; // NOTE: no need to call bits2int second time here, it is inside truncateHash!\n        // Converts signature params into point w r/s, checks result for validity.\n        function k2sig(kBytes) {\n            // RFC 6979 Section 3.2, step 3: k = bits2int(T)\n            const k = bits2int(kBytes); // Cannot use fields methods, since it is group element\n            if (!isWithinCurveOrder(k))\n                return; // Important: all mod() calls here must be done over N\n            const ik = invN(k); // k^-1 mod n\n            const q = Point.BASE.multiply(k).toAffine(); // q = Gk\n            const r = modN(q.x); // r = q.x mod n\n            if (r === _0n)\n                return;\n            // Can use scalar blinding b^-1(bm + bdr) where b ∈ [1,q−1] according to\n            // https://tches.iacr.org/index.php/TCHES/article/view/7337/6509. We've decided against it:\n            // a) dependency on CSPRNG b) 15% slowdown c) doesn't really help since bigints are not CT\n            const s = modN(ik * modN(m + r * d)); // Not using blinding here\n            if (s === _0n)\n                return;\n            let recovery = (q.x === r ? 0 : 2) | Number(q.y & _1n); // recovery bit (2 or 3, when q.x > n)\n            let normS = s;\n            if (lowS && isBiggerThanHalfOrder(s)) {\n                normS = normalizeS(s); // if lowS was passed, ensure s is always\n                recovery ^= 1; // // in the bottom half of N\n            }\n            return new Signature(r, normS, recovery); // use normS, not s\n        }\n        return { seed, k2sig };\n    }\n    const defaultSigOpts = { lowS: CURVE.lowS, prehash: false };\n    const defaultVerOpts = { lowS: CURVE.lowS, prehash: false };\n    /**\n     * Signs message hash with a private key.\n     * ```\n     * sign(m, d, k) where\n     *   (x, y) = G × k\n     *   r = x mod n\n     *   s = (m + dr)/k mod n\n     * ```\n     * @param msgHash NOT message. msg needs to be hashed to `msgHash`, or use `prehash`.\n     * @param privKey private key\n     * @param opts lowS for non-malleable sigs. extraEntropy for mixing randomness into k. prehash will hash first arg.\n     * @returns signature with recovery param\n     */\n    function sign(msgHash, privKey, opts = defaultSigOpts) {\n        const { seed, k2sig } = prepSig(msgHash, privKey, opts); // Steps A, D of RFC6979 3.2.\n        const C = CURVE;\n        const drbg = ut.createHmacDrbg(C.hash.outputLen, C.nByteLength, C.hmac);\n        return drbg(seed, k2sig); // Steps B, C, D, E, F, G\n    }\n    // Enable precomputes. Slows down first publicKey computation by 20ms.\n    Point.BASE._setWindowSize(8);\n    // utils.precompute(8, ProjectivePoint.BASE)\n    /**\n     * Verifies a signature against message hash and public key.\n     * Rejects lowS signatures by default: to override,\n     * specify option `{lowS: false}`. Implements section 4.1.4 from https://www.secg.org/sec1-v2.pdf:\n     *\n     * ```\n     * verify(r, s, h, P) where\n     *   U1 = hs^-1 mod n\n     *   U2 = rs^-1 mod n\n     *   R = U1⋅G - U2⋅P\n     *   mod(R.x, n) == r\n     * ```\n     */\n    function verify(signature, msgHash, publicKey, opts = defaultVerOpts) {\n        const sg = signature;\n        msgHash = ensureBytes('msgHash', msgHash);\n        publicKey = ensureBytes('publicKey', publicKey);\n        if ('strict' in opts)\n            throw new Error('options.strict was renamed to lowS');\n        const { lowS, prehash } = opts;\n        let _sig = undefined;\n        let P;\n        try {\n            if (typeof sg === 'string' || sg instanceof Uint8Array) {\n                // Signature can be represented in 2 ways: compact (2*nByteLength) & DER (variable-length).\n                // Since DER can also be 2*nByteLength bytes, we check for it first.\n                try {\n                    _sig = Signature.fromDER(sg);\n                }\n                catch (derError) {\n                    if (!(derError instanceof DER.Err))\n                        throw derError;\n                    _sig = Signature.fromCompact(sg);\n                }\n            }\n            else if (typeof sg === 'object' && typeof sg.r === 'bigint' && typeof sg.s === 'bigint') {\n                const { r, s } = sg;\n                _sig = new Signature(r, s);\n            }\n            else {\n                throw new Error('PARSE');\n            }\n            P = Point.fromHex(publicKey);\n        }\n        catch (error) {\n            if (error.message === 'PARSE')\n                throw new Error(`signature must be Signature instance, Uint8Array or hex string`);\n            return false;\n        }\n        if (lowS && _sig.hasHighS())\n            return false;\n        if (prehash)\n            msgHash = CURVE.hash(msgHash);\n        const { r, s } = _sig;\n        const h = bits2int_modN(msgHash); // Cannot use fields methods, since it is group element\n        const is = invN(s); // s^-1\n        const u1 = modN(h * is); // u1 = hs^-1 mod n\n        const u2 = modN(r * is); // u2 = rs^-1 mod n\n        const R = Point.BASE.multiplyAndAddUnsafe(P, u1, u2)?.toAffine(); // R = u1⋅G + u2⋅P\n        if (!R)\n            return false;\n        const v = modN(R.x);\n        return v === r;\n    }\n    return {\n        CURVE,\n        getPublicKey,\n        getSharedSecret,\n        sign,\n        verify,\n        ProjectivePoint: Point,\n        Signature,\n        utils,\n    };\n}\n/**\n * Implementation of the Shallue and van de Woestijne method for any weierstrass curve.\n * TODO: check if there is a way to merge this with uvRatio in Edwards; move to modular.\n * b = True and y = sqrt(u / v) if (u / v) is square in F, and\n * b = False and y = sqrt(Z * (u / v)) otherwise.\n * @param Fp\n * @param Z\n * @returns\n */\nexport function SWUFpSqrtRatio(Fp, Z) {\n    // Generic implementation\n    const q = Fp.ORDER;\n    let l = _0n;\n    for (let o = q - _1n; o % _2n === _0n; o /= _2n)\n        l += _1n;\n    const c1 = l; // 1. c1, the largest integer such that 2^c1 divides q - 1.\n    // We need 2n ** c1 and 2n ** (c1-1). We can't use **; but we can use <<.\n    // 2n ** c1 == 2n << (c1-1)\n    const _2n_pow_c1_1 = _2n << (c1 - _1n - _1n);\n    const _2n_pow_c1 = _2n_pow_c1_1 * _2n;\n    const c2 = (q - _1n) / _2n_pow_c1; // 2. c2 = (q - 1) / (2^c1)  # Integer arithmetic\n    const c3 = (c2 - _1n) / _2n; // 3. c3 = (c2 - 1) / 2            # Integer arithmetic\n    const c4 = _2n_pow_c1 - _1n; // 4. c4 = 2^c1 - 1                # Integer arithmetic\n    const c5 = _2n_pow_c1_1; // 5. c5 = 2^(c1 - 1)                  # Integer arithmetic\n    const c6 = Fp.pow(Z, c2); // 6. c6 = Z^c2\n    const c7 = Fp.pow(Z, (c2 + _1n) / _2n); // 7. c7 = Z^((c2 + 1) / 2)\n    let sqrtRatio = (u, v) => {\n        let tv1 = c6; // 1. tv1 = c6\n        let tv2 = Fp.pow(v, c4); // 2. tv2 = v^c4\n        let tv3 = Fp.sqr(tv2); // 3. tv3 = tv2^2\n        tv3 = Fp.mul(tv3, v); // 4. tv3 = tv3 * v\n        let tv5 = Fp.mul(u, tv3); // 5. tv5 = u * tv3\n        tv5 = Fp.pow(tv5, c3); // 6. tv5 = tv5^c3\n        tv5 = Fp.mul(tv5, tv2); // 7. tv5 = tv5 * tv2\n        tv2 = Fp.mul(tv5, v); // 8. tv2 = tv5 * v\n        tv3 = Fp.mul(tv5, u); // 9. tv3 = tv5 * u\n        let tv4 = Fp.mul(tv3, tv2); // 10. tv4 = tv3 * tv2\n        tv5 = Fp.pow(tv4, c5); // 11. tv5 = tv4^c5\n        let isQR = Fp.eql(tv5, Fp.ONE); // 12. isQR = tv5 == 1\n        tv2 = Fp.mul(tv3, c7); // 13. tv2 = tv3 * c7\n        tv5 = Fp.mul(tv4, tv1); // 14. tv5 = tv4 * tv1\n        tv3 = Fp.cmov(tv2, tv3, isQR); // 15. tv3 = CMOV(tv2, tv3, isQR)\n        tv4 = Fp.cmov(tv5, tv4, isQR); // 16. tv4 = CMOV(tv5, tv4, isQR)\n        // 17. for i in (c1, c1 - 1, ..., 2):\n        for (let i = c1; i > _1n; i--) {\n            let tv5 = i - _2n; // 18.    tv5 = i - 2\n            tv5 = _2n << (tv5 - _1n); // 19.    tv5 = 2^tv5\n            let tvv5 = Fp.pow(tv4, tv5); // 20.    tv5 = tv4^tv5\n            const e1 = Fp.eql(tvv5, Fp.ONE); // 21.    e1 = tv5 == 1\n            tv2 = Fp.mul(tv3, tv1); // 22.    tv2 = tv3 * tv1\n            tv1 = Fp.mul(tv1, tv1); // 23.    tv1 = tv1 * tv1\n            tvv5 = Fp.mul(tv4, tv1); // 24.    tv5 = tv4 * tv1\n            tv3 = Fp.cmov(tv2, tv3, e1); // 25.    tv3 = CMOV(tv2, tv3, e1)\n            tv4 = Fp.cmov(tvv5, tv4, e1); // 26.    tv4 = CMOV(tv5, tv4, e1)\n        }\n        return { isValid: isQR, value: tv3 };\n    };\n    if (Fp.ORDER % _4n === _3n) {\n        // sqrt_ratio_3mod4(u, v)\n        const c1 = (Fp.ORDER - _3n) / _4n; // 1. c1 = (q - 3) / 4     # Integer arithmetic\n        const c2 = Fp.sqrt(Fp.neg(Z)); // 2. c2 = sqrt(-Z)\n        sqrtRatio = (u, v) => {\n            let tv1 = Fp.sqr(v); // 1. tv1 = v^2\n            const tv2 = Fp.mul(u, v); // 2. tv2 = u * v\n            tv1 = Fp.mul(tv1, tv2); // 3. tv1 = tv1 * tv2\n            let y1 = Fp.pow(tv1, c1); // 4. y1 = tv1^c1\n            y1 = Fp.mul(y1, tv2); // 5. y1 = y1 * tv2\n            const y2 = Fp.mul(y1, c2); // 6. y2 = y1 * c2\n            const tv3 = Fp.mul(Fp.sqr(y1), v); // 7. tv3 = y1^2; 8. tv3 = tv3 * v\n            const isQR = Fp.eql(tv3, u); // 9. isQR = tv3 == u\n            let y = Fp.cmov(y2, y1, isQR); // 10. y = CMOV(y2, y1, isQR)\n            return { isValid: isQR, value: y }; // 11. return (isQR, y) isQR ? y : y*c2\n        };\n    }\n    // No curves uses that\n    // if (Fp.ORDER % _8n === _5n) // sqrt_ratio_5mod8\n    return sqrtRatio;\n}\n/**\n * Simplified Shallue-van de Woestijne-Ulas Method\n * https://www.rfc-editor.org/rfc/rfc9380#section-6.6.2\n */\nexport function mapToCurveSimpleSWU(Fp, opts) {\n    mod.validateField(Fp);\n    if (!Fp.isValid(opts.A) || !Fp.isValid(opts.B) || !Fp.isValid(opts.Z))\n        throw new Error('mapToCurveSimpleSWU: invalid opts');\n    const sqrtRatio = SWUFpSqrtRatio(Fp, opts.Z);\n    if (!Fp.isOdd)\n        throw new Error('Fp.isOdd is not implemented!');\n    // Input: u, an element of F.\n    // Output: (x, y), a point on E.\n    return (u) => {\n        // prettier-ignore\n        let tv1, tv2, tv3, tv4, tv5, tv6, x, y;\n        tv1 = Fp.sqr(u); // 1.  tv1 = u^2\n        tv1 = Fp.mul(tv1, opts.Z); // 2.  tv1 = Z * tv1\n        tv2 = Fp.sqr(tv1); // 3.  tv2 = tv1^2\n        tv2 = Fp.add(tv2, tv1); // 4.  tv2 = tv2 + tv1\n        tv3 = Fp.add(tv2, Fp.ONE); // 5.  tv3 = tv2 + 1\n        tv3 = Fp.mul(tv3, opts.B); // 6.  tv3 = B * tv3\n        tv4 = Fp.cmov(opts.Z, Fp.neg(tv2), !Fp.eql(tv2, Fp.ZERO)); // 7.  tv4 = CMOV(Z, -tv2, tv2 != 0)\n        tv4 = Fp.mul(tv4, opts.A); // 8.  tv4 = A * tv4\n        tv2 = Fp.sqr(tv3); // 9.  tv2 = tv3^2\n        tv6 = Fp.sqr(tv4); // 10. tv6 = tv4^2\n        tv5 = Fp.mul(tv6, opts.A); // 11. tv5 = A * tv6\n        tv2 = Fp.add(tv2, tv5); // 12. tv2 = tv2 + tv5\n        tv2 = Fp.mul(tv2, tv3); // 13. tv2 = tv2 * tv3\n        tv6 = Fp.mul(tv6, tv4); // 14. tv6 = tv6 * tv4\n        tv5 = Fp.mul(tv6, opts.B); // 15. tv5 = B * tv6\n        tv2 = Fp.add(tv2, tv5); // 16. tv2 = tv2 + tv5\n        x = Fp.mul(tv1, tv3); // 17.   x = tv1 * tv3\n        const { isValid, value } = sqrtRatio(tv2, tv6); // 18. (is_gx1_square, y1) = sqrt_ratio(tv2, tv6)\n        y = Fp.mul(tv1, u); // 19.   y = tv1 * u  -> Z * u^3 * y1\n        y = Fp.mul(y, value); // 20.   y = y * y1\n        x = Fp.cmov(x, tv3, isValid); // 21.   x = CMOV(x, tv3, is_gx1_square)\n        y = Fp.cmov(y, value, isValid); // 22.   y = CMOV(y, y1, is_gx1_square)\n        const e1 = Fp.isOdd(u) === Fp.isOdd(y); // 23.  e1 = sgn0(u) == sgn0(y)\n        y = Fp.cmov(Fp.neg(y), y, e1); // 24.   y = CMOV(-y, y, e1)\n        x = Fp.div(x, tv4); // 25.   x = x / tv4\n        return { x, y };\n    };\n}\n//# sourceMappingURL=weierstrass.js.map","import { hash as assertHash, bytes as assertBytes, exists as assertExists } from './_assert.js';\nimport { Hash, toBytes } from './utils.js';\n// HMAC (RFC 2104)\nexport class HMAC extends Hash {\n    constructor(hash, _key) {\n        super();\n        this.finished = false;\n        this.destroyed = false;\n        assertHash(hash);\n        const key = toBytes(_key);\n        this.iHash = hash.create();\n        if (typeof this.iHash.update !== 'function')\n            throw new Error('Expected instance of class which extends utils.Hash');\n        this.blockLen = this.iHash.blockLen;\n        this.outputLen = this.iHash.outputLen;\n        const blockLen = this.blockLen;\n        const pad = new Uint8Array(blockLen);\n        // blockLen can be bigger than outputLen\n        pad.set(key.length > blockLen ? hash.create().update(key).digest() : key);\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36;\n        this.iHash.update(pad);\n        // By doing update (processing of first block) of outer hash here we can re-use it between multiple calls via clone\n        this.oHash = hash.create();\n        // Undo internal XOR && apply outer XOR\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36 ^ 0x5c;\n        this.oHash.update(pad);\n        pad.fill(0);\n    }\n    update(buf) {\n        assertExists(this);\n        this.iHash.update(buf);\n        return this;\n    }\n    digestInto(out) {\n        assertExists(this);\n        assertBytes(out, this.outputLen);\n        this.finished = true;\n        this.iHash.digestInto(out);\n        this.oHash.update(out);\n        this.oHash.digestInto(out);\n        this.destroy();\n    }\n    digest() {\n        const out = new Uint8Array(this.oHash.outputLen);\n        this.digestInto(out);\n        return out;\n    }\n    _cloneInto(to) {\n        // Create new instance without calling constructor since key already in state and we don't know it.\n        to || (to = Object.create(Object.getPrototypeOf(this), {}));\n        const { oHash, iHash, finished, destroyed, blockLen, outputLen } = this;\n        to = to;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        to.blockLen = blockLen;\n        to.outputLen = outputLen;\n        to.oHash = oHash._cloneInto(to.oHash);\n        to.iHash = iHash._cloneInto(to.iHash);\n        return to;\n    }\n    destroy() {\n        this.destroyed = true;\n        this.oHash.destroy();\n        this.iHash.destroy();\n    }\n}\n/**\n * HMAC: RFC2104 message authentication code.\n * @param hash - function that would be used e.g. sha256\n * @param key - message key\n * @param message - message data\n */\nexport const hmac = (hash, key, message) => new HMAC(hash, key).update(message).digest();\nhmac.create = (hash, key) => new HMAC(hash, key);\n//# sourceMappingURL=hmac.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { hmac } from '@noble/hashes/hmac';\nimport { concatBytes, randomBytes } from '@noble/hashes/utils';\nimport { weierstrass } from './abstract/weierstrass.js';\n// connects noble-curves to noble-hashes\nexport function getHash(hash) {\n    return {\n        hash,\n        hmac: (key, ...msgs) => hmac(hash, key, concatBytes(...msgs)),\n        randomBytes,\n    };\n}\nexport function createCurve(curveDef, defHash) {\n    const create = (hash) => weierstrass({ ...curveDef, ...getHash(hash) });\n    return Object.freeze({ ...create(defHash), create });\n}\n//# sourceMappingURL=_shortw_utils.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { sha256 } from '@noble/hashes/sha256';\nimport { randomBytes } from '@noble/hashes/utils';\nimport { Field, mod, pow2 } from './abstract/modular.js';\nimport { mapToCurveSimpleSWU } from './abstract/weierstrass.js';\nimport { bytesToNumberBE, concatBytes, ensureBytes, numberToBytesBE } from './abstract/utils.js';\nimport { createHasher, isogenyMap } from './abstract/hash-to-curve.js';\nimport { createCurve } from './_shortw_utils.js';\nconst secp256k1P = BigInt('0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f');\nconst secp256k1N = BigInt('0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141');\nconst _1n = BigInt(1);\nconst _2n = BigInt(2);\nconst divNearest = (a, b) => (a + b / _2n) / b;\n/**\n * √n = n^((p+1)/4) for fields p = 3 mod 4. We unwrap the loop and multiply bit-by-bit.\n * (P+1n/4n).toString(2) would produce bits [223x 1, 0, 22x 1, 4x 0, 11, 00]\n */\nfunction sqrtMod(y) {\n    const P = secp256k1P;\n    // prettier-ignore\n    const _3n = BigInt(3), _6n = BigInt(6), _11n = BigInt(11), _22n = BigInt(22);\n    // prettier-ignore\n    const _23n = BigInt(23), _44n = BigInt(44), _88n = BigInt(88);\n    const b2 = (y * y * y) % P; // x^3, 11\n    const b3 = (b2 * b2 * y) % P; // x^7\n    const b6 = (pow2(b3, _3n, P) * b3) % P;\n    const b9 = (pow2(b6, _3n, P) * b3) % P;\n    const b11 = (pow2(b9, _2n, P) * b2) % P;\n    const b22 = (pow2(b11, _11n, P) * b11) % P;\n    const b44 = (pow2(b22, _22n, P) * b22) % P;\n    const b88 = (pow2(b44, _44n, P) * b44) % P;\n    const b176 = (pow2(b88, _88n, P) * b88) % P;\n    const b220 = (pow2(b176, _44n, P) * b44) % P;\n    const b223 = (pow2(b220, _3n, P) * b3) % P;\n    const t1 = (pow2(b223, _23n, P) * b22) % P;\n    const t2 = (pow2(t1, _6n, P) * b2) % P;\n    const root = pow2(t2, _2n, P);\n    if (!Fp.eql(Fp.sqr(root), y))\n        throw new Error('Cannot find square root');\n    return root;\n}\nconst Fp = Field(secp256k1P, undefined, undefined, { sqrt: sqrtMod });\nexport const secp256k1 = createCurve({\n    a: BigInt(0),\n    b: BigInt(7),\n    Fp,\n    n: secp256k1N,\n    // Base point (x, y) aka generator point\n    Gx: BigInt('55066263022277343669578718895168534326250603453777594175500187360389116729240'),\n    Gy: BigInt('32670510020758816978083085130507043184471273380659243275938904335757337482424'),\n    h: BigInt(1),\n    lowS: true,\n    /**\n     * secp256k1 belongs to Koblitz curves: it has efficiently computable endomorphism.\n     * Endomorphism uses 2x less RAM, speeds up precomputation by 2x and ECDH / key recovery by 20%.\n     * For precomputed wNAF it trades off 1/2 init time & 1/3 ram for 20% perf hit.\n     * Explanation: https://gist.github.com/paulmillr/eb670806793e84df628a7c434a873066\n     */\n    endo: {\n        beta: BigInt('0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee'),\n        splitScalar: (k) => {\n            const n = secp256k1N;\n            const a1 = BigInt('0x3086d221a7d46bcde86c90e49284eb15');\n            const b1 = -_1n * BigInt('0xe4437ed6010e88286f547fa90abfe4c3');\n            const a2 = BigInt('0x114ca50f7a8e2f3f657c1108d9d44cfd8');\n            const b2 = a1;\n            const POW_2_128 = BigInt('0x100000000000000000000000000000000'); // (2n**128n).toString(16)\n            const c1 = divNearest(b2 * k, n);\n            const c2 = divNearest(-b1 * k, n);\n            let k1 = mod(k - c1 * a1 - c2 * a2, n);\n            let k2 = mod(-c1 * b1 - c2 * b2, n);\n            const k1neg = k1 > POW_2_128;\n            const k2neg = k2 > POW_2_128;\n            if (k1neg)\n                k1 = n - k1;\n            if (k2neg)\n                k2 = n - k2;\n            if (k1 > POW_2_128 || k2 > POW_2_128) {\n                throw new Error('splitScalar: Endomorphism failed, k=' + k);\n            }\n            return { k1neg, k1, k2neg, k2 };\n        },\n    },\n}, sha256);\n// Schnorr signatures are superior to ECDSA from above. Below is Schnorr-specific BIP0340 code.\n// https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki\nconst _0n = BigInt(0);\nconst fe = (x) => typeof x === 'bigint' && _0n < x && x < secp256k1P;\nconst ge = (x) => typeof x === 'bigint' && _0n < x && x < secp256k1N;\n/** An object mapping tags to their tagged hash prefix of [SHA256(tag) | SHA256(tag)] */\nconst TAGGED_HASH_PREFIXES = {};\nfunction taggedHash(tag, ...messages) {\n    let tagP = TAGGED_HASH_PREFIXES[tag];\n    if (tagP === undefined) {\n        const tagH = sha256(Uint8Array.from(tag, (c) => c.charCodeAt(0)));\n        tagP = concatBytes(tagH, tagH);\n        TAGGED_HASH_PREFIXES[tag] = tagP;\n    }\n    return sha256(concatBytes(tagP, ...messages));\n}\n// ECDSA compact points are 33-byte. Schnorr is 32: we strip first byte 0x02 or 0x03\nconst pointToBytes = (point) => point.toRawBytes(true).slice(1);\nconst numTo32b = (n) => numberToBytesBE(n, 32);\nconst modP = (x) => mod(x, secp256k1P);\nconst modN = (x) => mod(x, secp256k1N);\nconst Point = secp256k1.ProjectivePoint;\nconst GmulAdd = (Q, a, b) => Point.BASE.multiplyAndAddUnsafe(Q, a, b);\n// Calculate point, scalar and bytes\nfunction schnorrGetExtPubKey(priv) {\n    let d_ = secp256k1.utils.normPrivateKeyToScalar(priv); // same method executed in fromPrivateKey\n    let p = Point.fromPrivateKey(d_); // P = d'⋅G; 0 < d' < n check is done inside\n    const scalar = p.hasEvenY() ? d_ : modN(-d_);\n    return { scalar: scalar, bytes: pointToBytes(p) };\n}\n/**\n * lift_x from BIP340. Convert 32-byte x coordinate to elliptic curve point.\n * @returns valid point checked for being on-curve\n */\nfunction lift_x(x) {\n    if (!fe(x))\n        throw new Error('bad x: need 0 < x < p'); // Fail if x ≥ p.\n    const xx = modP(x * x);\n    const c = modP(xx * x + BigInt(7)); // Let c = x³ + 7 mod p.\n    let y = sqrtMod(c); // Let y = c^(p+1)/4 mod p.\n    if (y % _2n !== _0n)\n        y = modP(-y); // Return the unique point P such that x(P) = x and\n    const p = new Point(x, y, _1n); // y(P) = y if y mod 2 = 0 or y(P) = p-y otherwise.\n    p.assertValidity();\n    return p;\n}\n/**\n * Create tagged hash, convert it to bigint, reduce modulo-n.\n */\nfunction challenge(...args) {\n    return modN(bytesToNumberBE(taggedHash('BIP0340/challenge', ...args)));\n}\n/**\n * Schnorr public key is just `x` coordinate of Point as per BIP340.\n */\nfunction schnorrGetPublicKey(privateKey) {\n    return schnorrGetExtPubKey(privateKey).bytes; // d'=int(sk). Fail if d'=0 or d'≥n. Ret bytes(d'⋅G)\n}\n/**\n * Creates Schnorr signature as per BIP340. Verifies itself before returning anything.\n * auxRand is optional and is not the sole source of k generation: bad CSPRNG won't be dangerous.\n */\nfunction schnorrSign(message, privateKey, auxRand = randomBytes(32)) {\n    const m = ensureBytes('message', message);\n    const { bytes: px, scalar: d } = schnorrGetExtPubKey(privateKey); // checks for isWithinCurveOrder\n    const a = ensureBytes('auxRand', auxRand, 32); // Auxiliary random data a: a 32-byte array\n    const t = numTo32b(d ^ bytesToNumberBE(taggedHash('BIP0340/aux', a))); // Let t be the byte-wise xor of bytes(d) and hash/aux(a)\n    const rand = taggedHash('BIP0340/nonce', t, px, m); // Let rand = hash/nonce(t || bytes(P) || m)\n    const k_ = modN(bytesToNumberBE(rand)); // Let k' = int(rand) mod n\n    if (k_ === _0n)\n        throw new Error('sign failed: k is zero'); // Fail if k' = 0.\n    const { bytes: rx, scalar: k } = schnorrGetExtPubKey(k_); // Let R = k'⋅G.\n    const e = challenge(rx, px, m); // Let e = int(hash/challenge(bytes(R) || bytes(P) || m)) mod n.\n    const sig = new Uint8Array(64); // Let sig = bytes(R) || bytes((k + ed) mod n).\n    sig.set(rx, 0);\n    sig.set(numTo32b(modN(k + e * d)), 32);\n    // If Verify(bytes(P), m, sig) (see below) returns failure, abort\n    if (!schnorrVerify(sig, m, px))\n        throw new Error('sign: Invalid signature produced');\n    return sig;\n}\n/**\n * Verifies Schnorr signature.\n * Will swallow errors & return false except for initial type validation of arguments.\n */\nfunction schnorrVerify(signature, message, publicKey) {\n    const sig = ensureBytes('signature', signature, 64);\n    const m = ensureBytes('message', message);\n    const pub = ensureBytes('publicKey', publicKey, 32);\n    try {\n        const P = lift_x(bytesToNumberBE(pub)); // P = lift_x(int(pk)); fail if that fails\n        const r = bytesToNumberBE(sig.subarray(0, 32)); // Let r = int(sig[0:32]); fail if r ≥ p.\n        if (!fe(r))\n            return false;\n        const s = bytesToNumberBE(sig.subarray(32, 64)); // Let s = int(sig[32:64]); fail if s ≥ n.\n        if (!ge(s))\n            return false;\n        const e = challenge(numTo32b(r), pointToBytes(P), m); // int(challenge(bytes(r)||bytes(P)||m))%n\n        const R = GmulAdd(P, s, modN(-e)); // R = s⋅G - e⋅P\n        if (!R || !R.hasEvenY() || R.toAffine().x !== r)\n            return false; // -eP == (n-e)P\n        return true; // Fail if is_infinite(R) / not has_even_y(R) / x(R) ≠ r.\n    }\n    catch (error) {\n        return false;\n    }\n}\nexport const schnorr = /* @__PURE__ */ (() => ({\n    getPublicKey: schnorrGetPublicKey,\n    sign: schnorrSign,\n    verify: schnorrVerify,\n    utils: {\n        randomPrivateKey: secp256k1.utils.randomPrivateKey,\n        lift_x,\n        pointToBytes,\n        numberToBytesBE,\n        bytesToNumberBE,\n        taggedHash,\n        mod,\n    },\n}))();\nconst isoMap = /* @__PURE__ */ (() => isogenyMap(Fp, [\n    // xNum\n    [\n        '0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7',\n        '0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581',\n        '0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262',\n        '0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c',\n    ],\n    // xDen\n    [\n        '0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b',\n        '0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14',\n        '0x0000000000000000000000000000000000000000000000000000000000000001', // LAST 1\n    ],\n    // yNum\n    [\n        '0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c',\n        '0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3',\n        '0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931',\n        '0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84',\n    ],\n    // yDen\n    [\n        '0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b',\n        '0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573',\n        '0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f',\n        '0x0000000000000000000000000000000000000000000000000000000000000001', // LAST 1\n    ],\n].map((i) => i.map((j) => BigInt(j)))))();\nconst mapSWU = /* @__PURE__ */ (() => mapToCurveSimpleSWU(Fp, {\n    A: BigInt('0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533'),\n    B: BigInt('1771'),\n    Z: Fp.create(BigInt('-11')),\n}))();\nconst htf = /* @__PURE__ */ (() => createHasher(secp256k1.ProjectivePoint, (scalars) => {\n    const { x, y } = mapSWU(Fp.create(scalars[0]));\n    return isoMap(x, y);\n}, {\n    DST: 'secp256k1_XMD:SHA-256_SSWU_RO_',\n    encodeDST: 'secp256k1_XMD:SHA-256_SSWU_NU_',\n    p: Fp.ORDER,\n    m: 1,\n    k: 128,\n    expand: 'xmd',\n    hash: sha256,\n}))();\nexport const hashToCurve = /* @__PURE__ */ (() => htf.hashToCurve)();\nexport const encodeToCurve = /* @__PURE__ */ (() => htf.encodeToCurve)();\n//# sourceMappingURL=secp256k1.js.map","export const crypto = typeof globalThis === 'object' && 'crypto' in globalThis ? globalThis.crypto : undefined;\n//# sourceMappingURL=crypto.js.map","/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated, we can just drop the import.\nimport { crypto } from '@noble/hashes/crypto';\nconst u8a = (a) => a instanceof Uint8Array;\n// Cast array to different type\nexport const u8 = (arr) => new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\nexport const u32 = (arr) => new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n// Cast array to view\nexport const createView = (arr) => new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n// The rotate right (circular right shift) operation for uint32\nexport const rotr = (word, shift) => (word << (32 - shift)) | (word >>> shift);\n// big-endian hardware is rare. Just in case someone still decides to run hashes:\n// early-throw an error because we don't support BE yet.\nexport const isLE = new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44;\nif (!isLE)\n    throw new Error('Non little-endian hardware is not supported');\nconst hexes = Array.from({ length: 256 }, (v, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const len = hex.length;\n    if (len % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + len);\n    const array = new Uint8Array(len / 2);\n    for (let i = 0; i < array.length; i++) {\n        const j = i * 2;\n        const hexByte = hex.slice(j, j + 2);\n        const byte = Number.parseInt(hexByte, 16);\n        if (Number.isNaN(byte) || byte < 0)\n            throw new Error('Invalid byte sequence');\n        array[i] = byte;\n    }\n    return array;\n}\n// There is no setImmediate in browser and setTimeout is slow.\n// call of async fn will return Promise, which will be fullfiled only on\n// next scheduler queue processing step and this is exactly what we need.\nexport const nextTick = async () => { };\n// Returns control to thread each 'tick' ms to avoid blocking\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    if (!u8a(data))\n        throw new Error(`expected Uint8Array, got ${typeof data}`);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    const r = new Uint8Array(arrays.reduce((sum, a) => sum + a.length, 0));\n    let pad = 0; // walk through each item, ensure they have proper type\n    arrays.forEach((a) => {\n        if (!u8a(a))\n            throw new Error('Uint8Array expected');\n        r.set(a, pad);\n        pad += a.length;\n    });\n    return r;\n}\n// For runtime check if class implements interface\nexport class Hash {\n    // Safe version that clones internal state\n    clone() {\n        return this._cloneInto();\n    }\n}\n// Check if object doens't have custom constructor (like Uint8Array/Array)\nconst isPlainObject = (obj) => Object.prototype.toString.call(obj) === '[object Object]' && obj.constructor === Object;\nexport function checkOpts(defaults, opts) {\n    if (opts !== undefined && (typeof opts !== 'object' || !isPlainObject(opts)))\n        throw new Error('Options should be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\nexport function wrapConstructor(hashCons) {\n    const hashC = (msg) => hashCons().update(toBytes(msg)).digest();\n    const tmp = hashCons();\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = () => hashCons();\n    return hashC;\n}\nexport function wrapConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\nexport function wrapXOFConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\n/**\n * Secure PRNG. Uses `crypto.getRandomValues`, which defers to OS.\n */\nexport function randomBytes(bytesLength = 32) {\n    if (crypto && typeof crypto.getRandomValues === 'function') {\n        return crypto.getRandomValues(new Uint8Array(bytesLength));\n    }\n    throw new Error('crypto.getRandomValues must be defined');\n}\n//# sourceMappingURL=utils.js.map","export function number(n) {\n    if (!Number.isSafeInteger(n) || n < 0)\n        throw new Error(`Wrong positive integer: ${n}`);\n}\nexport function bool(b) {\n    if (typeof b !== 'boolean')\n        throw new Error(`Expected boolean, not ${b}`);\n}\nexport function bytes(b, ...lengths) {\n    if (!(b instanceof Uint8Array))\n        throw new Error('Expected Uint8Array');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error(`Expected Uint8Array of length ${lengths}, not of length=${b.length}`);\n}\nexport function hash(hash) {\n    if (typeof hash !== 'function' || typeof hash.create !== 'function')\n        throw new Error('Hash should be wrapped by utils.wrapConstructor');\n    number(hash.outputLen);\n    number(hash.blockLen);\n}\nexport function exists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error('Hash instance has been destroyed');\n    if (checkFinished && instance.finished)\n        throw new Error('Hash#digest() has already been called');\n}\nexport function output(out, instance) {\n    bytes(out);\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error(`digestInto() expects output buffer of length at least ${min}`);\n    }\n}\nconst assert = {\n    number,\n    bool,\n    bytes,\n    hash,\n    exists,\n    output,\n};\nexport default assert;\n//# sourceMappingURL=_assert.js.map","import assert from './_assert.js';\nimport { Hash, createView, toBytes } from './utils.js';\n// Polyfill for Safari 14\nfunction setBigUint64(view, byteOffset, value, isLE) {\n    if (typeof view.setBigUint64 === 'function')\n        return view.setBigUint64(byteOffset, value, isLE);\n    const _32n = BigInt(32);\n    const _u32_max = BigInt(0xffffffff);\n    const wh = Number((value >> _32n) & _u32_max);\n    const wl = Number(value & _u32_max);\n    const h = isLE ? 4 : 0;\n    const l = isLE ? 0 : 4;\n    view.setUint32(byteOffset + h, wh, isLE);\n    view.setUint32(byteOffset + l, wl, isLE);\n}\n// Base SHA2 class (RFC 6234)\nexport class SHA2 extends Hash {\n    constructor(blockLen, outputLen, padOffset, isLE) {\n        super();\n        this.blockLen = blockLen;\n        this.outputLen = outputLen;\n        this.padOffset = padOffset;\n        this.isLE = isLE;\n        this.finished = false;\n        this.length = 0;\n        this.pos = 0;\n        this.destroyed = false;\n        this.buffer = new Uint8Array(blockLen);\n        this.view = createView(this.buffer);\n    }\n    update(data) {\n        assert.exists(this);\n        const { view, buffer, blockLen } = this;\n        data = toBytes(data);\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input, cast it to view and process\n            if (take === blockLen) {\n                const dataView = createView(data);\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(dataView, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(view, 0);\n                this.pos = 0;\n            }\n        }\n        this.length += data.length;\n        this.roundClean();\n        return this;\n    }\n    digestInto(out) {\n        assert.exists(this);\n        assert.output(out, this);\n        this.finished = true;\n        // Padding\n        // We can avoid allocation of buffer for padding completely if it\n        // was previously not allocated here. But it won't change performance.\n        const { buffer, view, blockLen, isLE } = this;\n        let { pos } = this;\n        // append the bit '1' to the message\n        buffer[pos++] = 0b10000000;\n        this.buffer.subarray(pos).fill(0);\n        // we have less than padOffset left in buffer, so we cannot put length in current block, need process it and pad again\n        if (this.padOffset > blockLen - pos) {\n            this.process(view, 0);\n            pos = 0;\n        }\n        // Pad until full block byte with zeros\n        for (let i = pos; i < blockLen; i++)\n            buffer[i] = 0;\n        // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that\n        // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.\n        // So we just write lowest 64 bits of that value.\n        setBigUint64(view, blockLen - 8, BigInt(this.length * 8), isLE);\n        this.process(view, 0);\n        const oview = createView(out);\n        const len = this.outputLen;\n        // NOTE: we do division by 4 later, which should be fused in single op with modulo by JIT\n        if (len % 4)\n            throw new Error('_sha2: outputLen should be aligned to 32bit');\n        const outLen = len / 4;\n        const state = this.get();\n        if (outLen > state.length)\n            throw new Error('_sha2: outputLen bigger than state');\n        for (let i = 0; i < outLen; i++)\n            oview.setUint32(4 * i, state[i], isLE);\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n    _cloneInto(to) {\n        to || (to = new this.constructor());\n        to.set(...this.get());\n        const { blockLen, buffer, length, finished, destroyed, pos } = this;\n        to.length = length;\n        to.pos = pos;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        if (length % blockLen)\n            to.buffer.set(buffer);\n        return to;\n    }\n}\n//# sourceMappingURL=_sha2.js.map","import { SHA2 } from './_sha2.js';\nimport { rotr, wrapConstructor } from './utils.js';\n// Choice: a ? b : c\nconst Chi = (a, b, c) => (a & b) ^ (~a & c);\n// Majority function, true if any two inpust is true\nconst Maj = (a, b, c) => (a & b) ^ (a & c) ^ (b & c);\n// Round constants:\n// first 32 bits of the fractional parts of the cube roots of the first 64 primes 2..311)\n// prettier-ignore\nconst SHA256_K = new Uint32Array([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\n// Initial state (first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19):\n// prettier-ignore\nconst IV = new Uint32Array([\n    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19\n]);\n// Temporary buffer, not used to store anything between runs\n// Named this way because it matches specification.\nconst SHA256_W = new Uint32Array(64);\nclass SHA256 extends SHA2 {\n    constructor() {\n        super(64, 32, 8, false);\n        // We cannot use array here since array allows indexing by variable\n        // which means optimizer/compiler cannot use registers.\n        this.A = IV[0] | 0;\n        this.B = IV[1] | 0;\n        this.C = IV[2] | 0;\n        this.D = IV[3] | 0;\n        this.E = IV[4] | 0;\n        this.F = IV[5] | 0;\n        this.G = IV[6] | 0;\n        this.H = IV[7] | 0;\n    }\n    get() {\n        const { A, B, C, D, E, F, G, H } = this;\n        return [A, B, C, D, E, F, G, H];\n    }\n    // prettier-ignore\n    set(A, B, C, D, E, F, G, H) {\n        this.A = A | 0;\n        this.B = B | 0;\n        this.C = C | 0;\n        this.D = D | 0;\n        this.E = E | 0;\n        this.F = F | 0;\n        this.G = G | 0;\n        this.H = H | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4)\n            SHA256_W[i] = view.getUint32(offset, false);\n        for (let i = 16; i < 64; i++) {\n            const W15 = SHA256_W[i - 15];\n            const W2 = SHA256_W[i - 2];\n            const s0 = rotr(W15, 7) ^ rotr(W15, 18) ^ (W15 >>> 3);\n            const s1 = rotr(W2, 17) ^ rotr(W2, 19) ^ (W2 >>> 10);\n            SHA256_W[i] = (s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16]) | 0;\n        }\n        // Compression function main loop, 64 rounds\n        let { A, B, C, D, E, F, G, H } = this;\n        for (let i = 0; i < 64; i++) {\n            const sigma1 = rotr(E, 6) ^ rotr(E, 11) ^ rotr(E, 25);\n            const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const sigma0 = rotr(A, 2) ^ rotr(A, 13) ^ rotr(A, 22);\n            const T2 = (sigma0 + Maj(A, B, C)) | 0;\n            H = G;\n            G = F;\n            F = E;\n            E = (D + T1) | 0;\n            D = C;\n            C = B;\n            B = A;\n            A = (T1 + T2) | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        A = (A + this.A) | 0;\n        B = (B + this.B) | 0;\n        C = (C + this.C) | 0;\n        D = (D + this.D) | 0;\n        E = (E + this.E) | 0;\n        F = (F + this.F) | 0;\n        G = (G + this.G) | 0;\n        H = (H + this.H) | 0;\n        this.set(A, B, C, D, E, F, G, H);\n    }\n    roundClean() {\n        SHA256_W.fill(0);\n    }\n    destroy() {\n        this.set(0, 0, 0, 0, 0, 0, 0, 0);\n        this.buffer.fill(0);\n    }\n}\n// Constants from https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf\nclass SHA224 extends SHA256 {\n    constructor() {\n        super();\n        this.A = 0xc1059ed8 | 0;\n        this.B = 0x367cd507 | 0;\n        this.C = 0x3070dd17 | 0;\n        this.D = 0xf70e5939 | 0;\n        this.E = 0xffc00b31 | 0;\n        this.F = 0x68581511 | 0;\n        this.G = 0x64f98fa7 | 0;\n        this.H = 0xbefa4fa4 | 0;\n        this.outputLen = 28;\n    }\n}\n/**\n * SHA2-256 hash function\n * @param message - data that would be hashed\n */\nexport const sha256 = wrapConstructor(() => new SHA256());\nexport const sha224 = wrapConstructor(() => new SHA224());\n//# sourceMappingURL=sha256.js.map","/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nexport function assertNumber(n) {\n    if (!Number.isSafeInteger(n))\n        throw new Error(`Wrong integer: ${n}`);\n}\nfunction chain(...args) {\n    const wrap = (a, b) => (c) => a(b(c));\n    const encode = Array.from(args)\n        .reverse()\n        .reduce((acc, i) => (acc ? wrap(acc, i.encode) : i.encode), undefined);\n    const decode = args.reduce((acc, i) => (acc ? wrap(acc, i.decode) : i.decode), undefined);\n    return { encode, decode };\n}\nfunction alphabet(alphabet) {\n    return {\n        encode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('alphabet.encode input should be an array of numbers');\n            return digits.map((i) => {\n                assertNumber(i);\n                if (i < 0 || i >= alphabet.length)\n                    throw new Error(`Digit index outside alphabet: ${i} (alphabet: ${alphabet.length})`);\n                return alphabet[i];\n            });\n        },\n        decode: (input) => {\n            if (!Array.isArray(input) || (input.length && typeof input[0] !== 'string'))\n                throw new Error('alphabet.decode input should be array of strings');\n            return input.map((letter) => {\n                if (typeof letter !== 'string')\n                    throw new Error(`alphabet.decode: not string element=${letter}`);\n                const index = alphabet.indexOf(letter);\n                if (index === -1)\n                    throw new Error(`Unknown letter: \"${letter}\". Allowed: ${alphabet}`);\n                return index;\n            });\n        },\n    };\n}\nfunction join(separator = '') {\n    if (typeof separator !== 'string')\n        throw new Error('join separator should be string');\n    return {\n        encode: (from) => {\n            if (!Array.isArray(from) || (from.length && typeof from[0] !== 'string'))\n                throw new Error('join.encode input should be array of strings');\n            for (let i of from)\n                if (typeof i !== 'string')\n                    throw new Error(`join.encode: non-string input=${i}`);\n            return from.join(separator);\n        },\n        decode: (to) => {\n            if (typeof to !== 'string')\n                throw new Error('join.decode input should be string');\n            return to.split(separator);\n        },\n    };\n}\nfunction padding(bits, chr = '=') {\n    assertNumber(bits);\n    if (typeof chr !== 'string')\n        throw new Error('padding chr should be string');\n    return {\n        encode(data) {\n            if (!Array.isArray(data) || (data.length && typeof data[0] !== 'string'))\n                throw new Error('padding.encode input should be array of strings');\n            for (let i of data)\n                if (typeof i !== 'string')\n                    throw new Error(`padding.encode: non-string input=${i}`);\n            while ((data.length * bits) % 8)\n                data.push(chr);\n            return data;\n        },\n        decode(input) {\n            if (!Array.isArray(input) || (input.length && typeof input[0] !== 'string'))\n                throw new Error('padding.encode input should be array of strings');\n            for (let i of input)\n                if (typeof i !== 'string')\n                    throw new Error(`padding.decode: non-string input=${i}`);\n            let end = input.length;\n            if ((end * bits) % 8)\n                throw new Error('Invalid padding: string should have whole number of bytes');\n            for (; end > 0 && input[end - 1] === chr; end--) {\n                if (!(((end - 1) * bits) % 8))\n                    throw new Error('Invalid padding: string has too much padding');\n            }\n            return input.slice(0, end);\n        },\n    };\n}\nfunction normalize(fn) {\n    if (typeof fn !== 'function')\n        throw new Error('normalize fn should be function');\n    return { encode: (from) => from, decode: (to) => fn(to) };\n}\nfunction convertRadix(data, from, to) {\n    if (from < 2)\n        throw new Error(`convertRadix: wrong from=${from}, base cannot be less than 2`);\n    if (to < 2)\n        throw new Error(`convertRadix: wrong to=${to}, base cannot be less than 2`);\n    if (!Array.isArray(data))\n        throw new Error('convertRadix: data should be array');\n    if (!data.length)\n        return [];\n    let pos = 0;\n    const res = [];\n    const digits = Array.from(data);\n    digits.forEach((d) => {\n        assertNumber(d);\n        if (d < 0 || d >= from)\n            throw new Error(`Wrong integer: ${d}`);\n    });\n    while (true) {\n        let carry = 0;\n        let done = true;\n        for (let i = pos; i < digits.length; i++) {\n            const digit = digits[i];\n            const digitBase = from * carry + digit;\n            if (!Number.isSafeInteger(digitBase) ||\n                (from * carry) / from !== carry ||\n                digitBase - digit !== from * carry) {\n                throw new Error('convertRadix: carry overflow');\n            }\n            carry = digitBase % to;\n            digits[i] = Math.floor(digitBase / to);\n            if (!Number.isSafeInteger(digits[i]) || digits[i] * to + carry !== digitBase)\n                throw new Error('convertRadix: carry overflow');\n            if (!done)\n                continue;\n            else if (!digits[i])\n                pos = i;\n            else\n                done = false;\n        }\n        res.push(carry);\n        if (done)\n            break;\n    }\n    for (let i = 0; i < data.length - 1 && data[i] === 0; i++)\n        res.push(0);\n    return res.reverse();\n}\nconst gcd = (a, b) => (!b ? a : gcd(b, a % b));\nconst radix2carry = (from, to) => from + (to - gcd(from, to));\nfunction convertRadix2(data, from, to, padding) {\n    if (!Array.isArray(data))\n        throw new Error('convertRadix2: data should be array');\n    if (from <= 0 || from > 32)\n        throw new Error(`convertRadix2: wrong from=${from}`);\n    if (to <= 0 || to > 32)\n        throw new Error(`convertRadix2: wrong to=${to}`);\n    if (radix2carry(from, to) > 32) {\n        throw new Error(`convertRadix2: carry overflow from=${from} to=${to} carryBits=${radix2carry(from, to)}`);\n    }\n    let carry = 0;\n    let pos = 0;\n    const mask = 2 ** to - 1;\n    const res = [];\n    for (const n of data) {\n        assertNumber(n);\n        if (n >= 2 ** from)\n            throw new Error(`convertRadix2: invalid data word=${n} from=${from}`);\n        carry = (carry << from) | n;\n        if (pos + from > 32)\n            throw new Error(`convertRadix2: carry overflow pos=${pos} from=${from}`);\n        pos += from;\n        for (; pos >= to; pos -= to)\n            res.push(((carry >> (pos - to)) & mask) >>> 0);\n        carry &= 2 ** pos - 1;\n    }\n    carry = (carry << (to - pos)) & mask;\n    if (!padding && pos >= from)\n        throw new Error('Excess padding');\n    if (!padding && carry)\n        throw new Error(`Non-zero padding: ${carry}`);\n    if (padding && pos > 0)\n        res.push(carry >>> 0);\n    return res;\n}\nfunction radix(num) {\n    assertNumber(num);\n    return {\n        encode: (bytes) => {\n            if (!(bytes instanceof Uint8Array))\n                throw new Error('radix.encode input should be Uint8Array');\n            return convertRadix(Array.from(bytes), 2 ** 8, num);\n        },\n        decode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('radix.decode input should be array of strings');\n            return Uint8Array.from(convertRadix(digits, num, 2 ** 8));\n        },\n    };\n}\nfunction radix2(bits, revPadding = false) {\n    assertNumber(bits);\n    if (bits <= 0 || bits > 32)\n        throw new Error('radix2: bits should be in (0..32]');\n    if (radix2carry(8, bits) > 32 || radix2carry(bits, 8) > 32)\n        throw new Error('radix2: carry overflow');\n    return {\n        encode: (bytes) => {\n            if (!(bytes instanceof Uint8Array))\n                throw new Error('radix2.encode input should be Uint8Array');\n            return convertRadix2(Array.from(bytes), 8, bits, !revPadding);\n        },\n        decode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('radix2.decode input should be array of strings');\n            return Uint8Array.from(convertRadix2(digits, bits, 8, revPadding));\n        },\n    };\n}\nfunction unsafeWrapper(fn) {\n    if (typeof fn !== 'function')\n        throw new Error('unsafeWrapper fn should be function');\n    return function (...args) {\n        try {\n            return fn.apply(null, args);\n        }\n        catch (e) { }\n    };\n}\nfunction checksum(len, fn) {\n    assertNumber(len);\n    if (typeof fn !== 'function')\n        throw new Error('checksum fn should be function');\n    return {\n        encode(data) {\n            if (!(data instanceof Uint8Array))\n                throw new Error('checksum.encode: input should be Uint8Array');\n            const checksum = fn(data).slice(0, len);\n            const res = new Uint8Array(data.length + len);\n            res.set(data);\n            res.set(checksum, data.length);\n            return res;\n        },\n        decode(data) {\n            if (!(data instanceof Uint8Array))\n                throw new Error('checksum.decode: input should be Uint8Array');\n            const payload = data.slice(0, -len);\n            const newChecksum = fn(payload).slice(0, len);\n            const oldChecksum = data.slice(-len);\n            for (let i = 0; i < len; i++)\n                if (newChecksum[i] !== oldChecksum[i])\n                    throw new Error('Invalid checksum');\n            return payload;\n        },\n    };\n}\nexport const utils = { alphabet, chain, checksum, radix, radix2, join, padding };\nexport const base16 = chain(radix2(4), alphabet('0123456789ABCDEF'), join(''));\nexport const base32 = chain(radix2(5), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZ234567'), padding(5), join(''));\nexport const base32hex = chain(radix2(5), alphabet('0123456789ABCDEFGHIJKLMNOPQRSTUV'), padding(5), join(''));\nexport const base32crockford = chain(radix2(5), alphabet('0123456789ABCDEFGHJKMNPQRSTVWXYZ'), join(''), normalize((s) => s.toUpperCase().replace(/O/g, '0').replace(/[IL]/g, '1')));\nexport const base64 = chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'), padding(6), join(''));\nexport const base64url = chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'), padding(6), join(''));\nconst genBase58 = (abc) => chain(radix(58), alphabet(abc), join(''));\nexport const base58 = genBase58('123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz');\nexport const base58flickr = genBase58('123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ');\nexport const base58xrp = genBase58('rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz');\nconst XMR_BLOCK_LEN = [0, 2, 3, 5, 6, 7, 9, 10, 11];\nexport const base58xmr = {\n    encode(data) {\n        let res = '';\n        for (let i = 0; i < data.length; i += 8) {\n            const block = data.subarray(i, i + 8);\n            res += base58.encode(block).padStart(XMR_BLOCK_LEN[block.length], '1');\n        }\n        return res;\n    },\n    decode(str) {\n        let res = [];\n        for (let i = 0; i < str.length; i += 11) {\n            const slice = str.slice(i, i + 11);\n            const blockLen = XMR_BLOCK_LEN.indexOf(slice.length);\n            const block = base58.decode(slice);\n            for (let j = 0; j < block.length - blockLen; j++) {\n                if (block[j] !== 0)\n                    throw new Error('base58xmr: wrong padding');\n            }\n            res = res.concat(Array.from(block.slice(block.length - blockLen)));\n        }\n        return Uint8Array.from(res);\n    },\n};\nexport const base58check = (sha256) => chain(checksum(4, (data) => sha256(sha256(data))), base58);\nconst BECH_ALPHABET = chain(alphabet('qpzry9x8gf2tvdw0s3jn54khce6mua7l'), join(''));\nconst POLYMOD_GENERATORS = [0x3b6a57b2, 0x26508e6d, 0x1ea119fa, 0x3d4233dd, 0x2a1462b3];\nfunction bech32Polymod(pre) {\n    const b = pre >> 25;\n    let chk = (pre & 0x1ffffff) << 5;\n    for (let i = 0; i < POLYMOD_GENERATORS.length; i++) {\n        if (((b >> i) & 1) === 1)\n            chk ^= POLYMOD_GENERATORS[i];\n    }\n    return chk;\n}\nfunction bechChecksum(prefix, words, encodingConst = 1) {\n    const len = prefix.length;\n    let chk = 1;\n    for (let i = 0; i < len; i++) {\n        const c = prefix.charCodeAt(i);\n        if (c < 33 || c > 126)\n            throw new Error(`Invalid prefix (${prefix})`);\n        chk = bech32Polymod(chk) ^ (c >> 5);\n    }\n    chk = bech32Polymod(chk);\n    for (let i = 0; i < len; i++)\n        chk = bech32Polymod(chk) ^ (prefix.charCodeAt(i) & 0x1f);\n    for (let v of words)\n        chk = bech32Polymod(chk) ^ v;\n    for (let i = 0; i < 6; i++)\n        chk = bech32Polymod(chk);\n    chk ^= encodingConst;\n    return BECH_ALPHABET.encode(convertRadix2([chk % 2 ** 30], 30, 5, false));\n}\nfunction genBech32(encoding) {\n    const ENCODING_CONST = encoding === 'bech32' ? 1 : 0x2bc830a3;\n    const _words = radix2(5);\n    const fromWords = _words.decode;\n    const toWords = _words.encode;\n    const fromWordsUnsafe = unsafeWrapper(fromWords);\n    function encode(prefix, words, limit = 90) {\n        if (typeof prefix !== 'string')\n            throw new Error(`bech32.encode prefix should be string, not ${typeof prefix}`);\n        if (!Array.isArray(words) || (words.length && typeof words[0] !== 'number'))\n            throw new Error(`bech32.encode words should be array of numbers, not ${typeof words}`);\n        const actualLength = prefix.length + 7 + words.length;\n        if (limit !== false && actualLength > limit)\n            throw new TypeError(`Length ${actualLength} exceeds limit ${limit}`);\n        prefix = prefix.toLowerCase();\n        return `${prefix}1${BECH_ALPHABET.encode(words)}${bechChecksum(prefix, words, ENCODING_CONST)}`;\n    }\n    function decode(str, limit = 90) {\n        if (typeof str !== 'string')\n            throw new Error(`bech32.decode input should be string, not ${typeof str}`);\n        if (str.length < 8 || (limit !== false && str.length > limit))\n            throw new TypeError(`Wrong string length: ${str.length} (${str}). Expected (8..${limit})`);\n        const lowered = str.toLowerCase();\n        if (str !== lowered && str !== str.toUpperCase())\n            throw new Error(`String must be lowercase or uppercase`);\n        str = lowered;\n        const sepIndex = str.lastIndexOf('1');\n        if (sepIndex === 0 || sepIndex === -1)\n            throw new Error(`Letter \"1\" must be present between prefix and data only`);\n        const prefix = str.slice(0, sepIndex);\n        const _words = str.slice(sepIndex + 1);\n        if (_words.length < 6)\n            throw new Error('Data must be at least 6 characters long');\n        const words = BECH_ALPHABET.decode(_words).slice(0, -6);\n        const sum = bechChecksum(prefix, words, ENCODING_CONST);\n        if (!_words.endsWith(sum))\n            throw new Error(`Invalid checksum in ${str}: expected \"${sum}\"`);\n        return { prefix, words };\n    }\n    const decodeUnsafe = unsafeWrapper(decode);\n    function decodeToBytes(str) {\n        const { prefix, words } = decode(str, false);\n        return { prefix, words, bytes: fromWords(words) };\n    }\n    return { encode, decode, decodeToBytes, decodeUnsafe, fromWords, fromWordsUnsafe, toWords };\n}\nexport const bech32 = genBech32('bech32');\nexport const bech32m = genBech32('bech32m');\nexport const utf8 = {\n    encode: (data) => new TextDecoder().decode(data),\n    decode: (str) => new TextEncoder().encode(str),\n};\nexport const hex = chain(radix2(4), alphabet('0123456789abcdef'), join(''), normalize((s) => {\n    if (typeof s !== 'string' || s.length % 2)\n        throw new TypeError(`hex.decode: expected string, got ${typeof s} with length ${s.length}`);\n    return s.toLowerCase();\n}));\nconst CODERS = {\n    utf8, hex, base16, base32, base64, base64url, base58, base58xmr\n};\nconst coderTypeError = `Invalid encoding type. Available types: ${Object.keys(CODERS).join(', ')}`;\nexport const bytesToString = (type, bytes) => {\n    if (typeof type !== 'string' || !CODERS.hasOwnProperty(type))\n        throw new TypeError(coderTypeError);\n    if (!(bytes instanceof Uint8Array))\n        throw new TypeError('bytesToString() expects Uint8Array');\n    return CODERS[type].encode(bytes);\n};\nexport const str = bytesToString;\nexport const stringToBytes = (type, str) => {\n    if (!CODERS.hasOwnProperty(type))\n        throw new TypeError(coderTypeError);\n    if (typeof str !== 'string')\n        throw new TypeError('stringToBytes() expects string');\n    return CODERS[type].decode(str);\n};\nexport const bytes = stringToBytes;\n","function number(n) {\n    if (!Number.isSafeInteger(n) || n < 0)\n        throw new Error(`positive integer expected, not ${n}`);\n}\nfunction bool(b) {\n    if (typeof b !== 'boolean')\n        throw new Error(`boolean expected, not ${b}`);\n}\nexport function isBytes(a) {\n    return (a instanceof Uint8Array ||\n        (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array'));\n}\nfunction bytes(b, ...lengths) {\n    if (!isBytes(b))\n        throw new Error('Uint8Array expected');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error(`Uint8Array expected of length ${lengths}, not of length=${b.length}`);\n}\nfunction hash(hash) {\n    if (typeof hash !== 'function' || typeof hash.create !== 'function')\n        throw new Error('hash must be wrapped by utils.wrapConstructor');\n    number(hash.outputLen);\n    number(hash.blockLen);\n}\nfunction exists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error('Hash instance has been destroyed');\n    if (checkFinished && instance.finished)\n        throw new Error('Hash#digest() has already been called');\n}\nfunction output(out, instance) {\n    bytes(out);\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error(`digestInto() expects output buffer of length at least ${min}`);\n    }\n}\nexport { number, bool, bytes, hash, exists, output };\nconst assert = { number, bool, bytes, hash, exists, output };\nexport default assert;\n//# sourceMappingURL=_assert.js.map","/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */\nimport { bytes as abytes, isBytes } from './_assert.js';\n// Cast array to different type\nexport const u8 = (arr) => new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\nexport const u16 = (arr) => new Uint16Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 2));\nexport const u32 = (arr) => new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n// Cast array to view\nexport const createView = (arr) => new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n// big-endian hardware is rare. Just in case someone still decides to run ciphers:\n// early-throw an error because we don't support BE yet.\nexport const isLE = new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44;\nif (!isLE)\n    throw new Error('Non little-endian hardware is not supported');\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    abytes(bytes);\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, _A: 65, _F: 70, _a: 97, _f: 102 };\nfunction asciiToBase16(char) {\n    if (char >= asciis._0 && char <= asciis._9)\n        return char - asciis._0;\n    if (char >= asciis._A && char <= asciis._F)\n        return char - (asciis._A - 10);\n    if (char >= asciis._a && char <= asciis._f)\n        return char - (asciis._a - 10);\n    return;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const hl = hex.length;\n    const al = hl / 2;\n    if (hl % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + hl);\n    const array = new Uint8Array(al);\n    for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n        const n1 = asciiToBase16(hex.charCodeAt(hi));\n        const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n        if (n1 === undefined || n2 === undefined) {\n            const char = hex[hi] + hex[hi + 1];\n            throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' + hi);\n        }\n        array[ai] = n1 * 16 + n2;\n    }\n    return array;\n}\nexport function hexToNumber(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    // Big Endian\n    return BigInt(hex === '' ? '0' : `0x${hex}`);\n}\n// BE: Big Endian, LE: Little Endian\nexport function bytesToNumberBE(bytes) {\n    return hexToNumber(bytesToHex(bytes));\n}\nexport function numberToBytesBE(n, len) {\n    return hexToBytes(n.toString(16).padStart(len * 2, '0'));\n}\n// There is no setImmediate in browser and setTimeout is slow.\n// call of async fn will return Promise, which will be fullfiled only on\n// next scheduler queue processing step and this is exactly what we need.\nexport const nextTick = async () => { };\n// Returns control to thread each 'tick' ms to avoid blocking\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`string expected, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * @example bytesToUtf8(new Uint8Array([97, 98, 99])) // 'abc'\n */\nexport function bytesToUtf8(bytes) {\n    return new TextDecoder().decode(bytes);\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    else if (isBytes(data))\n        data = data.slice();\n    else\n        throw new Error(`Uint8Array expected, got ${typeof data}`);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    let sum = 0;\n    for (let i = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        abytes(a);\n        sum += a.length;\n    }\n    const res = new Uint8Array(sum);\n    for (let i = 0, pad = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        res.set(a, pad);\n        pad += a.length;\n    }\n    return res;\n}\nexport function checkOpts(defaults, opts) {\n    if (opts == null || typeof opts !== 'object')\n        throw new Error('options must be defined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\n// Compares 2 u8a-s in kinda constant time\nexport function equalBytes(a, b) {\n    if (a.length !== b.length)\n        return false;\n    let diff = 0;\n    for (let i = 0; i < a.length; i++)\n        diff |= a[i] ^ b[i];\n    return diff === 0;\n}\n// For runtime check if class implements interface\nexport class Hash {\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nexport const wrapCipher = (params, c) => {\n    Object.assign(c, params);\n    return c;\n};\n// Polyfill for Safari 14\nexport function setBigUint64(view, byteOffset, value, isLE) {\n    if (typeof view.setBigUint64 === 'function')\n        return view.setBigUint64(byteOffset, value, isLE);\n    const _32n = BigInt(32);\n    const _u32_max = BigInt(0xffffffff);\n    const wh = Number((value >> _32n) & _u32_max);\n    const wl = Number(value & _u32_max);\n    const h = isLE ? 4 : 0;\n    const l = isLE ? 0 : 4;\n    view.setUint32(byteOffset + h, wh, isLE);\n    view.setUint32(byteOffset + l, wl, isLE);\n}\nexport function u64Lengths(ciphertext, AAD) {\n    const num = new Uint8Array(16);\n    const view = createView(num);\n    setBigUint64(view, 0, BigInt(AAD ? AAD.length : 0), true);\n    setBigUint64(view, 8, BigInt(ciphertext.length), true);\n    return num;\n}\n//# sourceMappingURL=utils.js.map","// prettier-ignore\nimport { wrapCipher, createView, setBigUint64, equalBytes, u32, u8, } from './utils.js';\nimport { ghash, polyval } from './_polyval.js';\nimport { bytes as abytes } from './_assert.js';\n/*\nAES (Advanced Encryption Standard) aka Rijndael block cipher.\n\nData is split into 128-bit blocks. Encrypted in 10/12/14 rounds (128/192/256 bits). In every round:\n1. **S-box**, table substitution\n2. **Shift rows**, cyclic shift left of all rows of data array\n3. **Mix columns**, multiplying every column by fixed polynomial\n4. **Add round key**, round_key xor i-th column of array\n\nResources:\n- FIPS-197 https://csrc.nist.gov/files/pubs/fips/197/final/docs/fips-197.pdf\n- Original proposal: https://csrc.nist.gov/csrc/media/projects/cryptographic-standards-and-guidelines/documents/aes-development/rijndael-ammended.pdf\n*/\nconst BLOCK_SIZE = 16;\nconst BLOCK_SIZE32 = 4;\nconst EMPTY_BLOCK = new Uint8Array(BLOCK_SIZE);\nconst POLY = 0x11b; // 1 + x + x**3 + x**4 + x**8\n// TODO: remove multiplication, binary ops only\nfunction mul2(n) {\n    return (n << 1) ^ (POLY & -(n >> 7));\n}\nfunction mul(a, b) {\n    let res = 0;\n    for (; b > 0; b >>= 1) {\n        // Montgomery ladder\n        res ^= a & -(b & 1); // if (b&1) res ^=a (but const-time).\n        a = mul2(a); // a = 2*a\n    }\n    return res;\n}\n// AES S-box is generated using finite field inversion,\n// an affine transform, and xor of a constant 0x63.\nconst sbox = /* @__PURE__ */ (() => {\n    let t = new Uint8Array(256);\n    for (let i = 0, x = 1; i < 256; i++, x ^= mul2(x))\n        t[i] = x;\n    const box = new Uint8Array(256);\n    box[0] = 0x63; // first elm\n    for (let i = 0; i < 255; i++) {\n        let x = t[255 - i];\n        x |= x << 8;\n        box[t[i]] = (x ^ (x >> 4) ^ (x >> 5) ^ (x >> 6) ^ (x >> 7) ^ 0x63) & 0xff;\n    }\n    return box;\n})();\n// Inverted S-box\nconst invSbox = /* @__PURE__ */ sbox.map((_, j) => sbox.indexOf(j));\n// Rotate u32 by 8\nconst rotr32_8 = (n) => (n << 24) | (n >>> 8);\nconst rotl32_8 = (n) => (n << 8) | (n >>> 24);\n// T-table is optimization suggested in 5.2 of original proposal (missed from FIPS-197). Changes:\n// - LE instead of BE\n// - bigger tables: T0 and T1 are merged into T01 table and T2 & T3 into T23;\n//   so index is u16, instead of u8. This speeds up things, unexpectedly\nfunction genTtable(sbox, fn) {\n    if (sbox.length !== 256)\n        throw new Error('Wrong sbox length');\n    const T0 = new Uint32Array(256).map((_, j) => fn(sbox[j]));\n    const T1 = T0.map(rotl32_8);\n    const T2 = T1.map(rotl32_8);\n    const T3 = T2.map(rotl32_8);\n    const T01 = new Uint32Array(256 * 256);\n    const T23 = new Uint32Array(256 * 256);\n    const sbox2 = new Uint16Array(256 * 256);\n    for (let i = 0; i < 256; i++) {\n        for (let j = 0; j < 256; j++) {\n            const idx = i * 256 + j;\n            T01[idx] = T0[i] ^ T1[j];\n            T23[idx] = T2[i] ^ T3[j];\n            sbox2[idx] = (sbox[i] << 8) | sbox[j];\n        }\n    }\n    return { sbox, sbox2, T0, T1, T2, T3, T01, T23 };\n}\nconst tableEncoding = /* @__PURE__ */ genTtable(sbox, (s) => (mul(s, 3) << 24) | (s << 16) | (s << 8) | mul(s, 2));\nconst tableDecoding = /* @__PURE__ */ genTtable(invSbox, (s) => (mul(s, 11) << 24) | (mul(s, 13) << 16) | (mul(s, 9) << 8) | mul(s, 14));\nconst xPowers = /* @__PURE__ */ (() => {\n    const p = new Uint8Array(16);\n    for (let i = 0, x = 1; i < 16; i++, x = mul2(x))\n        p[i] = x;\n    return p;\n})();\nexport function expandKeyLE(key) {\n    abytes(key);\n    const len = key.length;\n    if (![16, 24, 32].includes(len))\n        throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${len}`);\n    const { sbox2 } = tableEncoding;\n    const k32 = u32(key);\n    const Nk = k32.length;\n    const subByte = (n) => applySbox(sbox2, n, n, n, n);\n    const xk = new Uint32Array(len + 28); // expanded key\n    xk.set(k32);\n    // 4.3.1 Key expansion\n    for (let i = Nk; i < xk.length; i++) {\n        let t = xk[i - 1];\n        if (i % Nk === 0)\n            t = subByte(rotr32_8(t)) ^ xPowers[i / Nk - 1];\n        else if (Nk > 6 && i % Nk === 4)\n            t = subByte(t);\n        xk[i] = xk[i - Nk] ^ t;\n    }\n    return xk;\n}\nexport function expandKeyDecLE(key) {\n    const encKey = expandKeyLE(key);\n    const xk = encKey.slice();\n    const Nk = encKey.length;\n    const { sbox2 } = tableEncoding;\n    const { T0, T1, T2, T3 } = tableDecoding;\n    // Inverse key by chunks of 4 (rounds)\n    for (let i = 0; i < Nk; i += 4) {\n        for (let j = 0; j < 4; j++)\n            xk[i + j] = encKey[Nk - i - 4 + j];\n    }\n    encKey.fill(0);\n    // apply InvMixColumn except first & last round\n    for (let i = 4; i < Nk - 4; i++) {\n        const x = xk[i];\n        const w = applySbox(sbox2, x, x, x, x);\n        xk[i] = T0[w & 0xff] ^ T1[(w >>> 8) & 0xff] ^ T2[(w >>> 16) & 0xff] ^ T3[w >>> 24];\n    }\n    return xk;\n}\n// Apply tables\nfunction apply0123(T01, T23, s0, s1, s2, s3) {\n    return (T01[((s0 << 8) & 0xff00) | ((s1 >>> 8) & 0xff)] ^\n        T23[((s2 >>> 8) & 0xff00) | ((s3 >>> 24) & 0xff)]);\n}\nfunction applySbox(sbox2, s0, s1, s2, s3) {\n    return (sbox2[(s0 & 0xff) | (s1 & 0xff00)] |\n        (sbox2[((s2 >>> 16) & 0xff) | ((s3 >>> 16) & 0xff00)] << 16));\n}\nfunction encrypt(xk, s0, s1, s2, s3) {\n    const { sbox2, T01, T23 } = tableEncoding;\n    let k = 0;\n    (s0 ^= xk[k++]), (s1 ^= xk[k++]), (s2 ^= xk[k++]), (s3 ^= xk[k++]);\n    const rounds = xk.length / 4 - 2;\n    for (let i = 0; i < rounds; i++) {\n        const t0 = xk[k++] ^ apply0123(T01, T23, s0, s1, s2, s3);\n        const t1 = xk[k++] ^ apply0123(T01, T23, s1, s2, s3, s0);\n        const t2 = xk[k++] ^ apply0123(T01, T23, s2, s3, s0, s1);\n        const t3 = xk[k++] ^ apply0123(T01, T23, s3, s0, s1, s2);\n        (s0 = t0), (s1 = t1), (s2 = t2), (s3 = t3);\n    }\n    // last round (without mixcolumns, so using SBOX2 table)\n    const t0 = xk[k++] ^ applySbox(sbox2, s0, s1, s2, s3);\n    const t1 = xk[k++] ^ applySbox(sbox2, s1, s2, s3, s0);\n    const t2 = xk[k++] ^ applySbox(sbox2, s2, s3, s0, s1);\n    const t3 = xk[k++] ^ applySbox(sbox2, s3, s0, s1, s2);\n    return { s0: t0, s1: t1, s2: t2, s3: t3 };\n}\nfunction decrypt(xk, s0, s1, s2, s3) {\n    const { sbox2, T01, T23 } = tableDecoding;\n    let k = 0;\n    (s0 ^= xk[k++]), (s1 ^= xk[k++]), (s2 ^= xk[k++]), (s3 ^= xk[k++]);\n    const rounds = xk.length / 4 - 2;\n    for (let i = 0; i < rounds; i++) {\n        const t0 = xk[k++] ^ apply0123(T01, T23, s0, s3, s2, s1);\n        const t1 = xk[k++] ^ apply0123(T01, T23, s1, s0, s3, s2);\n        const t2 = xk[k++] ^ apply0123(T01, T23, s2, s1, s0, s3);\n        const t3 = xk[k++] ^ apply0123(T01, T23, s3, s2, s1, s0);\n        (s0 = t0), (s1 = t1), (s2 = t2), (s3 = t3);\n    }\n    // Last round\n    const t0 = xk[k++] ^ applySbox(sbox2, s0, s3, s2, s1);\n    const t1 = xk[k++] ^ applySbox(sbox2, s1, s0, s3, s2);\n    const t2 = xk[k++] ^ applySbox(sbox2, s2, s1, s0, s3);\n    const t3 = xk[k++] ^ applySbox(sbox2, s3, s2, s1, s0);\n    return { s0: t0, s1: t1, s2: t2, s3: t3 };\n}\nfunction getDst(len, dst) {\n    if (!dst)\n        return new Uint8Array(len);\n    abytes(dst);\n    if (dst.length < len)\n        throw new Error(`aes: wrong destination length, expected at least ${len}, got: ${dst.length}`);\n    return dst;\n}\n// TODO: investigate merging with ctr32\nfunction ctrCounter(xk, nonce, src, dst) {\n    abytes(nonce, BLOCK_SIZE);\n    abytes(src);\n    const srcLen = src.length;\n    dst = getDst(srcLen, dst);\n    const ctr = nonce;\n    const c32 = u32(ctr);\n    // Fill block (empty, ctr=0)\n    let { s0, s1, s2, s3 } = encrypt(xk, c32[0], c32[1], c32[2], c32[3]);\n    const src32 = u32(src);\n    const dst32 = u32(dst);\n    // process blocks\n    for (let i = 0; i + 4 <= src32.length; i += 4) {\n        dst32[i + 0] = src32[i + 0] ^ s0;\n        dst32[i + 1] = src32[i + 1] ^ s1;\n        dst32[i + 2] = src32[i + 2] ^ s2;\n        dst32[i + 3] = src32[i + 3] ^ s3;\n        // Full 128 bit counter with wrap around\n        let carry = 1;\n        for (let i = ctr.length - 1; i >= 0; i--) {\n            carry = (carry + (ctr[i] & 0xff)) | 0;\n            ctr[i] = carry & 0xff;\n            carry >>>= 8;\n        }\n        ({ s0, s1, s2, s3 } = encrypt(xk, c32[0], c32[1], c32[2], c32[3]));\n    }\n    // leftovers (less than block)\n    // It's possible to handle > u32 fast, but is it worth it?\n    const start = BLOCK_SIZE * Math.floor(src32.length / BLOCK_SIZE32);\n    if (start < srcLen) {\n        const b32 = new Uint32Array([s0, s1, s2, s3]);\n        const buf = u8(b32);\n        for (let i = start, pos = 0; i < srcLen; i++, pos++)\n            dst[i] = src[i] ^ buf[pos];\n    }\n    return dst;\n}\n// AES CTR with overflowing 32 bit counter\n// It's possible to do 32le significantly simpler (and probably faster) by using u32.\n// But, we need both, and perf bottleneck is in ghash anyway.\nfunction ctr32(xk, isLE, nonce, src, dst) {\n    abytes(nonce, BLOCK_SIZE);\n    abytes(src);\n    dst = getDst(src.length, dst);\n    const ctr = nonce; // write new value to nonce, so it can be re-used\n    const c32 = u32(ctr);\n    const view = createView(ctr);\n    const src32 = u32(src);\n    const dst32 = u32(dst);\n    const ctrPos = isLE ? 0 : 12;\n    const srcLen = src.length;\n    // Fill block (empty, ctr=0)\n    let ctrNum = view.getUint32(ctrPos, isLE); // read current counter value\n    let { s0, s1, s2, s3 } = encrypt(xk, c32[0], c32[1], c32[2], c32[3]);\n    // process blocks\n    for (let i = 0; i + 4 <= src32.length; i += 4) {\n        dst32[i + 0] = src32[i + 0] ^ s0;\n        dst32[i + 1] = src32[i + 1] ^ s1;\n        dst32[i + 2] = src32[i + 2] ^ s2;\n        dst32[i + 3] = src32[i + 3] ^ s3;\n        ctrNum = (ctrNum + 1) >>> 0; // u32 wrap\n        view.setUint32(ctrPos, ctrNum, isLE);\n        ({ s0, s1, s2, s3 } = encrypt(xk, c32[0], c32[1], c32[2], c32[3]));\n    }\n    // leftovers (less than a block)\n    const start = BLOCK_SIZE * Math.floor(src32.length / BLOCK_SIZE32);\n    if (start < srcLen) {\n        const b32 = new Uint32Array([s0, s1, s2, s3]);\n        const buf = u8(b32);\n        for (let i = start, pos = 0; i < srcLen; i++, pos++)\n            dst[i] = src[i] ^ buf[pos];\n    }\n    return dst;\n}\n/**\n * CTR: counter mode. Creates stream cipher.\n * Requires good IV. Parallelizable. OK, but no MAC.\n */\nexport const ctr = wrapCipher({ blockSize: 16, nonceLength: 16 }, function ctr(key, nonce) {\n    abytes(key);\n    abytes(nonce, BLOCK_SIZE);\n    function processCtr(buf, dst) {\n        const xk = expandKeyLE(key);\n        const n = nonce.slice();\n        const out = ctrCounter(xk, n, buf, dst);\n        xk.fill(0);\n        n.fill(0);\n        return out;\n    }\n    return {\n        encrypt: (plaintext, dst) => processCtr(plaintext, dst),\n        decrypt: (ciphertext, dst) => processCtr(ciphertext, dst),\n    };\n});\nfunction validateBlockDecrypt(data) {\n    abytes(data);\n    if (data.length % BLOCK_SIZE !== 0) {\n        throw new Error(`aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size ${BLOCK_SIZE}`);\n    }\n}\nfunction validateBlockEncrypt(plaintext, pcks5, dst) {\n    let outLen = plaintext.length;\n    const remaining = outLen % BLOCK_SIZE;\n    if (!pcks5 && remaining !== 0)\n        throw new Error('aec/(cbc-ecb): unpadded plaintext with disabled padding');\n    const b = u32(plaintext);\n    if (pcks5) {\n        let left = BLOCK_SIZE - remaining;\n        if (!left)\n            left = BLOCK_SIZE; // if no bytes left, create empty padding block\n        outLen = outLen + left;\n    }\n    const out = getDst(outLen, dst);\n    const o = u32(out);\n    return { b, o, out };\n}\nfunction validatePCKS(data, pcks5) {\n    if (!pcks5)\n        return data;\n    const len = data.length;\n    if (!len)\n        throw new Error(`aes/pcks5: empty ciphertext not allowed`);\n    const lastByte = data[len - 1];\n    if (lastByte <= 0 || lastByte > 16)\n        throw new Error(`aes/pcks5: wrong padding byte: ${lastByte}`);\n    const out = data.subarray(0, -lastByte);\n    for (let i = 0; i < lastByte; i++)\n        if (data[len - i - 1] !== lastByte)\n            throw new Error(`aes/pcks5: wrong padding`);\n    return out;\n}\nfunction padPCKS(left) {\n    const tmp = new Uint8Array(16);\n    const tmp32 = u32(tmp);\n    tmp.set(left);\n    const paddingByte = BLOCK_SIZE - left.length;\n    for (let i = BLOCK_SIZE - paddingByte; i < BLOCK_SIZE; i++)\n        tmp[i] = paddingByte;\n    return tmp32;\n}\n/**\n * ECB: Electronic CodeBook. Simple deterministic replacement.\n * Dangerous: always map x to y. See [AES Penguin](https://words.filippo.io/the-ecb-penguin/).\n */\nexport const ecb = wrapCipher({ blockSize: 16 }, function ecb(key, opts = {}) {\n    abytes(key);\n    const pcks5 = !opts.disablePadding;\n    return {\n        encrypt: (plaintext, dst) => {\n            abytes(plaintext);\n            const { b, o, out: _out } = validateBlockEncrypt(plaintext, pcks5, dst);\n            const xk = expandKeyLE(key);\n            let i = 0;\n            for (; i + 4 <= b.length;) {\n                const { s0, s1, s2, s3 } = encrypt(xk, b[i + 0], b[i + 1], b[i + 2], b[i + 3]);\n                (o[i++] = s0), (o[i++] = s1), (o[i++] = s2), (o[i++] = s3);\n            }\n            if (pcks5) {\n                const tmp32 = padPCKS(plaintext.subarray(i * 4));\n                const { s0, s1, s2, s3 } = encrypt(xk, tmp32[0], tmp32[1], tmp32[2], tmp32[3]);\n                (o[i++] = s0), (o[i++] = s1), (o[i++] = s2), (o[i++] = s3);\n            }\n            xk.fill(0);\n            return _out;\n        },\n        decrypt: (ciphertext, dst) => {\n            validateBlockDecrypt(ciphertext);\n            const xk = expandKeyDecLE(key);\n            const out = getDst(ciphertext.length, dst);\n            const b = u32(ciphertext);\n            const o = u32(out);\n            for (let i = 0; i + 4 <= b.length;) {\n                const { s0, s1, s2, s3 } = decrypt(xk, b[i + 0], b[i + 1], b[i + 2], b[i + 3]);\n                (o[i++] = s0), (o[i++] = s1), (o[i++] = s2), (o[i++] = s3);\n            }\n            xk.fill(0);\n            return validatePCKS(out, pcks5);\n        },\n    };\n});\n/**\n * CBC: Cipher-Block-Chaining. Key is previous round’s block.\n * Fragile: needs proper padding. Unauthenticated: needs MAC.\n */\nexport const cbc = wrapCipher({ blockSize: 16, nonceLength: 16 }, function cbc(key, iv, opts = {}) {\n    abytes(key);\n    abytes(iv, 16);\n    const pcks5 = !opts.disablePadding;\n    return {\n        encrypt: (plaintext, dst) => {\n            const xk = expandKeyLE(key);\n            const { b, o, out: _out } = validateBlockEncrypt(plaintext, pcks5, dst);\n            const n32 = u32(iv);\n            // prettier-ignore\n            let s0 = n32[0], s1 = n32[1], s2 = n32[2], s3 = n32[3];\n            let i = 0;\n            for (; i + 4 <= b.length;) {\n                (s0 ^= b[i + 0]), (s1 ^= b[i + 1]), (s2 ^= b[i + 2]), (s3 ^= b[i + 3]);\n                ({ s0, s1, s2, s3 } = encrypt(xk, s0, s1, s2, s3));\n                (o[i++] = s0), (o[i++] = s1), (o[i++] = s2), (o[i++] = s3);\n            }\n            if (pcks5) {\n                const tmp32 = padPCKS(plaintext.subarray(i * 4));\n                (s0 ^= tmp32[0]), (s1 ^= tmp32[1]), (s2 ^= tmp32[2]), (s3 ^= tmp32[3]);\n                ({ s0, s1, s2, s3 } = encrypt(xk, s0, s1, s2, s3));\n                (o[i++] = s0), (o[i++] = s1), (o[i++] = s2), (o[i++] = s3);\n            }\n            xk.fill(0);\n            return _out;\n        },\n        decrypt: (ciphertext, dst) => {\n            validateBlockDecrypt(ciphertext);\n            const xk = expandKeyDecLE(key);\n            const n32 = u32(iv);\n            const out = getDst(ciphertext.length, dst);\n            const b = u32(ciphertext);\n            const o = u32(out);\n            // prettier-ignore\n            let s0 = n32[0], s1 = n32[1], s2 = n32[2], s3 = n32[3];\n            for (let i = 0; i + 4 <= b.length;) {\n                // prettier-ignore\n                const ps0 = s0, ps1 = s1, ps2 = s2, ps3 = s3;\n                (s0 = b[i + 0]), (s1 = b[i + 1]), (s2 = b[i + 2]), (s3 = b[i + 3]);\n                const { s0: o0, s1: o1, s2: o2, s3: o3 } = decrypt(xk, s0, s1, s2, s3);\n                (o[i++] = o0 ^ ps0), (o[i++] = o1 ^ ps1), (o[i++] = o2 ^ ps2), (o[i++] = o3 ^ ps3);\n            }\n            xk.fill(0);\n            return validatePCKS(out, pcks5);\n        },\n    };\n});\n/**\n * CFB: Cipher Feedback Mode. The input for the block cipher is the previous cipher output.\n * Unauthenticated: needs MAC.\n */\nexport const cfb = wrapCipher({ blockSize: 16, nonceLength: 16 }, function cfb(key, iv) {\n    abytes(key);\n    abytes(iv, 16);\n    function processCfb(src, isEncrypt, dst) {\n        const xk = expandKeyLE(key);\n        const srcLen = src.length;\n        dst = getDst(srcLen, dst);\n        const src32 = u32(src);\n        const dst32 = u32(dst);\n        const next32 = isEncrypt ? dst32 : src32;\n        const n32 = u32(iv);\n        // prettier-ignore\n        let s0 = n32[0], s1 = n32[1], s2 = n32[2], s3 = n32[3];\n        for (let i = 0; i + 4 <= src32.length;) {\n            const { s0: e0, s1: e1, s2: e2, s3: e3 } = encrypt(xk, s0, s1, s2, s3);\n            dst32[i + 0] = src32[i + 0] ^ e0;\n            dst32[i + 1] = src32[i + 1] ^ e1;\n            dst32[i + 2] = src32[i + 2] ^ e2;\n            dst32[i + 3] = src32[i + 3] ^ e3;\n            (s0 = next32[i++]), (s1 = next32[i++]), (s2 = next32[i++]), (s3 = next32[i++]);\n        }\n        // leftovers (less than block)\n        const start = BLOCK_SIZE * Math.floor(src32.length / BLOCK_SIZE32);\n        if (start < srcLen) {\n            ({ s0, s1, s2, s3 } = encrypt(xk, s0, s1, s2, s3));\n            const buf = u8(new Uint32Array([s0, s1, s2, s3]));\n            for (let i = start, pos = 0; i < srcLen; i++, pos++)\n                dst[i] = src[i] ^ buf[pos];\n            buf.fill(0);\n        }\n        xk.fill(0);\n        return dst;\n    }\n    return {\n        encrypt: (plaintext, dst) => processCfb(plaintext, true, dst),\n        decrypt: (ciphertext, dst) => processCfb(ciphertext, false, dst),\n    };\n});\n// TODO: merge with chacha, however gcm has bitLen while chacha has byteLen\nfunction computeTag(fn, isLE, key, data, AAD) {\n    const h = fn.create(key, data.length + (AAD?.length || 0));\n    if (AAD)\n        h.update(AAD);\n    h.update(data);\n    const num = new Uint8Array(16);\n    const view = createView(num);\n    if (AAD)\n        setBigUint64(view, 0, BigInt(AAD.length * 8), isLE);\n    setBigUint64(view, 8, BigInt(data.length * 8), isLE);\n    h.update(num);\n    return h.digest();\n}\n/**\n * GCM: Galois/Counter Mode.\n * Good, modern version of CTR, parallel, with MAC.\n * Be careful: MACs can be forged.\n */\nexport const gcm = wrapCipher({ blockSize: 16, nonceLength: 12, tagLength: 16 }, function gcm(key, nonce, AAD) {\n    abytes(nonce);\n    // Nonce can be pretty much anything (even 1 byte). But smaller nonces less secure.\n    if (nonce.length === 0)\n        throw new Error('aes/gcm: empty nonce');\n    const tagLength = 16;\n    function _computeTag(authKey, tagMask, data) {\n        const tag = computeTag(ghash, false, authKey, data, AAD);\n        for (let i = 0; i < tagMask.length; i++)\n            tag[i] ^= tagMask[i];\n        return tag;\n    }\n    function deriveKeys() {\n        const xk = expandKeyLE(key);\n        const authKey = EMPTY_BLOCK.slice();\n        const counter = EMPTY_BLOCK.slice();\n        ctr32(xk, false, counter, counter, authKey);\n        if (nonce.length === 12) {\n            counter.set(nonce);\n        }\n        else {\n            // Spec (NIST 800-38d) supports variable size nonce.\n            // Not supported for now, but can be useful.\n            const nonceLen = EMPTY_BLOCK.slice();\n            const view = createView(nonceLen);\n            setBigUint64(view, 8, BigInt(nonce.length * 8), false);\n            // ghash(nonce || u64be(0) || u64be(nonceLen*8))\n            ghash.create(authKey).update(nonce).update(nonceLen).digestInto(counter);\n        }\n        const tagMask = ctr32(xk, false, counter, EMPTY_BLOCK);\n        return { xk, authKey, counter, tagMask };\n    }\n    return {\n        encrypt: (plaintext) => {\n            abytes(plaintext);\n            const { xk, authKey, counter, tagMask } = deriveKeys();\n            const out = new Uint8Array(plaintext.length + tagLength);\n            ctr32(xk, false, counter, plaintext, out);\n            const tag = _computeTag(authKey, tagMask, out.subarray(0, out.length - tagLength));\n            out.set(tag, plaintext.length);\n            xk.fill(0);\n            return out;\n        },\n        decrypt: (ciphertext) => {\n            abytes(ciphertext);\n            if (ciphertext.length < tagLength)\n                throw new Error(`aes/gcm: ciphertext less than tagLen (${tagLength})`);\n            const { xk, authKey, counter, tagMask } = deriveKeys();\n            const data = ciphertext.subarray(0, -tagLength);\n            const passedTag = ciphertext.subarray(-tagLength);\n            const tag = _computeTag(authKey, tagMask, data);\n            if (!equalBytes(tag, passedTag))\n                throw new Error('aes/gcm: invalid ghash tag');\n            const out = ctr32(xk, false, counter, data);\n            authKey.fill(0);\n            tagMask.fill(0);\n            xk.fill(0);\n            return out;\n        },\n    };\n});\nconst limit = (name, min, max) => (value) => {\n    if (!Number.isSafeInteger(value) || min > value || value > max)\n        throw new Error(`${name}: invalid value=${value}, must be [${min}..${max}]`);\n};\n/**\n * AES-GCM-SIV: classic AES-GCM with nonce-misuse resistance.\n * Guarantees that, when a nonce is repeated, the only security loss is that identical\n * plaintexts will produce identical ciphertexts.\n * RFC 8452, https://datatracker.ietf.org/doc/html/rfc8452\n */\nexport const siv = wrapCipher({ blockSize: 16, nonceLength: 12, tagLength: 16 }, function siv(key, nonce, AAD) {\n    const tagLength = 16;\n    // From RFC 8452: Section 6\n    const AAD_LIMIT = limit('AAD', 0, 2 ** 36);\n    const PLAIN_LIMIT = limit('plaintext', 0, 2 ** 36);\n    const NONCE_LIMIT = limit('nonce', 12, 12);\n    const CIPHER_LIMIT = limit('ciphertext', 16, 2 ** 36 + 16);\n    abytes(nonce);\n    NONCE_LIMIT(nonce.length);\n    if (AAD) {\n        abytes(AAD);\n        AAD_LIMIT(AAD.length);\n    }\n    function deriveKeys() {\n        const len = key.length;\n        if (len !== 16 && len !== 24 && len !== 32)\n            throw new Error(`key length must be 16, 24 or 32 bytes, got: ${len} bytes`);\n        const xk = expandKeyLE(key);\n        const encKey = new Uint8Array(len);\n        const authKey = new Uint8Array(16);\n        const n32 = u32(nonce);\n        // prettier-ignore\n        let s0 = 0, s1 = n32[0], s2 = n32[1], s3 = n32[2];\n        let counter = 0;\n        for (const derivedKey of [authKey, encKey].map(u32)) {\n            const d32 = u32(derivedKey);\n            for (let i = 0; i < d32.length; i += 2) {\n                // aes(u32le(0) || nonce)[:8] || aes(u32le(1) || nonce)[:8] ...\n                const { s0: o0, s1: o1 } = encrypt(xk, s0, s1, s2, s3);\n                d32[i + 0] = o0;\n                d32[i + 1] = o1;\n                s0 = ++counter; // increment counter inside state\n            }\n        }\n        xk.fill(0);\n        return { authKey, encKey: expandKeyLE(encKey) };\n    }\n    function _computeTag(encKey, authKey, data) {\n        const tag = computeTag(polyval, true, authKey, data, AAD);\n        // Compute the expected tag by XORing S_s and the nonce, clearing the\n        // most significant bit of the last byte and encrypting with the\n        // message-encryption key.\n        for (let i = 0; i < 12; i++)\n            tag[i] ^= nonce[i];\n        tag[15] &= 0x7f; // Clear the highest bit\n        // encrypt tag as block\n        const t32 = u32(tag);\n        // prettier-ignore\n        let s0 = t32[0], s1 = t32[1], s2 = t32[2], s3 = t32[3];\n        ({ s0, s1, s2, s3 } = encrypt(encKey, s0, s1, s2, s3));\n        (t32[0] = s0), (t32[1] = s1), (t32[2] = s2), (t32[3] = s3);\n        return tag;\n    }\n    // actual decrypt/encrypt of message.\n    function processSiv(encKey, tag, input) {\n        let block = tag.slice();\n        block[15] |= 0x80; // Force highest bit\n        return ctr32(encKey, true, block, input);\n    }\n    return {\n        encrypt: (plaintext) => {\n            abytes(plaintext);\n            PLAIN_LIMIT(plaintext.length);\n            const { encKey, authKey } = deriveKeys();\n            const tag = _computeTag(encKey, authKey, plaintext);\n            const out = new Uint8Array(plaintext.length + tagLength);\n            out.set(tag, plaintext.length);\n            out.set(processSiv(encKey, tag, plaintext));\n            encKey.fill(0);\n            authKey.fill(0);\n            return out;\n        },\n        decrypt: (ciphertext) => {\n            abytes(ciphertext);\n            CIPHER_LIMIT(ciphertext.length);\n            const tag = ciphertext.subarray(-tagLength);\n            const { encKey, authKey } = deriveKeys();\n            const plaintext = processSiv(encKey, tag, ciphertext.subarray(0, -tagLength));\n            const expectedTag = _computeTag(encKey, authKey, plaintext);\n            encKey.fill(0);\n            authKey.fill(0);\n            if (!equalBytes(tag, expectedTag))\n                throw new Error('invalid polyval tag');\n            return plaintext;\n        },\n    };\n});\nfunction isBytes32(a) {\n    return (a != null &&\n        typeof a === 'object' &&\n        (a instanceof Uint32Array || a.constructor.name === 'Uint32Array'));\n}\nfunction encryptBlock(xk, block) {\n    abytes(block, 16);\n    if (!isBytes32(xk))\n        throw new Error('_encryptBlock accepts result of expandKeyLE');\n    const b32 = u32(block);\n    let { s0, s1, s2, s3 } = encrypt(xk, b32[0], b32[1], b32[2], b32[3]);\n    (b32[0] = s0), (b32[1] = s1), (b32[2] = s2), (b32[3] = s3);\n    return block;\n}\nfunction decryptBlock(xk, block) {\n    abytes(block, 16);\n    if (!isBytes32(xk))\n        throw new Error('_decryptBlock accepts result of expandKeyLE');\n    const b32 = u32(block);\n    let { s0, s1, s2, s3 } = decrypt(xk, b32[0], b32[1], b32[2], b32[3]);\n    (b32[0] = s0), (b32[1] = s1), (b32[2] = s2), (b32[3] = s3);\n    return block;\n}\n// Highly unsafe private functions for implementing new modes or ciphers based on AES\n// Can change at any time, no API guarantees\nexport const unsafe = {\n    expandKeyLE,\n    expandKeyDecLE,\n    encrypt,\n    decrypt,\n    encryptBlock,\n    decryptBlock,\n    ctrCounter,\n    ctr32,\n};\n//# sourceMappingURL=aes.js.map","import { exists as aexists, bytes as abytes, output as aoutput } from './_assert.js';\nimport { toBytes } from './utils.js';\n// Poly1305 is a fast and parallel secret-key message-authentication code.\n// https://cr.yp.to/mac.html, https://cr.yp.to/mac/poly1305-20050329.pdf\n// https://datatracker.ietf.org/doc/html/rfc8439\n// Based on Public Domain poly1305-donna https://github.com/floodyberry/poly1305-donna\nconst u8to16 = (a, i) => (a[i++] & 0xff) | ((a[i++] & 0xff) << 8);\nclass Poly1305 {\n    constructor(key) {\n        this.blockLen = 16;\n        this.outputLen = 16;\n        this.buffer = new Uint8Array(16);\n        this.r = new Uint16Array(10);\n        this.h = new Uint16Array(10);\n        this.pad = new Uint16Array(8);\n        this.pos = 0;\n        this.finished = false;\n        key = toBytes(key);\n        abytes(key, 32);\n        const t0 = u8to16(key, 0);\n        const t1 = u8to16(key, 2);\n        const t2 = u8to16(key, 4);\n        const t3 = u8to16(key, 6);\n        const t4 = u8to16(key, 8);\n        const t5 = u8to16(key, 10);\n        const t6 = u8to16(key, 12);\n        const t7 = u8to16(key, 14);\n        // https://github.com/floodyberry/poly1305-donna/blob/e6ad6e091d30d7f4ec2d4f978be1fcfcbce72781/poly1305-donna-16.h#L47\n        this.r[0] = t0 & 0x1fff;\n        this.r[1] = ((t0 >>> 13) | (t1 << 3)) & 0x1fff;\n        this.r[2] = ((t1 >>> 10) | (t2 << 6)) & 0x1f03;\n        this.r[3] = ((t2 >>> 7) | (t3 << 9)) & 0x1fff;\n        this.r[4] = ((t3 >>> 4) | (t4 << 12)) & 0x00ff;\n        this.r[5] = (t4 >>> 1) & 0x1ffe;\n        this.r[6] = ((t4 >>> 14) | (t5 << 2)) & 0x1fff;\n        this.r[7] = ((t5 >>> 11) | (t6 << 5)) & 0x1f81;\n        this.r[8] = ((t6 >>> 8) | (t7 << 8)) & 0x1fff;\n        this.r[9] = (t7 >>> 5) & 0x007f;\n        for (let i = 0; i < 8; i++)\n            this.pad[i] = u8to16(key, 16 + 2 * i);\n    }\n    process(data, offset, isLast = false) {\n        const hibit = isLast ? 0 : 1 << 11;\n        const { h, r } = this;\n        const r0 = r[0];\n        const r1 = r[1];\n        const r2 = r[2];\n        const r3 = r[3];\n        const r4 = r[4];\n        const r5 = r[5];\n        const r6 = r[6];\n        const r7 = r[7];\n        const r8 = r[8];\n        const r9 = r[9];\n        const t0 = u8to16(data, offset + 0);\n        const t1 = u8to16(data, offset + 2);\n        const t2 = u8to16(data, offset + 4);\n        const t3 = u8to16(data, offset + 6);\n        const t4 = u8to16(data, offset + 8);\n        const t5 = u8to16(data, offset + 10);\n        const t6 = u8to16(data, offset + 12);\n        const t7 = u8to16(data, offset + 14);\n        let h0 = h[0] + (t0 & 0x1fff);\n        let h1 = h[1] + (((t0 >>> 13) | (t1 << 3)) & 0x1fff);\n        let h2 = h[2] + (((t1 >>> 10) | (t2 << 6)) & 0x1fff);\n        let h3 = h[3] + (((t2 >>> 7) | (t3 << 9)) & 0x1fff);\n        let h4 = h[4] + (((t3 >>> 4) | (t4 << 12)) & 0x1fff);\n        let h5 = h[5] + ((t4 >>> 1) & 0x1fff);\n        let h6 = h[6] + (((t4 >>> 14) | (t5 << 2)) & 0x1fff);\n        let h7 = h[7] + (((t5 >>> 11) | (t6 << 5)) & 0x1fff);\n        let h8 = h[8] + (((t6 >>> 8) | (t7 << 8)) & 0x1fff);\n        let h9 = h[9] + ((t7 >>> 5) | hibit);\n        let c = 0;\n        let d0 = c + h0 * r0 + h1 * (5 * r9) + h2 * (5 * r8) + h3 * (5 * r7) + h4 * (5 * r6);\n        c = d0 >>> 13;\n        d0 &= 0x1fff;\n        d0 += h5 * (5 * r5) + h6 * (5 * r4) + h7 * (5 * r3) + h8 * (5 * r2) + h9 * (5 * r1);\n        c += d0 >>> 13;\n        d0 &= 0x1fff;\n        let d1 = c + h0 * r1 + h1 * r0 + h2 * (5 * r9) + h3 * (5 * r8) + h4 * (5 * r7);\n        c = d1 >>> 13;\n        d1 &= 0x1fff;\n        d1 += h5 * (5 * r6) + h6 * (5 * r5) + h7 * (5 * r4) + h8 * (5 * r3) + h9 * (5 * r2);\n        c += d1 >>> 13;\n        d1 &= 0x1fff;\n        let d2 = c + h0 * r2 + h1 * r1 + h2 * r0 + h3 * (5 * r9) + h4 * (5 * r8);\n        c = d2 >>> 13;\n        d2 &= 0x1fff;\n        d2 += h5 * (5 * r7) + h6 * (5 * r6) + h7 * (5 * r5) + h8 * (5 * r4) + h9 * (5 * r3);\n        c += d2 >>> 13;\n        d2 &= 0x1fff;\n        let d3 = c + h0 * r3 + h1 * r2 + h2 * r1 + h3 * r0 + h4 * (5 * r9);\n        c = d3 >>> 13;\n        d3 &= 0x1fff;\n        d3 += h5 * (5 * r8) + h6 * (5 * r7) + h7 * (5 * r6) + h8 * (5 * r5) + h9 * (5 * r4);\n        c += d3 >>> 13;\n        d3 &= 0x1fff;\n        let d4 = c + h0 * r4 + h1 * r3 + h2 * r2 + h3 * r1 + h4 * r0;\n        c = d4 >>> 13;\n        d4 &= 0x1fff;\n        d4 += h5 * (5 * r9) + h6 * (5 * r8) + h7 * (5 * r7) + h8 * (5 * r6) + h9 * (5 * r5);\n        c += d4 >>> 13;\n        d4 &= 0x1fff;\n        let d5 = c + h0 * r5 + h1 * r4 + h2 * r3 + h3 * r2 + h4 * r1;\n        c = d5 >>> 13;\n        d5 &= 0x1fff;\n        d5 += h5 * r0 + h6 * (5 * r9) + h7 * (5 * r8) + h8 * (5 * r7) + h9 * (5 * r6);\n        c += d5 >>> 13;\n        d5 &= 0x1fff;\n        let d6 = c + h0 * r6 + h1 * r5 + h2 * r4 + h3 * r3 + h4 * r2;\n        c = d6 >>> 13;\n        d6 &= 0x1fff;\n        d6 += h5 * r1 + h6 * r0 + h7 * (5 * r9) + h8 * (5 * r8) + h9 * (5 * r7);\n        c += d6 >>> 13;\n        d6 &= 0x1fff;\n        let d7 = c + h0 * r7 + h1 * r6 + h2 * r5 + h3 * r4 + h4 * r3;\n        c = d7 >>> 13;\n        d7 &= 0x1fff;\n        d7 += h5 * r2 + h6 * r1 + h7 * r0 + h8 * (5 * r9) + h9 * (5 * r8);\n        c += d7 >>> 13;\n        d7 &= 0x1fff;\n        let d8 = c + h0 * r8 + h1 * r7 + h2 * r6 + h3 * r5 + h4 * r4;\n        c = d8 >>> 13;\n        d8 &= 0x1fff;\n        d8 += h5 * r3 + h6 * r2 + h7 * r1 + h8 * r0 + h9 * (5 * r9);\n        c += d8 >>> 13;\n        d8 &= 0x1fff;\n        let d9 = c + h0 * r9 + h1 * r8 + h2 * r7 + h3 * r6 + h4 * r5;\n        c = d9 >>> 13;\n        d9 &= 0x1fff;\n        d9 += h5 * r4 + h6 * r3 + h7 * r2 + h8 * r1 + h9 * r0;\n        c += d9 >>> 13;\n        d9 &= 0x1fff;\n        c = ((c << 2) + c) | 0;\n        c = (c + d0) | 0;\n        d0 = c & 0x1fff;\n        c = c >>> 13;\n        d1 += c;\n        h[0] = d0;\n        h[1] = d1;\n        h[2] = d2;\n        h[3] = d3;\n        h[4] = d4;\n        h[5] = d5;\n        h[6] = d6;\n        h[7] = d7;\n        h[8] = d8;\n        h[9] = d9;\n    }\n    finalize() {\n        const { h, pad } = this;\n        const g = new Uint16Array(10);\n        let c = h[1] >>> 13;\n        h[1] &= 0x1fff;\n        for (let i = 2; i < 10; i++) {\n            h[i] += c;\n            c = h[i] >>> 13;\n            h[i] &= 0x1fff;\n        }\n        h[0] += c * 5;\n        c = h[0] >>> 13;\n        h[0] &= 0x1fff;\n        h[1] += c;\n        c = h[1] >>> 13;\n        h[1] &= 0x1fff;\n        h[2] += c;\n        g[0] = h[0] + 5;\n        c = g[0] >>> 13;\n        g[0] &= 0x1fff;\n        for (let i = 1; i < 10; i++) {\n            g[i] = h[i] + c;\n            c = g[i] >>> 13;\n            g[i] &= 0x1fff;\n        }\n        g[9] -= 1 << 13;\n        let mask = (c ^ 1) - 1;\n        for (let i = 0; i < 10; i++)\n            g[i] &= mask;\n        mask = ~mask;\n        for (let i = 0; i < 10; i++)\n            h[i] = (h[i] & mask) | g[i];\n        h[0] = (h[0] | (h[1] << 13)) & 0xffff;\n        h[1] = ((h[1] >>> 3) | (h[2] << 10)) & 0xffff;\n        h[2] = ((h[2] >>> 6) | (h[3] << 7)) & 0xffff;\n        h[3] = ((h[3] >>> 9) | (h[4] << 4)) & 0xffff;\n        h[4] = ((h[4] >>> 12) | (h[5] << 1) | (h[6] << 14)) & 0xffff;\n        h[5] = ((h[6] >>> 2) | (h[7] << 11)) & 0xffff;\n        h[6] = ((h[7] >>> 5) | (h[8] << 8)) & 0xffff;\n        h[7] = ((h[8] >>> 8) | (h[9] << 5)) & 0xffff;\n        let f = h[0] + pad[0];\n        h[0] = f & 0xffff;\n        for (let i = 1; i < 8; i++) {\n            f = (((h[i] + pad[i]) | 0) + (f >>> 16)) | 0;\n            h[i] = f & 0xffff;\n        }\n    }\n    update(data) {\n        aexists(this);\n        const { buffer, blockLen } = this;\n        data = toBytes(data);\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input\n            if (take === blockLen) {\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(data, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(buffer, 0, false);\n                this.pos = 0;\n            }\n        }\n        return this;\n    }\n    destroy() {\n        this.h.fill(0);\n        this.r.fill(0);\n        this.buffer.fill(0);\n        this.pad.fill(0);\n    }\n    digestInto(out) {\n        aexists(this);\n        aoutput(out, this);\n        this.finished = true;\n        const { buffer, h } = this;\n        let { pos } = this;\n        if (pos) {\n            buffer[pos++] = 1;\n            // buffer.subarray(pos).fill(0);\n            for (; pos < 16; pos++)\n                buffer[pos] = 0;\n            this.process(buffer, 0, true);\n        }\n        this.finalize();\n        let opos = 0;\n        for (let i = 0; i < 8; i++) {\n            out[opos++] = h[i] >>> 0;\n            out[opos++] = h[i] >>> 8;\n        }\n        return out;\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n}\nexport function wrapConstructorWithKey(hashCons) {\n    const hashC = (msg, key) => hashCons(key).update(toBytes(msg)).digest();\n    const tmp = hashCons(new Uint8Array(32));\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (key) => hashCons(key);\n    return hashC;\n}\nexport const poly1305 = wrapConstructorWithKey((key) => new Poly1305(key));\n//# sourceMappingURL=_poly1305.js.map","// Basic utils for ARX (add-rotate-xor) salsa and chacha ciphers.\nimport { number as anumber, bytes as abytes, bool as abool } from './_assert.js';\nimport { checkOpts, u32 } from './utils.js';\n/*\nRFC8439 requires multi-step cipher stream, where\nauthKey starts with counter: 0, actual msg with counter: 1.\n\nFor this, we need a way to re-use nonce / counter:\n\n    const counter = new Uint8Array(4);\n    chacha(..., counter, ...); // counter is now 1\n    chacha(..., counter, ...); // counter is now 2\n\nThis is complicated:\n\n- 32-bit counters are enough, no need for 64-bit: max ArrayBuffer size in JS is 4GB\n- Original papers don't allow mutating counters\n- Counter overflow is undefined [^1]\n- Idea A: allow providing (nonce | counter) instead of just nonce, re-use it\n- Caveat: Cannot be re-used through all cases:\n- * chacha has (counter | nonce)\n- * xchacha has (nonce16 | counter | nonce16)\n- Idea B: separate nonce / counter and provide separate API for counter re-use\n- Caveat: there are different counter sizes depending on an algorithm.\n- salsa & chacha also differ in structures of key & sigma:\n  salsa20:      s[0] | k(4) | s[1] | nonce(2) | ctr(2) | s[2] | k(4) | s[3]\n  chacha:       s(4) | k(8) | ctr(1) | nonce(3)\n  chacha20orig: s(4) | k(8) | ctr(2) | nonce(2)\n- Idea C: helper method such as `setSalsaState(key, nonce, sigma, data)`\n- Caveat: we can't re-use counter array\n\nxchacha [^2] uses the subkey and remaining 8 byte nonce with ChaCha20 as normal\n(prefixed by 4 NUL bytes, since [RFC8439] specifies a 12-byte nonce).\n\n[^1]: https://mailarchive.ietf.org/arch/msg/cfrg/gsOnTJzcbgG6OqD8Sc0GO5aR_tU/\n[^2]: https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-xchacha#appendix-A.2\n*/\n// We can't make top-level var depend on utils.utf8ToBytes\n// because it's not present in all envs. Creating a similar fn here\nconst _utf8ToBytes = (str) => Uint8Array.from(str.split('').map((c) => c.charCodeAt(0)));\nconst sigma16 = _utf8ToBytes('expand 16-byte k');\nconst sigma32 = _utf8ToBytes('expand 32-byte k');\nconst sigma16_32 = u32(sigma16);\nconst sigma32_32 = u32(sigma32);\nexport const sigma = sigma32_32.slice();\nexport function rotl(a, b) {\n    return (a << b) | (a >>> (32 - b));\n}\n// Is byte array aligned to 4 byte offset (u32)?\nfunction isAligned32(b) {\n    return b.byteOffset % 4 === 0;\n}\n// Salsa and Chacha block length is always 512-bit\nconst BLOCK_LEN = 64;\nconst BLOCK_LEN32 = 16;\n// new Uint32Array([2**32])   // => Uint32Array(1) [ 0 ]\n// new Uint32Array([2**32-1]) // => Uint32Array(1) [ 4294967295 ]\nconst MAX_COUNTER = 2 ** 32 - 1;\nconst U32_EMPTY = new Uint32Array();\nfunction runCipher(core, sigma, key, nonce, data, output, counter, rounds) {\n    const len = data.length;\n    const block = new Uint8Array(BLOCK_LEN);\n    const b32 = u32(block);\n    // Make sure that buffers aligned to 4 bytes\n    const isAligned = isAligned32(data) && isAligned32(output);\n    const d32 = isAligned ? u32(data) : U32_EMPTY;\n    const o32 = isAligned ? u32(output) : U32_EMPTY;\n    for (let pos = 0; pos < len; counter++) {\n        core(sigma, key, nonce, b32, counter, rounds);\n        if (counter >= MAX_COUNTER)\n            throw new Error('arx: counter overflow');\n        const take = Math.min(BLOCK_LEN, len - pos);\n        // aligned to 4 bytes\n        if (isAligned && take === BLOCK_LEN) {\n            const pos32 = pos / 4;\n            if (pos % 4 !== 0)\n                throw new Error('arx: invalid block position');\n            for (let j = 0, posj; j < BLOCK_LEN32; j++) {\n                posj = pos32 + j;\n                o32[posj] = d32[posj] ^ b32[j];\n            }\n            pos += BLOCK_LEN;\n            continue;\n        }\n        for (let j = 0, posj; j < take; j++) {\n            posj = pos + j;\n            output[posj] = data[posj] ^ block[j];\n        }\n        pos += take;\n    }\n}\nexport function createCipher(core, opts) {\n    const { allowShortKeys, extendNonceFn, counterLength, counterRight, rounds } = checkOpts({ allowShortKeys: false, counterLength: 8, counterRight: false, rounds: 20 }, opts);\n    if (typeof core !== 'function')\n        throw new Error('core must be a function');\n    anumber(counterLength);\n    anumber(rounds);\n    abool(counterRight);\n    abool(allowShortKeys);\n    return (key, nonce, data, output, counter = 0) => {\n        abytes(key);\n        abytes(nonce);\n        abytes(data);\n        const len = data.length;\n        if (!output)\n            output = new Uint8Array(len);\n        abytes(output);\n        anumber(counter);\n        if (counter < 0 || counter >= MAX_COUNTER)\n            throw new Error('arx: counter overflow');\n        if (output.length < len)\n            throw new Error(`arx: output (${output.length}) is shorter than data (${len})`);\n        const toClean = [];\n        // Key & sigma\n        // key=16 -> sigma16, k=key|key\n        // key=32 -> sigma32, k=key\n        let l = key.length, k, sigma;\n        if (l === 32) {\n            k = key.slice();\n            toClean.push(k);\n            sigma = sigma32_32;\n        }\n        else if (l === 16 && allowShortKeys) {\n            k = new Uint8Array(32);\n            k.set(key);\n            k.set(key, 16);\n            sigma = sigma16_32;\n            toClean.push(k);\n        }\n        else {\n            throw new Error(`arx: invalid 32-byte key, got length=${l}`);\n        }\n        // Nonce\n        // salsa20:      8   (8-byte counter)\n        // chacha20orig: 8   (8-byte counter)\n        // chacha20:     12  (4-byte counter)\n        // xsalsa20:     24  (16 -> hsalsa,  8 -> old nonce)\n        // xchacha20:    24  (16 -> hchacha, 8 -> old nonce)\n        // Align nonce to 4 bytes\n        if (!isAligned32(nonce)) {\n            nonce = nonce.slice();\n            toClean.push(nonce);\n        }\n        const k32 = u32(k);\n        // hsalsa & hchacha: handle extended nonce\n        if (extendNonceFn) {\n            if (nonce.length !== 24)\n                throw new Error(`arx: extended nonce must be 24 bytes`);\n            extendNonceFn(sigma, k32, u32(nonce.subarray(0, 16)), k32);\n            nonce = nonce.subarray(16);\n        }\n        // Handle nonce counter\n        const nonceNcLen = 16 - counterLength;\n        if (nonceNcLen !== nonce.length)\n            throw new Error(`arx: nonce must be ${nonceNcLen} or 16 bytes`);\n        // Pad counter when nonce is 64 bit\n        if (nonceNcLen !== 12) {\n            const nc = new Uint8Array(12);\n            nc.set(nonce, counterRight ? 0 : 12 - nonce.length);\n            nonce = nc;\n            toClean.push(nonce);\n        }\n        const n32 = u32(nonce);\n        runCipher(core, sigma, k32, n32, data, output, counter, rounds);\n        while (toClean.length > 0)\n            toClean.pop().fill(0);\n        return output;\n    };\n}\n//# sourceMappingURL=_arx.js.map","// prettier-ignore\nimport { wrapCipher, createView, equalBytes, setBigUint64, } from './utils.js';\nimport { poly1305 } from './_poly1305.js';\nimport { createCipher, rotl } from './_arx.js';\nimport { bytes as abytes } from './_assert.js';\n// ChaCha20 stream cipher was released in 2008. ChaCha aims to increase\n// the diffusion per round, but had slightly less cryptanalysis.\n// https://cr.yp.to/chacha.html, http://cr.yp.to/chacha/chacha-20080128.pdf\n/**\n * ChaCha core function.\n */\n// prettier-ignore\nfunction chachaCore(s, k, n, out, cnt, rounds = 20) {\n    let y00 = s[0], y01 = s[1], y02 = s[2], y03 = s[3], // \"expa\"   \"nd 3\"  \"2-by\"  \"te k\"\n    y04 = k[0], y05 = k[1], y06 = k[2], y07 = k[3], // Key      Key     Key     Key\n    y08 = k[4], y09 = k[5], y10 = k[6], y11 = k[7], // Key      Key     Key     Key\n    y12 = cnt, y13 = n[0], y14 = n[1], y15 = n[2]; // Counter  Counter\tNonce   Nonce\n    // Save state to temporary variables\n    let x00 = y00, x01 = y01, x02 = y02, x03 = y03, x04 = y04, x05 = y05, x06 = y06, x07 = y07, x08 = y08, x09 = y09, x10 = y10, x11 = y11, x12 = y12, x13 = y13, x14 = y14, x15 = y15;\n    for (let r = 0; r < rounds; r += 2) {\n        x00 = (x00 + x04) | 0;\n        x12 = rotl(x12 ^ x00, 16);\n        x08 = (x08 + x12) | 0;\n        x04 = rotl(x04 ^ x08, 12);\n        x00 = (x00 + x04) | 0;\n        x12 = rotl(x12 ^ x00, 8);\n        x08 = (x08 + x12) | 0;\n        x04 = rotl(x04 ^ x08, 7);\n        x01 = (x01 + x05) | 0;\n        x13 = rotl(x13 ^ x01, 16);\n        x09 = (x09 + x13) | 0;\n        x05 = rotl(x05 ^ x09, 12);\n        x01 = (x01 + x05) | 0;\n        x13 = rotl(x13 ^ x01, 8);\n        x09 = (x09 + x13) | 0;\n        x05 = rotl(x05 ^ x09, 7);\n        x02 = (x02 + x06) | 0;\n        x14 = rotl(x14 ^ x02, 16);\n        x10 = (x10 + x14) | 0;\n        x06 = rotl(x06 ^ x10, 12);\n        x02 = (x02 + x06) | 0;\n        x14 = rotl(x14 ^ x02, 8);\n        x10 = (x10 + x14) | 0;\n        x06 = rotl(x06 ^ x10, 7);\n        x03 = (x03 + x07) | 0;\n        x15 = rotl(x15 ^ x03, 16);\n        x11 = (x11 + x15) | 0;\n        x07 = rotl(x07 ^ x11, 12);\n        x03 = (x03 + x07) | 0;\n        x15 = rotl(x15 ^ x03, 8);\n        x11 = (x11 + x15) | 0;\n        x07 = rotl(x07 ^ x11, 7);\n        x00 = (x00 + x05) | 0;\n        x15 = rotl(x15 ^ x00, 16);\n        x10 = (x10 + x15) | 0;\n        x05 = rotl(x05 ^ x10, 12);\n        x00 = (x00 + x05) | 0;\n        x15 = rotl(x15 ^ x00, 8);\n        x10 = (x10 + x15) | 0;\n        x05 = rotl(x05 ^ x10, 7);\n        x01 = (x01 + x06) | 0;\n        x12 = rotl(x12 ^ x01, 16);\n        x11 = (x11 + x12) | 0;\n        x06 = rotl(x06 ^ x11, 12);\n        x01 = (x01 + x06) | 0;\n        x12 = rotl(x12 ^ x01, 8);\n        x11 = (x11 + x12) | 0;\n        x06 = rotl(x06 ^ x11, 7);\n        x02 = (x02 + x07) | 0;\n        x13 = rotl(x13 ^ x02, 16);\n        x08 = (x08 + x13) | 0;\n        x07 = rotl(x07 ^ x08, 12);\n        x02 = (x02 + x07) | 0;\n        x13 = rotl(x13 ^ x02, 8);\n        x08 = (x08 + x13) | 0;\n        x07 = rotl(x07 ^ x08, 7);\n        x03 = (x03 + x04) | 0;\n        x14 = rotl(x14 ^ x03, 16);\n        x09 = (x09 + x14) | 0;\n        x04 = rotl(x04 ^ x09, 12);\n        x03 = (x03 + x04) | 0;\n        x14 = rotl(x14 ^ x03, 8);\n        x09 = (x09 + x14) | 0;\n        x04 = rotl(x04 ^ x09, 7);\n    }\n    // Write output\n    let oi = 0;\n    out[oi++] = (y00 + x00) | 0;\n    out[oi++] = (y01 + x01) | 0;\n    out[oi++] = (y02 + x02) | 0;\n    out[oi++] = (y03 + x03) | 0;\n    out[oi++] = (y04 + x04) | 0;\n    out[oi++] = (y05 + x05) | 0;\n    out[oi++] = (y06 + x06) | 0;\n    out[oi++] = (y07 + x07) | 0;\n    out[oi++] = (y08 + x08) | 0;\n    out[oi++] = (y09 + x09) | 0;\n    out[oi++] = (y10 + x10) | 0;\n    out[oi++] = (y11 + x11) | 0;\n    out[oi++] = (y12 + x12) | 0;\n    out[oi++] = (y13 + x13) | 0;\n    out[oi++] = (y14 + x14) | 0;\n    out[oi++] = (y15 + x15) | 0;\n}\n/**\n * hchacha helper method, used primarily in xchacha, to hash\n * key and nonce into key' and nonce'.\n * Same as chachaCore, but there doesn't seem to be a way to move the block\n * out without 25% performance hit.\n */\n// prettier-ignore\nexport function hchacha(s, k, i, o32) {\n    let x00 = s[0], x01 = s[1], x02 = s[2], x03 = s[3], x04 = k[0], x05 = k[1], x06 = k[2], x07 = k[3], x08 = k[4], x09 = k[5], x10 = k[6], x11 = k[7], x12 = i[0], x13 = i[1], x14 = i[2], x15 = i[3];\n    for (let r = 0; r < 20; r += 2) {\n        x00 = (x00 + x04) | 0;\n        x12 = rotl(x12 ^ x00, 16);\n        x08 = (x08 + x12) | 0;\n        x04 = rotl(x04 ^ x08, 12);\n        x00 = (x00 + x04) | 0;\n        x12 = rotl(x12 ^ x00, 8);\n        x08 = (x08 + x12) | 0;\n        x04 = rotl(x04 ^ x08, 7);\n        x01 = (x01 + x05) | 0;\n        x13 = rotl(x13 ^ x01, 16);\n        x09 = (x09 + x13) | 0;\n        x05 = rotl(x05 ^ x09, 12);\n        x01 = (x01 + x05) | 0;\n        x13 = rotl(x13 ^ x01, 8);\n        x09 = (x09 + x13) | 0;\n        x05 = rotl(x05 ^ x09, 7);\n        x02 = (x02 + x06) | 0;\n        x14 = rotl(x14 ^ x02, 16);\n        x10 = (x10 + x14) | 0;\n        x06 = rotl(x06 ^ x10, 12);\n        x02 = (x02 + x06) | 0;\n        x14 = rotl(x14 ^ x02, 8);\n        x10 = (x10 + x14) | 0;\n        x06 = rotl(x06 ^ x10, 7);\n        x03 = (x03 + x07) | 0;\n        x15 = rotl(x15 ^ x03, 16);\n        x11 = (x11 + x15) | 0;\n        x07 = rotl(x07 ^ x11, 12);\n        x03 = (x03 + x07) | 0;\n        x15 = rotl(x15 ^ x03, 8);\n        x11 = (x11 + x15) | 0;\n        x07 = rotl(x07 ^ x11, 7);\n        x00 = (x00 + x05) | 0;\n        x15 = rotl(x15 ^ x00, 16);\n        x10 = (x10 + x15) | 0;\n        x05 = rotl(x05 ^ x10, 12);\n        x00 = (x00 + x05) | 0;\n        x15 = rotl(x15 ^ x00, 8);\n        x10 = (x10 + x15) | 0;\n        x05 = rotl(x05 ^ x10, 7);\n        x01 = (x01 + x06) | 0;\n        x12 = rotl(x12 ^ x01, 16);\n        x11 = (x11 + x12) | 0;\n        x06 = rotl(x06 ^ x11, 12);\n        x01 = (x01 + x06) | 0;\n        x12 = rotl(x12 ^ x01, 8);\n        x11 = (x11 + x12) | 0;\n        x06 = rotl(x06 ^ x11, 7);\n        x02 = (x02 + x07) | 0;\n        x13 = rotl(x13 ^ x02, 16);\n        x08 = (x08 + x13) | 0;\n        x07 = rotl(x07 ^ x08, 12);\n        x02 = (x02 + x07) | 0;\n        x13 = rotl(x13 ^ x02, 8);\n        x08 = (x08 + x13) | 0;\n        x07 = rotl(x07 ^ x08, 7);\n        x03 = (x03 + x04) | 0;\n        x14 = rotl(x14 ^ x03, 16);\n        x09 = (x09 + x14) | 0;\n        x04 = rotl(x04 ^ x09, 12);\n        x03 = (x03 + x04) | 0;\n        x14 = rotl(x14 ^ x03, 8);\n        x09 = (x09 + x14) | 0;\n        x04 = rotl(x04 ^ x09, 7);\n    }\n    let oi = 0;\n    o32[oi++] = x00;\n    o32[oi++] = x01;\n    o32[oi++] = x02;\n    o32[oi++] = x03;\n    o32[oi++] = x12;\n    o32[oi++] = x13;\n    o32[oi++] = x14;\n    o32[oi++] = x15;\n}\n/**\n * Original, non-RFC chacha20 from DJB. 8-byte nonce, 8-byte counter.\n */\nexport const chacha20orig = /* @__PURE__ */ createCipher(chachaCore, {\n    counterRight: false,\n    counterLength: 8,\n    allowShortKeys: true,\n});\n/**\n * ChaCha stream cipher. Conforms to RFC 8439 (IETF, TLS). 12-byte nonce, 4-byte counter.\n * With 12-byte nonce, it's not safe to use fill it with random (CSPRNG), due to collision chance.\n */\nexport const chacha20 = /* @__PURE__ */ createCipher(chachaCore, {\n    counterRight: false,\n    counterLength: 4,\n    allowShortKeys: false,\n});\n/**\n * XChaCha eXtended-nonce ChaCha. 24-byte nonce.\n * With 24-byte nonce, it's safe to use fill it with random (CSPRNG).\n * https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-xchacha\n */\nexport const xchacha20 = /* @__PURE__ */ createCipher(chachaCore, {\n    counterRight: false,\n    counterLength: 8,\n    extendNonceFn: hchacha,\n    allowShortKeys: false,\n});\n/**\n * Reduced 8-round chacha, described in original paper.\n */\nexport const chacha8 = /* @__PURE__ */ createCipher(chachaCore, {\n    counterRight: false,\n    counterLength: 4,\n    rounds: 8,\n});\n/**\n * Reduced 12-round chacha, described in original paper.\n */\nexport const chacha12 = /* @__PURE__ */ createCipher(chachaCore, {\n    counterRight: false,\n    counterLength: 4,\n    rounds: 12,\n});\nconst ZEROS16 = /* @__PURE__ */ new Uint8Array(16);\n// Pad to digest size with zeros\nconst updatePadded = (h, msg) => {\n    h.update(msg);\n    const left = msg.length % 16;\n    if (left)\n        h.update(ZEROS16.subarray(left));\n};\nconst ZEROS32 = /* @__PURE__ */ new Uint8Array(32);\nfunction computeTag(fn, key, nonce, data, AAD) {\n    const authKey = fn(key, nonce, ZEROS32);\n    const h = poly1305.create(authKey);\n    if (AAD)\n        updatePadded(h, AAD);\n    updatePadded(h, data);\n    const num = new Uint8Array(16);\n    const view = createView(num);\n    setBigUint64(view, 0, BigInt(AAD ? AAD.length : 0), true);\n    setBigUint64(view, 8, BigInt(data.length), true);\n    h.update(num);\n    const res = h.digest();\n    authKey.fill(0);\n    return res;\n}\n/**\n * AEAD algorithm from RFC 8439.\n * Salsa20 and chacha (RFC 8439) use poly1305 differently.\n * We could have composed them similar to:\n * https://github.com/paulmillr/scure-base/blob/b266c73dde977b1dd7ef40ef7a23cc15aab526b3/index.ts#L250\n * But it's hard because of authKey:\n * In salsa20, authKey changes position in salsa stream.\n * In chacha, authKey can't be computed inside computeTag, it modifies the counter.\n */\nexport const _poly1305_aead = (xorStream) => (key, nonce, AAD) => {\n    const tagLength = 16;\n    abytes(key, 32);\n    abytes(nonce);\n    return {\n        encrypt: (plaintext, output) => {\n            const plength = plaintext.length;\n            const clength = plength + tagLength;\n            if (output) {\n                abytes(output, clength);\n            }\n            else {\n                output = new Uint8Array(clength);\n            }\n            xorStream(key, nonce, plaintext, output, 1);\n            const tag = computeTag(xorStream, key, nonce, output.subarray(0, -tagLength), AAD);\n            output.set(tag, plength); // append tag\n            return output;\n        },\n        decrypt: (ciphertext, output) => {\n            const clength = ciphertext.length;\n            const plength = clength - tagLength;\n            if (clength < tagLength)\n                throw new Error(`encrypted data must be at least ${tagLength} bytes`);\n            if (output) {\n                abytes(output, plength);\n            }\n            else {\n                output = new Uint8Array(plength);\n            }\n            const data = ciphertext.subarray(0, -tagLength);\n            const passedTag = ciphertext.subarray(-tagLength);\n            const tag = computeTag(xorStream, key, nonce, data, AAD);\n            if (!equalBytes(passedTag, tag))\n                throw new Error('invalid tag');\n            xorStream(key, nonce, data, output, 1);\n            return output;\n        },\n    };\n};\n/**\n * ChaCha20-Poly1305 from RFC 8439.\n * With 12-byte nonce, it's not safe to use fill it with random (CSPRNG), due to collision chance.\n */\nexport const chacha20poly1305 = /* @__PURE__ */ wrapCipher({ blockSize: 64, nonceLength: 12, tagLength: 16 }, _poly1305_aead(chacha20));\n/**\n * XChaCha20-Poly1305 extended-nonce chacha.\n * https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-xchacha\n * With 24-byte nonce, it's safe to use fill it with random (CSPRNG).\n */\nexport const xchacha20poly1305 = /* @__PURE__ */ wrapCipher({ blockSize: 64, nonceLength: 24, tagLength: 16 }, _poly1305_aead(xchacha20));\n//# sourceMappingURL=chacha.js.map","import assert from './_assert.js';\nimport { Hash, toBytes } from './utils.js';\n// HMAC (RFC 2104)\nexport class HMAC extends Hash {\n    constructor(hash, _key) {\n        super();\n        this.finished = false;\n        this.destroyed = false;\n        assert.hash(hash);\n        const key = toBytes(_key);\n        this.iHash = hash.create();\n        if (typeof this.iHash.update !== 'function')\n            throw new Error('Expected instance of class which extends utils.Hash');\n        this.blockLen = this.iHash.blockLen;\n        this.outputLen = this.iHash.outputLen;\n        const blockLen = this.blockLen;\n        const pad = new Uint8Array(blockLen);\n        // blockLen can be bigger than outputLen\n        pad.set(key.length > blockLen ? hash.create().update(key).digest() : key);\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36;\n        this.iHash.update(pad);\n        // By doing update (processing of first block) of outer hash here we can re-use it between multiple calls via clone\n        this.oHash = hash.create();\n        // Undo internal XOR && apply outer XOR\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36 ^ 0x5c;\n        this.oHash.update(pad);\n        pad.fill(0);\n    }\n    update(buf) {\n        assert.exists(this);\n        this.iHash.update(buf);\n        return this;\n    }\n    digestInto(out) {\n        assert.exists(this);\n        assert.bytes(out, this.outputLen);\n        this.finished = true;\n        this.iHash.digestInto(out);\n        this.oHash.update(out);\n        this.oHash.digestInto(out);\n        this.destroy();\n    }\n    digest() {\n        const out = new Uint8Array(this.oHash.outputLen);\n        this.digestInto(out);\n        return out;\n    }\n    _cloneInto(to) {\n        // Create new instance without calling constructor since key already in state and we don't know it.\n        to || (to = Object.create(Object.getPrototypeOf(this), {}));\n        const { oHash, iHash, finished, destroyed, blockLen, outputLen } = this;\n        to = to;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        to.blockLen = blockLen;\n        to.outputLen = outputLen;\n        to.oHash = oHash._cloneInto(to.oHash);\n        to.iHash = iHash._cloneInto(to.iHash);\n        return to;\n    }\n    destroy() {\n        this.destroyed = true;\n        this.oHash.destroy();\n        this.iHash.destroy();\n    }\n}\n/**\n * HMAC: RFC2104 message authentication code.\n * @param hash - function that would be used e.g. sha256\n * @param key - message key\n * @param message - message data\n */\nexport const hmac = (hash, key, message) => new HMAC(hash, key).update(message).digest();\nhmac.create = (hash, key) => new HMAC(hash, key);\n//# sourceMappingURL=hmac.js.map","import assert from './_assert.js';\nimport { toBytes } from './utils.js';\nimport { hmac } from './hmac.js';\n// HKDF (RFC 5869)\n// https://soatok.blog/2021/11/17/understanding-hkdf/\n/**\n * HKDF-Extract(IKM, salt) -> PRK\n * Arguments position differs from spec (IKM is first one, since it is not optional)\n * @param hash\n * @param ikm\n * @param salt\n * @returns\n */\nexport function extract(hash, ikm, salt) {\n    assert.hash(hash);\n    // NOTE: some libraries treat zero-length array as 'not provided';\n    // we don't, since we have undefined as 'not provided'\n    // https://github.com/RustCrypto/KDFs/issues/15\n    if (salt === undefined)\n        salt = new Uint8Array(hash.outputLen); // if not provided, it is set to a string of HashLen zeros\n    return hmac(hash, toBytes(salt), toBytes(ikm));\n}\n// HKDF-Expand(PRK, info, L) -> OKM\nconst HKDF_COUNTER = new Uint8Array([0]);\nconst EMPTY_BUFFER = new Uint8Array();\n/**\n * HKDF-expand from the spec.\n * @param prk - a pseudorandom key of at least HashLen octets (usually, the output from the extract step)\n * @param info - optional context and application specific information (can be a zero-length string)\n * @param length - length of output keying material in octets\n */\nexport function expand(hash, prk, info, length = 32) {\n    assert.hash(hash);\n    assert.number(length);\n    if (length > 255 * hash.outputLen)\n        throw new Error('Length should be <= 255*HashLen');\n    const blocks = Math.ceil(length / hash.outputLen);\n    if (info === undefined)\n        info = EMPTY_BUFFER;\n    // first L(ength) octets of T\n    const okm = new Uint8Array(blocks * hash.outputLen);\n    // Re-use HMAC instance between blocks\n    const HMAC = hmac.create(hash, prk);\n    const HMACTmp = HMAC._cloneInto();\n    const T = new Uint8Array(HMAC.outputLen);\n    for (let counter = 0; counter < blocks; counter++) {\n        HKDF_COUNTER[0] = counter + 1;\n        // T(0) = empty string (zero length)\n        // T(N) = HMAC-Hash(PRK, T(N-1) | info | N)\n        HMACTmp.update(counter === 0 ? EMPTY_BUFFER : T)\n            .update(info)\n            .update(HKDF_COUNTER)\n            .digestInto(T);\n        okm.set(T, hash.outputLen * counter);\n        HMAC._cloneInto(HMACTmp);\n    }\n    HMAC.destroy();\n    HMACTmp.destroy();\n    T.fill(0);\n    HKDF_COUNTER.fill(0);\n    return okm.slice(0, length);\n}\n/**\n * HKDF (RFC 5869): extract + expand in one step.\n * @param hash - hash function that would be used (e.g. sha256)\n * @param ikm - input keying material, the initial key\n * @param salt - optional salt value (a non-secret random value)\n * @param info - optional context and application specific information\n * @param length - length of output keying material in octets\n */\nexport const hkdf = (hash, ikm, salt, info, length) => expand(hash, extract(hash, ikm, salt), info, length);\n//# sourceMappingURL=hkdf.js.map","var __defProp = Object.defineProperty;\nvar __export = (target, all) => {\n  for (var name in all)\n    __defProp(target, name, { get: all[name], enumerable: true });\n};\n\n// pure.ts\nimport { schnorr } from \"@noble/curves/secp256k1\";\nimport { bytesToHex as bytesToHex2 } from \"@noble/hashes/utils\";\n\n// core.ts\nvar verifiedSymbol = Symbol(\"verified\");\nvar isRecord = (obj) => obj instanceof Object;\nfunction validateEvent(event) {\n  if (!isRecord(event))\n    return false;\n  if (typeof event.kind !== \"number\")\n    return false;\n  if (typeof event.content !== \"string\")\n    return false;\n  if (typeof event.created_at !== \"number\")\n    return false;\n  if (typeof event.pubkey !== \"string\")\n    return false;\n  if (!event.pubkey.match(/^[a-f0-9]{64}$/))\n    return false;\n  if (!Array.isArray(event.tags))\n    return false;\n  for (let i2 = 0; i2 < event.tags.length; i2++) {\n    let tag = event.tags[i2];\n    if (!Array.isArray(tag))\n      return false;\n    for (let j = 0; j < tag.length; j++) {\n      if (typeof tag[j] !== \"string\")\n        return false;\n    }\n  }\n  return true;\n}\nfunction sortEvents(events) {\n  return events.sort((a, b) => {\n    if (a.created_at !== b.created_at) {\n      return b.created_at - a.created_at;\n    }\n    return a.id.localeCompare(b.id);\n  });\n}\n\n// pure.ts\nimport { sha256 } from \"@noble/hashes/sha256\";\n\n// utils.ts\nvar utils_exports = {};\n__export(utils_exports, {\n  Queue: () => Queue,\n  QueueNode: () => QueueNode,\n  binarySearch: () => binarySearch,\n  bytesToHex: () => bytesToHex,\n  hexToBytes: () => hexToBytes,\n  insertEventIntoAscendingList: () => insertEventIntoAscendingList,\n  insertEventIntoDescendingList: () => insertEventIntoDescendingList,\n  normalizeURL: () => normalizeURL,\n  utf8Decoder: () => utf8Decoder,\n  utf8Encoder: () => utf8Encoder\n});\nimport { bytesToHex, hexToBytes } from \"@noble/hashes/utils\";\nvar utf8Decoder = new TextDecoder(\"utf-8\");\nvar utf8Encoder = new TextEncoder();\nfunction normalizeURL(url) {\n  try {\n    if (url.indexOf(\"://\") === -1)\n      url = \"wss://\" + url;\n    let p = new URL(url);\n    if (p.protocol === \"http:\")\n      p.protocol = \"ws:\";\n    else if (p.protocol === \"https:\")\n      p.protocol = \"wss:\";\n    p.pathname = p.pathname.replace(/\\/+/g, \"/\");\n    if (p.pathname.endsWith(\"/\"))\n      p.pathname = p.pathname.slice(0, -1);\n    if (p.port === \"80\" && p.protocol === \"ws:\" || p.port === \"443\" && p.protocol === \"wss:\")\n      p.port = \"\";\n    p.searchParams.sort();\n    p.hash = \"\";\n    return p.toString();\n  } catch (e) {\n    throw new Error(`Invalid URL: ${url}`);\n  }\n}\nfunction insertEventIntoDescendingList(sortedArray, event) {\n  const [idx, found] = binarySearch(sortedArray, (b) => {\n    if (event.id === b.id)\n      return 0;\n    if (event.created_at === b.created_at)\n      return -1;\n    return b.created_at - event.created_at;\n  });\n  if (!found) {\n    sortedArray.splice(idx, 0, event);\n  }\n  return sortedArray;\n}\nfunction insertEventIntoAscendingList(sortedArray, event) {\n  const [idx, found] = binarySearch(sortedArray, (b) => {\n    if (event.id === b.id)\n      return 0;\n    if (event.created_at === b.created_at)\n      return -1;\n    return event.created_at - b.created_at;\n  });\n  if (!found) {\n    sortedArray.splice(idx, 0, event);\n  }\n  return sortedArray;\n}\nfunction binarySearch(arr, compare) {\n  let start = 0;\n  let end = arr.length - 1;\n  while (start <= end) {\n    const mid = Math.floor((start + end) / 2);\n    const cmp = compare(arr[mid]);\n    if (cmp === 0) {\n      return [mid, true];\n    }\n    if (cmp < 0) {\n      end = mid - 1;\n    } else {\n      start = mid + 1;\n    }\n  }\n  return [start, false];\n}\nvar QueueNode = class {\n  value;\n  next = null;\n  prev = null;\n  constructor(message) {\n    this.value = message;\n  }\n};\nvar Queue = class {\n  first;\n  last;\n  constructor() {\n    this.first = null;\n    this.last = null;\n  }\n  enqueue(value) {\n    const newNode = new QueueNode(value);\n    if (!this.last) {\n      this.first = newNode;\n      this.last = newNode;\n    } else if (this.last === this.first) {\n      this.last = newNode;\n      this.last.prev = this.first;\n      this.first.next = newNode;\n    } else {\n      newNode.prev = this.last;\n      this.last.next = newNode;\n      this.last = newNode;\n    }\n    return true;\n  }\n  dequeue() {\n    if (!this.first)\n      return null;\n    if (this.first === this.last) {\n      const target2 = this.first;\n      this.first = null;\n      this.last = null;\n      return target2.value;\n    }\n    const target = this.first;\n    this.first = target.next;\n    if (this.first) {\n      this.first.prev = null;\n    }\n    return target.value;\n  }\n};\n\n// pure.ts\nvar JS = class {\n  generateSecretKey() {\n    return schnorr.utils.randomPrivateKey();\n  }\n  getPublicKey(secretKey) {\n    return bytesToHex2(schnorr.getPublicKey(secretKey));\n  }\n  finalizeEvent(t, secretKey) {\n    const event = t;\n    event.pubkey = bytesToHex2(schnorr.getPublicKey(secretKey));\n    event.id = getEventHash(event);\n    event.sig = bytesToHex2(schnorr.sign(getEventHash(event), secretKey));\n    event[verifiedSymbol] = true;\n    return event;\n  }\n  verifyEvent(event) {\n    if (typeof event[verifiedSymbol] === \"boolean\")\n      return event[verifiedSymbol];\n    const hash = getEventHash(event);\n    if (hash !== event.id) {\n      event[verifiedSymbol] = false;\n      return false;\n    }\n    try {\n      const valid = schnorr.verify(event.sig, hash, event.pubkey);\n      event[verifiedSymbol] = valid;\n      return valid;\n    } catch (err) {\n      event[verifiedSymbol] = false;\n      return false;\n    }\n  }\n};\nfunction serializeEvent(evt) {\n  if (!validateEvent(evt))\n    throw new Error(\"can't serialize event with wrong or missing properties\");\n  return JSON.stringify([0, evt.pubkey, evt.created_at, evt.kind, evt.tags, evt.content]);\n}\nfunction getEventHash(event) {\n  let eventHash = sha256(utf8Encoder.encode(serializeEvent(event)));\n  return bytesToHex2(eventHash);\n}\nvar i = new JS();\nvar generateSecretKey = i.generateSecretKey;\nvar getPublicKey = i.getPublicKey;\nvar finalizeEvent = i.finalizeEvent;\nvar verifyEvent = i.verifyEvent;\n\n// kinds.ts\nvar kinds_exports = {};\n__export(kinds_exports, {\n  Application: () => Application,\n  BadgeAward: () => BadgeAward,\n  BadgeDefinition: () => BadgeDefinition,\n  BlockedRelaysList: () => BlockedRelaysList,\n  BlossomServerList: () => BlossomServerList,\n  BookmarkList: () => BookmarkList,\n  Bookmarksets: () => Bookmarksets,\n  Calendar: () => Calendar,\n  CalendarEventRSVP: () => CalendarEventRSVP,\n  ChannelCreation: () => ChannelCreation,\n  ChannelHideMessage: () => ChannelHideMessage,\n  ChannelMessage: () => ChannelMessage,\n  ChannelMetadata: () => ChannelMetadata,\n  ChannelMuteUser: () => ChannelMuteUser,\n  ChatMessage: () => ChatMessage,\n  ClassifiedListing: () => ClassifiedListing,\n  ClientAuth: () => ClientAuth,\n  Comment: () => Comment,\n  CommunitiesList: () => CommunitiesList,\n  CommunityDefinition: () => CommunityDefinition,\n  CommunityPostApproval: () => CommunityPostApproval,\n  Contacts: () => Contacts,\n  CreateOrUpdateProduct: () => CreateOrUpdateProduct,\n  CreateOrUpdateStall: () => CreateOrUpdateStall,\n  Curationsets: () => Curationsets,\n  Date: () => Date2,\n  DirectMessageRelaysList: () => DirectMessageRelaysList,\n  DraftClassifiedListing: () => DraftClassifiedListing,\n  DraftLong: () => DraftLong,\n  Emojisets: () => Emojisets,\n  EncryptedDirectMessage: () => EncryptedDirectMessage,\n  EventDeletion: () => EventDeletion,\n  FavoriteRelays: () => FavoriteRelays,\n  FileMessage: () => FileMessage,\n  FileMetadata: () => FileMetadata,\n  FileServerPreference: () => FileServerPreference,\n  Followsets: () => Followsets,\n  ForumThread: () => ForumThread,\n  GenericRepost: () => GenericRepost,\n  Genericlists: () => Genericlists,\n  GiftWrap: () => GiftWrap,\n  GroupMetadata: () => GroupMetadata,\n  HTTPAuth: () => HTTPAuth,\n  Handlerinformation: () => Handlerinformation,\n  Handlerrecommendation: () => Handlerrecommendation,\n  Highlights: () => Highlights,\n  InterestsList: () => InterestsList,\n  Interestsets: () => Interestsets,\n  JobFeedback: () => JobFeedback,\n  JobRequest: () => JobRequest,\n  JobResult: () => JobResult,\n  Label: () => Label,\n  LightningPubRPC: () => LightningPubRPC,\n  LiveChatMessage: () => LiveChatMessage,\n  LiveEvent: () => LiveEvent,\n  LongFormArticle: () => LongFormArticle,\n  Metadata: () => Metadata,\n  Mutelist: () => Mutelist,\n  NWCWalletInfo: () => NWCWalletInfo,\n  NWCWalletRequest: () => NWCWalletRequest,\n  NWCWalletResponse: () => NWCWalletResponse,\n  NormalVideo: () => NormalVideo,\n  NostrConnect: () => NostrConnect,\n  OpenTimestamps: () => OpenTimestamps,\n  Photo: () => Photo,\n  Pinlist: () => Pinlist,\n  Poll: () => Poll,\n  PollResponse: () => PollResponse,\n  PrivateDirectMessage: () => PrivateDirectMessage,\n  ProblemTracker: () => ProblemTracker,\n  ProfileBadges: () => ProfileBadges,\n  PublicChatsList: () => PublicChatsList,\n  Reaction: () => Reaction,\n  RecommendRelay: () => RecommendRelay,\n  RelayList: () => RelayList,\n  RelayReview: () => RelayReview,\n  Relaysets: () => Relaysets,\n  Report: () => Report,\n  Reporting: () => Reporting,\n  Repost: () => Repost,\n  Seal: () => Seal,\n  SearchRelaysList: () => SearchRelaysList,\n  ShortTextNote: () => ShortTextNote,\n  ShortVideo: () => ShortVideo,\n  Time: () => Time,\n  UserEmojiList: () => UserEmojiList,\n  UserStatuses: () => UserStatuses,\n  Voice: () => Voice,\n  VoiceComment: () => VoiceComment,\n  Zap: () => Zap,\n  ZapGoal: () => ZapGoal,\n  ZapRequest: () => ZapRequest,\n  classifyKind: () => classifyKind,\n  isAddressableKind: () => isAddressableKind,\n  isEphemeralKind: () => isEphemeralKind,\n  isKind: () => isKind,\n  isRegularKind: () => isRegularKind,\n  isReplaceableKind: () => isReplaceableKind\n});\nfunction isRegularKind(kind) {\n  return kind < 1e4 && kind !== 0 && kind !== 3;\n}\nfunction isReplaceableKind(kind) {\n  return kind === 0 || kind === 3 || 1e4 <= kind && kind < 2e4;\n}\nfunction isEphemeralKind(kind) {\n  return 2e4 <= kind && kind < 3e4;\n}\nfunction isAddressableKind(kind) {\n  return 3e4 <= kind && kind < 4e4;\n}\nfunction classifyKind(kind) {\n  if (isRegularKind(kind))\n    return \"regular\";\n  if (isReplaceableKind(kind))\n    return \"replaceable\";\n  if (isEphemeralKind(kind))\n    return \"ephemeral\";\n  if (isAddressableKind(kind))\n    return \"parameterized\";\n  return \"unknown\";\n}\nfunction isKind(event, kind) {\n  const kindAsArray = kind instanceof Array ? kind : [kind];\n  return validateEvent(event) && kindAsArray.includes(event.kind) || false;\n}\nvar Metadata = 0;\nvar ShortTextNote = 1;\nvar RecommendRelay = 2;\nvar Contacts = 3;\nvar EncryptedDirectMessage = 4;\nvar EventDeletion = 5;\nvar Repost = 6;\nvar Reaction = 7;\nvar BadgeAward = 8;\nvar ChatMessage = 9;\nvar ForumThread = 11;\nvar Seal = 13;\nvar PrivateDirectMessage = 14;\nvar FileMessage = 15;\nvar GenericRepost = 16;\nvar Photo = 20;\nvar NormalVideo = 21;\nvar ShortVideo = 22;\nvar ChannelCreation = 40;\nvar ChannelMetadata = 41;\nvar ChannelMessage = 42;\nvar ChannelHideMessage = 43;\nvar ChannelMuteUser = 44;\nvar OpenTimestamps = 1040;\nvar GiftWrap = 1059;\nvar Poll = 1068;\nvar FileMetadata = 1063;\nvar Comment = 1111;\nvar LiveChatMessage = 1311;\nvar Voice = 1222;\nvar VoiceComment = 1244;\nvar ProblemTracker = 1971;\nvar Report = 1984;\nvar Reporting = 1984;\nvar Label = 1985;\nvar CommunityPostApproval = 4550;\nvar JobRequest = 5999;\nvar JobResult = 6999;\nvar JobFeedback = 7e3;\nvar ZapGoal = 9041;\nvar ZapRequest = 9734;\nvar Zap = 9735;\nvar Highlights = 9802;\nvar PollResponse = 1018;\nvar Mutelist = 1e4;\nvar Pinlist = 10001;\nvar RelayList = 10002;\nvar BookmarkList = 10003;\nvar CommunitiesList = 10004;\nvar PublicChatsList = 10005;\nvar BlockedRelaysList = 10006;\nvar SearchRelaysList = 10007;\nvar FavoriteRelays = 10012;\nvar InterestsList = 10015;\nvar UserEmojiList = 10030;\nvar DirectMessageRelaysList = 10050;\nvar FileServerPreference = 10096;\nvar BlossomServerList = 10063;\nvar NWCWalletInfo = 13194;\nvar LightningPubRPC = 21e3;\nvar ClientAuth = 22242;\nvar NWCWalletRequest = 23194;\nvar NWCWalletResponse = 23195;\nvar NostrConnect = 24133;\nvar HTTPAuth = 27235;\nvar Followsets = 3e4;\nvar Genericlists = 30001;\nvar Relaysets = 30002;\nvar Bookmarksets = 30003;\nvar Curationsets = 30004;\nvar ProfileBadges = 30008;\nvar BadgeDefinition = 30009;\nvar Interestsets = 30015;\nvar CreateOrUpdateStall = 30017;\nvar CreateOrUpdateProduct = 30018;\nvar LongFormArticle = 30023;\nvar DraftLong = 30024;\nvar Emojisets = 30030;\nvar Application = 30078;\nvar LiveEvent = 30311;\nvar UserStatuses = 30315;\nvar ClassifiedListing = 30402;\nvar DraftClassifiedListing = 30403;\nvar Date2 = 31922;\nvar Time = 31923;\nvar Calendar = 31924;\nvar CalendarEventRSVP = 31925;\nvar RelayReview = 31987;\nvar Handlerrecommendation = 31989;\nvar Handlerinformation = 31990;\nvar CommunityDefinition = 34550;\nvar GroupMetadata = 39e3;\n\n// filter.ts\nfunction matchFilter(filter, event) {\n  if (filter.ids && filter.ids.indexOf(event.id) === -1) {\n    return false;\n  }\n  if (filter.kinds && filter.kinds.indexOf(event.kind) === -1) {\n    return false;\n  }\n  if (filter.authors && filter.authors.indexOf(event.pubkey) === -1) {\n    return false;\n  }\n  for (let f in filter) {\n    if (f[0] === \"#\") {\n      let tagName = f.slice(1);\n      let values = filter[`#${tagName}`];\n      if (values && !event.tags.find(([t, v]) => t === f.slice(1) && values.indexOf(v) !== -1))\n        return false;\n    }\n  }\n  if (filter.since && event.created_at < filter.since)\n    return false;\n  if (filter.until && event.created_at > filter.until)\n    return false;\n  return true;\n}\nfunction matchFilters(filters, event) {\n  for (let i2 = 0; i2 < filters.length; i2++) {\n    if (matchFilter(filters[i2], event)) {\n      return true;\n    }\n  }\n  return false;\n}\nfunction mergeFilters(...filters) {\n  let result = {};\n  for (let i2 = 0; i2 < filters.length; i2++) {\n    let filter = filters[i2];\n    Object.entries(filter).forEach(([property, values]) => {\n      if (property === \"kinds\" || property === \"ids\" || property === \"authors\" || property[0] === \"#\") {\n        result[property] = result[property] || [];\n        for (let v = 0; v < values.length; v++) {\n          let value = values[v];\n          if (!result[property].includes(value))\n            result[property].push(value);\n        }\n      }\n    });\n    if (filter.limit && (!result.limit || filter.limit > result.limit))\n      result.limit = filter.limit;\n    if (filter.until && (!result.until || filter.until > result.until))\n      result.until = filter.until;\n    if (filter.since && (!result.since || filter.since < result.since))\n      result.since = filter.since;\n  }\n  return result;\n}\nfunction getFilterLimit(filter) {\n  if (filter.ids && !filter.ids.length)\n    return 0;\n  if (filter.kinds && !filter.kinds.length)\n    return 0;\n  if (filter.authors && !filter.authors.length)\n    return 0;\n  for (const [key, value] of Object.entries(filter)) {\n    if (key[0] === \"#\" && Array.isArray(value) && !value.length)\n      return 0;\n  }\n  return Math.min(\n    Math.max(0, filter.limit ?? Infinity),\n    filter.ids?.length ?? Infinity,\n    filter.authors?.length && filter.kinds?.every((kind) => isReplaceableKind(kind)) ? filter.authors.length * filter.kinds.length : Infinity,\n    filter.authors?.length && filter.kinds?.every((kind) => isAddressableKind(kind)) && filter[\"#d\"]?.length ? filter.authors.length * filter.kinds.length * filter[\"#d\"].length : Infinity\n  );\n}\n\n// fakejson.ts\nvar fakejson_exports = {};\n__export(fakejson_exports, {\n  getHex64: () => getHex64,\n  getInt: () => getInt,\n  getSubscriptionId: () => getSubscriptionId,\n  matchEventId: () => matchEventId,\n  matchEventKind: () => matchEventKind,\n  matchEventPubkey: () => matchEventPubkey\n});\nfunction getHex64(json, field) {\n  let len = field.length + 3;\n  let idx = json.indexOf(`\"${field}\":`) + len;\n  let s = json.slice(idx).indexOf(`\"`) + idx + 1;\n  return json.slice(s, s + 64);\n}\nfunction getInt(json, field) {\n  let len = field.length;\n  let idx = json.indexOf(`\"${field}\":`) + len + 3;\n  let sliced = json.slice(idx);\n  let end = Math.min(sliced.indexOf(\",\"), sliced.indexOf(\"}\"));\n  return parseInt(sliced.slice(0, end), 10);\n}\nfunction getSubscriptionId(json) {\n  let idx = json.slice(0, 22).indexOf(`\"EVENT\"`);\n  if (idx === -1)\n    return null;\n  let pstart = json.slice(idx + 7 + 1).indexOf(`\"`);\n  if (pstart === -1)\n    return null;\n  let start = idx + 7 + 1 + pstart;\n  let pend = json.slice(start + 1, 80).indexOf(`\"`);\n  if (pend === -1)\n    return null;\n  let end = start + 1 + pend;\n  return json.slice(start + 1, end);\n}\nfunction matchEventId(json, id) {\n  return id === getHex64(json, \"id\");\n}\nfunction matchEventPubkey(json, pubkey) {\n  return pubkey === getHex64(json, \"pubkey\");\n}\nfunction matchEventKind(json, kind) {\n  return kind === getInt(json, \"kind\");\n}\n\n// nip42.ts\nvar nip42_exports = {};\n__export(nip42_exports, {\n  makeAuthEvent: () => makeAuthEvent\n});\nfunction makeAuthEvent(relayURL, challenge) {\n  return {\n    kind: ClientAuth,\n    created_at: Math.floor(Date.now() / 1e3),\n    tags: [\n      [\"relay\", relayURL],\n      [\"challenge\", challenge]\n    ],\n    content: \"\"\n  };\n}\n\n// helpers.ts\nasync function yieldThread() {\n  return new Promise((resolve, reject) => {\n    try {\n      if (typeof MessageChannel !== \"undefined\") {\n        const ch = new MessageChannel();\n        const handler = () => {\n          ch.port1.removeEventListener(\"message\", handler);\n          resolve();\n        };\n        ch.port1.addEventListener(\"message\", handler);\n        ch.port2.postMessage(0);\n        ch.port1.start();\n      } else {\n        if (typeof setImmediate !== \"undefined\") {\n          setImmediate(resolve);\n        } else if (typeof setTimeout !== \"undefined\") {\n          setTimeout(resolve, 0);\n        } else {\n          resolve();\n        }\n      }\n    } catch (e) {\n      console.error(\"during yield: \", e);\n      reject(e);\n    }\n  });\n}\nvar alwaysTrue = (t) => {\n  t[verifiedSymbol] = true;\n  return true;\n};\n\n// abstract-relay.ts\nvar SendingOnClosedConnection = class extends Error {\n  constructor(message, relay) {\n    super(`Tried to send message '${message} on a closed connection to ${relay}.`);\n    this.name = \"SendingOnClosedConnection\";\n  }\n};\nvar AbstractRelay = class {\n  url;\n  _connected = false;\n  onclose = null;\n  onnotice = (msg) => console.debug(`NOTICE from ${this.url}: ${msg}`);\n  onauth;\n  baseEoseTimeout = 4400;\n  connectionTimeout = 4400;\n  publishTimeout = 4400;\n  pingFrequency = 29e3;\n  pingTimeout = 2e4;\n  resubscribeBackoff = [1e4, 1e4, 1e4, 2e4, 2e4, 3e4, 6e4];\n  openSubs = /* @__PURE__ */ new Map();\n  enablePing;\n  enableReconnect;\n  connectionTimeoutHandle;\n  reconnectTimeoutHandle;\n  pingIntervalHandle;\n  reconnectAttempts = 0;\n  closedIntentionally = false;\n  connectionPromise;\n  openCountRequests = /* @__PURE__ */ new Map();\n  openEventPublishes = /* @__PURE__ */ new Map();\n  ws;\n  incomingMessageQueue = new Queue();\n  queueRunning = false;\n  challenge;\n  authPromise;\n  serial = 0;\n  verifyEvent;\n  _WebSocket;\n  constructor(url, opts) {\n    this.url = normalizeURL(url);\n    this.verifyEvent = opts.verifyEvent;\n    this._WebSocket = opts.websocketImplementation || WebSocket;\n    this.enablePing = opts.enablePing;\n    this.enableReconnect = opts.enableReconnect || false;\n  }\n  static async connect(url, opts) {\n    const relay = new AbstractRelay(url, opts);\n    await relay.connect();\n    return relay;\n  }\n  closeAllSubscriptions(reason) {\n    for (let [_, sub] of this.openSubs) {\n      sub.close(reason);\n    }\n    this.openSubs.clear();\n    for (let [_, ep] of this.openEventPublishes) {\n      ep.reject(new Error(reason));\n    }\n    this.openEventPublishes.clear();\n    for (let [_, cr] of this.openCountRequests) {\n      cr.reject(new Error(reason));\n    }\n    this.openCountRequests.clear();\n  }\n  get connected() {\n    return this._connected;\n  }\n  async reconnect() {\n    const backoff = this.resubscribeBackoff[Math.min(this.reconnectAttempts, this.resubscribeBackoff.length - 1)];\n    this.reconnectAttempts++;\n    this.reconnectTimeoutHandle = setTimeout(async () => {\n      try {\n        await this.connect();\n      } catch (err) {\n      }\n    }, backoff);\n  }\n  handleHardClose(reason) {\n    if (this.pingIntervalHandle) {\n      clearInterval(this.pingIntervalHandle);\n      this.pingIntervalHandle = void 0;\n    }\n    this._connected = false;\n    this.connectionPromise = void 0;\n    const wasIntentional = this.closedIntentionally;\n    this.closedIntentionally = false;\n    this.onclose?.();\n    if (this.enableReconnect && !wasIntentional) {\n      this.reconnect();\n    } else {\n      this.closeAllSubscriptions(reason);\n    }\n  }\n  async connect() {\n    if (this.connectionPromise)\n      return this.connectionPromise;\n    this.challenge = void 0;\n    this.authPromise = void 0;\n    this.connectionPromise = new Promise((resolve, reject) => {\n      this.connectionTimeoutHandle = setTimeout(() => {\n        reject(\"connection timed out\");\n        this.connectionPromise = void 0;\n        this.onclose?.();\n        this.closeAllSubscriptions(\"relay connection timed out\");\n      }, this.connectionTimeout);\n      try {\n        this.ws = new this._WebSocket(this.url);\n      } catch (err) {\n        clearTimeout(this.connectionTimeoutHandle);\n        reject(err);\n        return;\n      }\n      this.ws.onopen = () => {\n        if (this.reconnectTimeoutHandle) {\n          clearTimeout(this.reconnectTimeoutHandle);\n          this.reconnectTimeoutHandle = void 0;\n        }\n        clearTimeout(this.connectionTimeoutHandle);\n        this._connected = true;\n        const isReconnection = this.reconnectAttempts > 0;\n        this.reconnectAttempts = 0;\n        for (const sub of this.openSubs.values()) {\n          sub.eosed = false;\n          if (isReconnection) {\n            for (let f = 0; f < sub.filters.length; f++) {\n              if (sub.lastEmitted) {\n                sub.filters[f].since = sub.lastEmitted + 1;\n              }\n            }\n          }\n          sub.fire();\n        }\n        if (this.enablePing) {\n          this.pingIntervalHandle = setInterval(() => this.pingpong(), this.pingFrequency);\n        }\n        resolve();\n      };\n      this.ws.onerror = (ev) => {\n        clearTimeout(this.connectionTimeoutHandle);\n        reject(ev.message || \"websocket error\");\n        this.handleHardClose(\"relay connection errored\");\n      };\n      this.ws.onclose = (ev) => {\n        clearTimeout(this.connectionTimeoutHandle);\n        reject(ev.message || \"websocket closed\");\n        this.handleHardClose(\"relay connection closed\");\n      };\n      this.ws.onmessage = this._onmessage.bind(this);\n    });\n    return this.connectionPromise;\n  }\n  waitForPingPong() {\n    return new Promise((resolve) => {\n      ;\n      this.ws.once(\"pong\", () => resolve(true));\n      this.ws.ping();\n    });\n  }\n  waitForDummyReq() {\n    return new Promise((resolve, reject) => {\n      if (!this.connectionPromise)\n        return reject(new Error(`no connection to ${this.url}, can't ping`));\n      try {\n        const sub = this.subscribe(\n          [{ ids: [\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"], limit: 0 }],\n          {\n            oneose: () => {\n              resolve(true);\n              sub.close();\n            },\n            onclose() {\n              resolve(true);\n            },\n            eoseTimeout: this.pingTimeout + 1e3\n          }\n        );\n      } catch (err) {\n        reject(err);\n      }\n    });\n  }\n  async pingpong() {\n    if (this.ws?.readyState === 1) {\n      const result = await Promise.any([\n        this.ws && this.ws.ping && this.ws.once ? this.waitForPingPong() : this.waitForDummyReq(),\n        new Promise((res) => setTimeout(() => res(false), this.pingTimeout))\n      ]);\n      if (!result) {\n        if (this.ws?.readyState === this._WebSocket.OPEN) {\n          this.ws?.close();\n        }\n      }\n    }\n  }\n  async runQueue() {\n    this.queueRunning = true;\n    while (true) {\n      if (false === this.handleNext()) {\n        break;\n      }\n      await yieldThread();\n    }\n    this.queueRunning = false;\n  }\n  handleNext() {\n    const json = this.incomingMessageQueue.dequeue();\n    if (!json) {\n      return false;\n    }\n    const subid = getSubscriptionId(json);\n    if (subid) {\n      const so = this.openSubs.get(subid);\n      if (!so) {\n        return;\n      }\n      const id = getHex64(json, \"id\");\n      const alreadyHave = so.alreadyHaveEvent?.(id);\n      so.receivedEvent?.(this, id);\n      if (alreadyHave) {\n        return;\n      }\n    }\n    try {\n      let data = JSON.parse(json);\n      switch (data[0]) {\n        case \"EVENT\": {\n          const so = this.openSubs.get(data[1]);\n          const event = data[2];\n          if (this.verifyEvent(event) && matchFilters(so.filters, event)) {\n            so.onevent(event);\n          }\n          if (!so.lastEmitted || so.lastEmitted < event.created_at)\n            so.lastEmitted = event.created_at;\n          return;\n        }\n        case \"COUNT\": {\n          const id = data[1];\n          const payload = data[2];\n          const cr = this.openCountRequests.get(id);\n          if (cr) {\n            cr.resolve(payload.count);\n            this.openCountRequests.delete(id);\n          }\n          return;\n        }\n        case \"EOSE\": {\n          const so = this.openSubs.get(data[1]);\n          if (!so)\n            return;\n          so.receivedEose();\n          return;\n        }\n        case \"OK\": {\n          const id = data[1];\n          const ok = data[2];\n          const reason = data[3];\n          const ep = this.openEventPublishes.get(id);\n          if (ep) {\n            clearTimeout(ep.timeout);\n            if (ok)\n              ep.resolve(reason);\n            else\n              ep.reject(new Error(reason));\n            this.openEventPublishes.delete(id);\n          }\n          return;\n        }\n        case \"CLOSED\": {\n          const id = data[1];\n          const so = this.openSubs.get(id);\n          if (!so)\n            return;\n          so.closed = true;\n          so.close(data[2]);\n          return;\n        }\n        case \"NOTICE\": {\n          this.onnotice(data[1]);\n          return;\n        }\n        case \"AUTH\": {\n          this.challenge = data[1];\n          if (this.onauth) {\n            this.auth(this.onauth);\n          }\n          return;\n        }\n        default: {\n          const so = this.openSubs.get(data[1]);\n          so?.oncustom?.(data);\n          return;\n        }\n      }\n    } catch (err) {\n      return;\n    }\n  }\n  async send(message) {\n    if (!this.connectionPromise)\n      throw new SendingOnClosedConnection(message, this.url);\n    this.connectionPromise.then(() => {\n      this.ws?.send(message);\n    });\n  }\n  async auth(signAuthEvent) {\n    const challenge = this.challenge;\n    if (!challenge)\n      throw new Error(\"can't perform auth, no challenge was received\");\n    if (this.authPromise)\n      return this.authPromise;\n    this.authPromise = new Promise(async (resolve, reject) => {\n      try {\n        let evt = await signAuthEvent(makeAuthEvent(this.url, challenge));\n        let timeout = setTimeout(() => {\n          let ep = this.openEventPublishes.get(evt.id);\n          if (ep) {\n            ep.reject(new Error(\"auth timed out\"));\n            this.openEventPublishes.delete(evt.id);\n          }\n        }, this.publishTimeout);\n        this.openEventPublishes.set(evt.id, { resolve, reject, timeout });\n        this.send('[\"AUTH\",' + JSON.stringify(evt) + \"]\");\n      } catch (err) {\n        console.warn(\"subscribe auth function failed:\", err);\n      }\n    });\n    return this.authPromise;\n  }\n  async publish(event) {\n    const ret = new Promise((resolve, reject) => {\n      const timeout = setTimeout(() => {\n        const ep = this.openEventPublishes.get(event.id);\n        if (ep) {\n          ep.reject(new Error(\"publish timed out\"));\n          this.openEventPublishes.delete(event.id);\n        }\n      }, this.publishTimeout);\n      this.openEventPublishes.set(event.id, { resolve, reject, timeout });\n    });\n    this.send('[\"EVENT\",' + JSON.stringify(event) + \"]\");\n    return ret;\n  }\n  async count(filters, params) {\n    this.serial++;\n    const id = params?.id || \"count:\" + this.serial;\n    const ret = new Promise((resolve, reject) => {\n      this.openCountRequests.set(id, { resolve, reject });\n    });\n    this.send('[\"COUNT\",\"' + id + '\",' + JSON.stringify(filters).substring(1));\n    return ret;\n  }\n  subscribe(filters, params) {\n    const sub = this.prepareSubscription(filters, params);\n    sub.fire();\n    return sub;\n  }\n  prepareSubscription(filters, params) {\n    this.serial++;\n    const id = params.id || (params.label ? params.label + \":\" : \"sub:\") + this.serial;\n    const subscription = new Subscription(this, id, filters, params);\n    this.openSubs.set(id, subscription);\n    return subscription;\n  }\n  close() {\n    this.closedIntentionally = true;\n    if (this.reconnectTimeoutHandle) {\n      clearTimeout(this.reconnectTimeoutHandle);\n      this.reconnectTimeoutHandle = void 0;\n    }\n    if (this.pingIntervalHandle) {\n      clearInterval(this.pingIntervalHandle);\n      this.pingIntervalHandle = void 0;\n    }\n    this.closeAllSubscriptions(\"relay connection closed by us\");\n    this._connected = false;\n    this.onclose?.();\n    if (this.ws?.readyState === this._WebSocket.OPEN) {\n      this.ws?.close();\n    }\n  }\n  _onmessage(ev) {\n    this.incomingMessageQueue.enqueue(ev.data);\n    if (!this.queueRunning) {\n      this.runQueue();\n    }\n  }\n};\nvar Subscription = class {\n  relay;\n  id;\n  lastEmitted;\n  closed = false;\n  eosed = false;\n  filters;\n  alreadyHaveEvent;\n  receivedEvent;\n  onevent;\n  oneose;\n  onclose;\n  oncustom;\n  eoseTimeout;\n  eoseTimeoutHandle;\n  constructor(relay, id, filters, params) {\n    if (filters.length === 0)\n      throw new Error(\"subscription can't be created with zero filters\");\n    this.relay = relay;\n    this.filters = filters;\n    this.id = id;\n    this.alreadyHaveEvent = params.alreadyHaveEvent;\n    this.receivedEvent = params.receivedEvent;\n    this.eoseTimeout = params.eoseTimeout || relay.baseEoseTimeout;\n    this.oneose = params.oneose;\n    this.onclose = params.onclose;\n    this.onevent = params.onevent || ((event) => {\n      console.warn(\n        `onevent() callback not defined for subscription '${this.id}' in relay ${this.relay.url}. event received:`,\n        event\n      );\n    });\n  }\n  fire() {\n    this.relay.send('[\"REQ\",\"' + this.id + '\",' + JSON.stringify(this.filters).substring(1));\n    this.eoseTimeoutHandle = setTimeout(this.receivedEose.bind(this), this.eoseTimeout);\n  }\n  receivedEose() {\n    if (this.eosed)\n      return;\n    clearTimeout(this.eoseTimeoutHandle);\n    this.eosed = true;\n    this.oneose?.();\n  }\n  close(reason = \"closed by caller\") {\n    if (!this.closed && this.relay.connected) {\n      try {\n        this.relay.send('[\"CLOSE\",' + JSON.stringify(this.id) + \"]\");\n      } catch (err) {\n        if (err instanceof SendingOnClosedConnection) {\n        } else {\n          throw err;\n        }\n      }\n      this.closed = true;\n    }\n    this.relay.openSubs.delete(this.id);\n    this.onclose?.(reason);\n  }\n};\n\n// relay.ts\nvar _WebSocket;\ntry {\n  _WebSocket = WebSocket;\n} catch {\n}\nvar Relay = class extends AbstractRelay {\n  constructor(url, options) {\n    super(url, { verifyEvent, websocketImplementation: _WebSocket, ...options });\n  }\n  static async connect(url, options) {\n    const relay = new Relay(url, options);\n    await relay.connect();\n    return relay;\n  }\n};\n\n// abstract-pool.ts\nvar AbstractSimplePool = class {\n  relays = /* @__PURE__ */ new Map();\n  seenOn = /* @__PURE__ */ new Map();\n  trackRelays = false;\n  verifyEvent;\n  enablePing;\n  enableReconnect;\n  automaticallyAuth;\n  trustedRelayURLs = /* @__PURE__ */ new Set();\n  _WebSocket;\n  constructor(opts) {\n    this.verifyEvent = opts.verifyEvent;\n    this._WebSocket = opts.websocketImplementation;\n    this.enablePing = opts.enablePing;\n    this.enableReconnect = opts.enableReconnect || false;\n    this.automaticallyAuth = opts.automaticallyAuth;\n  }\n  async ensureRelay(url, params) {\n    url = normalizeURL(url);\n    let relay = this.relays.get(url);\n    if (!relay) {\n      relay = new AbstractRelay(url, {\n        verifyEvent: this.trustedRelayURLs.has(url) ? alwaysTrue : this.verifyEvent,\n        websocketImplementation: this._WebSocket,\n        enablePing: this.enablePing,\n        enableReconnect: this.enableReconnect\n      });\n      relay.onclose = () => {\n        if (relay && !relay.enableReconnect) {\n          this.relays.delete(url);\n        }\n      };\n      if (params?.connectionTimeout)\n        relay.connectionTimeout = params.connectionTimeout;\n      this.relays.set(url, relay);\n    }\n    if (this.automaticallyAuth) {\n      const authSignerFn = this.automaticallyAuth(url);\n      if (authSignerFn) {\n        relay.onauth = authSignerFn;\n      }\n    }\n    await relay.connect();\n    return relay;\n  }\n  close(relays) {\n    relays.map(normalizeURL).forEach((url) => {\n      this.relays.get(url)?.close();\n      this.relays.delete(url);\n    });\n  }\n  subscribe(relays, filter, params) {\n    const request = [];\n    for (let i2 = 0; i2 < relays.length; i2++) {\n      const url = normalizeURL(relays[i2]);\n      if (!request.find((r) => r.url === url)) {\n        request.push({ url, filter });\n      }\n    }\n    return this.subscribeMap(request, params);\n  }\n  subscribeMany(relays, filter, params) {\n    const request = [];\n    const uniqUrls = [];\n    for (let i2 = 0; i2 < relays.length; i2++) {\n      const url = normalizeURL(relays[i2]);\n      if (uniqUrls.indexOf(url) === -1) {\n        uniqUrls.push(url);\n        request.push({ url, filter });\n      }\n    }\n    return this.subscribeMap(request, params);\n  }\n  subscribeMap(requests, params) {\n    const grouped = /* @__PURE__ */ new Map();\n    for (const req of requests) {\n      const { url, filter } = req;\n      if (!grouped.has(url))\n        grouped.set(url, []);\n      grouped.get(url).push(filter);\n    }\n    const groupedRequests = Array.from(grouped.entries()).map(([url, filters]) => ({ url, filters }));\n    if (this.trackRelays) {\n      params.receivedEvent = (relay, id) => {\n        let set = this.seenOn.get(id);\n        if (!set) {\n          set = /* @__PURE__ */ new Set();\n          this.seenOn.set(id, set);\n        }\n        set.add(relay);\n      };\n    }\n    const _knownIds = /* @__PURE__ */ new Set();\n    const subs = [];\n    const eosesReceived = [];\n    let handleEose = (i2) => {\n      if (eosesReceived[i2])\n        return;\n      eosesReceived[i2] = true;\n      if (eosesReceived.filter((a) => a).length === groupedRequests.length) {\n        params.oneose?.();\n        handleEose = () => {\n        };\n      }\n    };\n    const closesReceived = [];\n    let handleClose = (i2, reason) => {\n      if (closesReceived[i2])\n        return;\n      handleEose(i2);\n      closesReceived[i2] = reason;\n      if (closesReceived.filter((a) => a).length === groupedRequests.length) {\n        params.onclose?.(closesReceived);\n        handleClose = () => {\n        };\n      }\n    };\n    const localAlreadyHaveEventHandler = (id) => {\n      if (params.alreadyHaveEvent?.(id)) {\n        return true;\n      }\n      const have = _knownIds.has(id);\n      _knownIds.add(id);\n      return have;\n    };\n    const allOpened = Promise.all(\n      groupedRequests.map(async ({ url, filters }, i2) => {\n        let relay;\n        try {\n          relay = await this.ensureRelay(url, {\n            connectionTimeout: params.maxWait ? Math.max(params.maxWait * 0.8, params.maxWait - 1e3) : void 0\n          });\n        } catch (err) {\n          handleClose(i2, err?.message || String(err));\n          return;\n        }\n        let subscription = relay.subscribe(filters, {\n          ...params,\n          oneose: () => handleEose(i2),\n          onclose: (reason) => {\n            if (reason.startsWith(\"auth-required: \") && params.onauth) {\n              relay.auth(params.onauth).then(() => {\n                relay.subscribe(filters, {\n                  ...params,\n                  oneose: () => handleEose(i2),\n                  onclose: (reason2) => {\n                    handleClose(i2, reason2);\n                  },\n                  alreadyHaveEvent: localAlreadyHaveEventHandler,\n                  eoseTimeout: params.maxWait\n                });\n              }).catch((err) => {\n                handleClose(i2, `auth was required and attempted, but failed with: ${err}`);\n              });\n            } else {\n              handleClose(i2, reason);\n            }\n          },\n          alreadyHaveEvent: localAlreadyHaveEventHandler,\n          eoseTimeout: params.maxWait\n        });\n        subs.push(subscription);\n      })\n    );\n    return {\n      async close(reason) {\n        await allOpened;\n        subs.forEach((sub) => {\n          sub.close(reason);\n        });\n      }\n    };\n  }\n  subscribeEose(relays, filter, params) {\n    const subcloser = this.subscribe(relays, filter, {\n      ...params,\n      oneose() {\n        subcloser.close(\"closed automatically on eose\");\n      }\n    });\n    return subcloser;\n  }\n  subscribeManyEose(relays, filter, params) {\n    const subcloser = this.subscribeMany(relays, filter, {\n      ...params,\n      oneose() {\n        subcloser.close(\"closed automatically on eose\");\n      }\n    });\n    return subcloser;\n  }\n  async querySync(relays, filter, params) {\n    return new Promise(async (resolve) => {\n      const events = [];\n      this.subscribeEose(relays, filter, {\n        ...params,\n        onevent(event) {\n          events.push(event);\n        },\n        onclose(_) {\n          resolve(events);\n        }\n      });\n    });\n  }\n  async get(relays, filter, params) {\n    filter.limit = 1;\n    const events = await this.querySync(relays, filter, params);\n    events.sort((a, b) => b.created_at - a.created_at);\n    return events[0] || null;\n  }\n  publish(relays, event, options) {\n    return relays.map(normalizeURL).map(async (url, i2, arr) => {\n      if (arr.indexOf(url) !== i2) {\n        return Promise.reject(\"duplicate url\");\n      }\n      let r = await this.ensureRelay(url);\n      return r.publish(event).catch(async (err) => {\n        if (err instanceof Error && err.message.startsWith(\"auth-required: \") && options?.onauth) {\n          await r.auth(options.onauth);\n          return r.publish(event);\n        }\n        throw err;\n      }).then((reason) => {\n        if (this.trackRelays) {\n          let set = this.seenOn.get(event.id);\n          if (!set) {\n            set = /* @__PURE__ */ new Set();\n            this.seenOn.set(event.id, set);\n          }\n          set.add(r);\n        }\n        return reason;\n      });\n    });\n  }\n  listConnectionStatus() {\n    const map = /* @__PURE__ */ new Map();\n    this.relays.forEach((relay, url) => map.set(url, relay.connected));\n    return map;\n  }\n  destroy() {\n    this.relays.forEach((conn) => conn.close());\n    this.relays = /* @__PURE__ */ new Map();\n  }\n};\n\n// pool.ts\nvar _WebSocket2;\ntry {\n  _WebSocket2 = WebSocket;\n} catch {\n}\nvar SimplePool = class extends AbstractSimplePool {\n  constructor(options) {\n    super({ verifyEvent, websocketImplementation: _WebSocket2, ...options });\n  }\n};\n\n// nip19.ts\nvar nip19_exports = {};\n__export(nip19_exports, {\n  BECH32_REGEX: () => BECH32_REGEX,\n  Bech32MaxSize: () => Bech32MaxSize,\n  NostrTypeGuard: () => NostrTypeGuard,\n  decode: () => decode,\n  decodeNostrURI: () => decodeNostrURI,\n  encodeBytes: () => encodeBytes,\n  naddrEncode: () => naddrEncode,\n  neventEncode: () => neventEncode,\n  noteEncode: () => noteEncode,\n  nprofileEncode: () => nprofileEncode,\n  npubEncode: () => npubEncode,\n  nsecEncode: () => nsecEncode\n});\nimport { bytesToHex as bytesToHex3, concatBytes, hexToBytes as hexToBytes2 } from \"@noble/hashes/utils\";\nimport { bech32 } from \"@scure/base\";\nvar NostrTypeGuard = {\n  isNProfile: (value) => /^nprofile1[a-z\\d]+$/.test(value || \"\"),\n  isNEvent: (value) => /^nevent1[a-z\\d]+$/.test(value || \"\"),\n  isNAddr: (value) => /^naddr1[a-z\\d]+$/.test(value || \"\"),\n  isNSec: (value) => /^nsec1[a-z\\d]{58}$/.test(value || \"\"),\n  isNPub: (value) => /^npub1[a-z\\d]{58}$/.test(value || \"\"),\n  isNote: (value) => /^note1[a-z\\d]+$/.test(value || \"\"),\n  isNcryptsec: (value) => /^ncryptsec1[a-z\\d]+$/.test(value || \"\")\n};\nvar Bech32MaxSize = 5e3;\nvar BECH32_REGEX = /[\\x21-\\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;\nfunction integerToUint8Array(number) {\n  const uint8Array = new Uint8Array(4);\n  uint8Array[0] = number >> 24 & 255;\n  uint8Array[1] = number >> 16 & 255;\n  uint8Array[2] = number >> 8 & 255;\n  uint8Array[3] = number & 255;\n  return uint8Array;\n}\nfunction decodeNostrURI(nip19code) {\n  try {\n    if (nip19code.startsWith(\"nostr:\"))\n      nip19code = nip19code.substring(6);\n    return decode(nip19code);\n  } catch (_err) {\n    return { type: \"invalid\", data: null };\n  }\n}\nfunction decode(code) {\n  let { prefix, words } = bech32.decode(code, Bech32MaxSize);\n  let data = new Uint8Array(bech32.fromWords(words));\n  switch (prefix) {\n    case \"nprofile\": {\n      let tlv = parseTLV(data);\n      if (!tlv[0]?.[0])\n        throw new Error(\"missing TLV 0 for nprofile\");\n      if (tlv[0][0].length !== 32)\n        throw new Error(\"TLV 0 should be 32 bytes\");\n      return {\n        type: \"nprofile\",\n        data: {\n          pubkey: bytesToHex3(tlv[0][0]),\n          relays: tlv[1] ? tlv[1].map((d) => utf8Decoder.decode(d)) : []\n        }\n      };\n    }\n    case \"nevent\": {\n      let tlv = parseTLV(data);\n      if (!tlv[0]?.[0])\n        throw new Error(\"missing TLV 0 for nevent\");\n      if (tlv[0][0].length !== 32)\n        throw new Error(\"TLV 0 should be 32 bytes\");\n      if (tlv[2] && tlv[2][0].length !== 32)\n        throw new Error(\"TLV 2 should be 32 bytes\");\n      if (tlv[3] && tlv[3][0].length !== 4)\n        throw new Error(\"TLV 3 should be 4 bytes\");\n      return {\n        type: \"nevent\",\n        data: {\n          id: bytesToHex3(tlv[0][0]),\n          relays: tlv[1] ? tlv[1].map((d) => utf8Decoder.decode(d)) : [],\n          author: tlv[2]?.[0] ? bytesToHex3(tlv[2][0]) : void 0,\n          kind: tlv[3]?.[0] ? parseInt(bytesToHex3(tlv[3][0]), 16) : void 0\n        }\n      };\n    }\n    case \"naddr\": {\n      let tlv = parseTLV(data);\n      if (!tlv[0]?.[0])\n        throw new Error(\"missing TLV 0 for naddr\");\n      if (!tlv[2]?.[0])\n        throw new Error(\"missing TLV 2 for naddr\");\n      if (tlv[2][0].length !== 32)\n        throw new Error(\"TLV 2 should be 32 bytes\");\n      if (!tlv[3]?.[0])\n        throw new Error(\"missing TLV 3 for naddr\");\n      if (tlv[3][0].length !== 4)\n        throw new Error(\"TLV 3 should be 4 bytes\");\n      return {\n        type: \"naddr\",\n        data: {\n          identifier: utf8Decoder.decode(tlv[0][0]),\n          pubkey: bytesToHex3(tlv[2][0]),\n          kind: parseInt(bytesToHex3(tlv[3][0]), 16),\n          relays: tlv[1] ? tlv[1].map((d) => utf8Decoder.decode(d)) : []\n        }\n      };\n    }\n    case \"nsec\":\n      return { type: prefix, data };\n    case \"npub\":\n    case \"note\":\n      return { type: prefix, data: bytesToHex3(data) };\n    default:\n      throw new Error(`unknown prefix ${prefix}`);\n  }\n}\nfunction parseTLV(data) {\n  let result = {};\n  let rest = data;\n  while (rest.length > 0) {\n    let t = rest[0];\n    let l = rest[1];\n    let v = rest.slice(2, 2 + l);\n    rest = rest.slice(2 + l);\n    if (v.length < l)\n      throw new Error(`not enough data to read on TLV ${t}`);\n    result[t] = result[t] || [];\n    result[t].push(v);\n  }\n  return result;\n}\nfunction nsecEncode(key) {\n  return encodeBytes(\"nsec\", key);\n}\nfunction npubEncode(hex) {\n  return encodeBytes(\"npub\", hexToBytes2(hex));\n}\nfunction noteEncode(hex) {\n  return encodeBytes(\"note\", hexToBytes2(hex));\n}\nfunction encodeBech32(prefix, data) {\n  let words = bech32.toWords(data);\n  return bech32.encode(prefix, words, Bech32MaxSize);\n}\nfunction encodeBytes(prefix, bytes) {\n  return encodeBech32(prefix, bytes);\n}\nfunction nprofileEncode(profile) {\n  let data = encodeTLV({\n    0: [hexToBytes2(profile.pubkey)],\n    1: (profile.relays || []).map((url) => utf8Encoder.encode(url))\n  });\n  return encodeBech32(\"nprofile\", data);\n}\nfunction neventEncode(event) {\n  let kindArray;\n  if (event.kind !== void 0) {\n    kindArray = integerToUint8Array(event.kind);\n  }\n  let data = encodeTLV({\n    0: [hexToBytes2(event.id)],\n    1: (event.relays || []).map((url) => utf8Encoder.encode(url)),\n    2: event.author ? [hexToBytes2(event.author)] : [],\n    3: kindArray ? [new Uint8Array(kindArray)] : []\n  });\n  return encodeBech32(\"nevent\", data);\n}\nfunction naddrEncode(addr) {\n  let kind = new ArrayBuffer(4);\n  new DataView(kind).setUint32(0, addr.kind, false);\n  let data = encodeTLV({\n    0: [utf8Encoder.encode(addr.identifier)],\n    1: (addr.relays || []).map((url) => utf8Encoder.encode(url)),\n    2: [hexToBytes2(addr.pubkey)],\n    3: [new Uint8Array(kind)]\n  });\n  return encodeBech32(\"naddr\", data);\n}\nfunction encodeTLV(tlv) {\n  let entries = [];\n  Object.entries(tlv).reverse().forEach(([t, vs]) => {\n    vs.forEach((v) => {\n      let entry = new Uint8Array(v.length + 2);\n      entry.set([parseInt(t)], 0);\n      entry.set([v.length], 1);\n      entry.set(v, 2);\n      entries.push(entry);\n    });\n  });\n  return concatBytes(...entries);\n}\n\n// references.ts\nvar mentionRegex = /\\bnostr:((note|npub|naddr|nevent|nprofile)1\\w+)\\b|#\\[(\\d+)\\]/g;\nfunction parseReferences(evt) {\n  let references = [];\n  for (let ref of evt.content.matchAll(mentionRegex)) {\n    if (ref[2]) {\n      try {\n        let { type, data } = decode(ref[1]);\n        switch (type) {\n          case \"npub\": {\n            references.push({\n              text: ref[0],\n              profile: { pubkey: data, relays: [] }\n            });\n            break;\n          }\n          case \"nprofile\": {\n            references.push({\n              text: ref[0],\n              profile: data\n            });\n            break;\n          }\n          case \"note\": {\n            references.push({\n              text: ref[0],\n              event: { id: data, relays: [] }\n            });\n            break;\n          }\n          case \"nevent\": {\n            references.push({\n              text: ref[0],\n              event: data\n            });\n            break;\n          }\n          case \"naddr\": {\n            references.push({\n              text: ref[0],\n              address: data\n            });\n            break;\n          }\n        }\n      } catch (err) {\n      }\n    } else if (ref[3]) {\n      let idx = parseInt(ref[3], 10);\n      let tag = evt.tags[idx];\n      if (!tag)\n        continue;\n      switch (tag[0]) {\n        case \"p\": {\n          references.push({\n            text: ref[0],\n            profile: { pubkey: tag[1], relays: tag[2] ? [tag[2]] : [] }\n          });\n          break;\n        }\n        case \"e\": {\n          references.push({\n            text: ref[0],\n            event: { id: tag[1], relays: tag[2] ? [tag[2]] : [] }\n          });\n          break;\n        }\n        case \"a\": {\n          try {\n            let [kind, pubkey, identifier] = tag[1].split(\":\");\n            references.push({\n              text: ref[0],\n              address: {\n                identifier,\n                pubkey,\n                kind: parseInt(kind, 10),\n                relays: tag[2] ? [tag[2]] : []\n              }\n            });\n          } catch (err) {\n          }\n          break;\n        }\n      }\n    }\n  }\n  return references;\n}\n\n// nip04.ts\nvar nip04_exports = {};\n__export(nip04_exports, {\n  decrypt: () => decrypt,\n  encrypt: () => encrypt\n});\nimport { bytesToHex as bytesToHex4, randomBytes } from \"@noble/hashes/utils\";\nimport { secp256k1 } from \"@noble/curves/secp256k1\";\nimport { cbc } from \"@noble/ciphers/aes\";\nimport { base64 } from \"@scure/base\";\nfunction encrypt(secretKey, pubkey, text) {\n  const privkey = secretKey instanceof Uint8Array ? bytesToHex4(secretKey) : secretKey;\n  const key = secp256k1.getSharedSecret(privkey, \"02\" + pubkey);\n  const normalizedKey = getNormalizedX(key);\n  let iv = Uint8Array.from(randomBytes(16));\n  let plaintext = utf8Encoder.encode(text);\n  let ciphertext = cbc(normalizedKey, iv).encrypt(plaintext);\n  let ctb64 = base64.encode(new Uint8Array(ciphertext));\n  let ivb64 = base64.encode(new Uint8Array(iv.buffer));\n  return `${ctb64}?iv=${ivb64}`;\n}\nfunction decrypt(secretKey, pubkey, data) {\n  const privkey = secretKey instanceof Uint8Array ? bytesToHex4(secretKey) : secretKey;\n  let [ctb64, ivb64] = data.split(\"?iv=\");\n  let key = secp256k1.getSharedSecret(privkey, \"02\" + pubkey);\n  let normalizedKey = getNormalizedX(key);\n  let iv = base64.decode(ivb64);\n  let ciphertext = base64.decode(ctb64);\n  let plaintext = cbc(normalizedKey, iv).decrypt(ciphertext);\n  return utf8Decoder.decode(plaintext);\n}\nfunction getNormalizedX(key) {\n  return key.slice(1, 33);\n}\n\n// nip05.ts\nvar nip05_exports = {};\n__export(nip05_exports, {\n  NIP05_REGEX: () => NIP05_REGEX,\n  isNip05: () => isNip05,\n  isValid: () => isValid,\n  queryProfile: () => queryProfile,\n  searchDomain: () => searchDomain,\n  useFetchImplementation: () => useFetchImplementation\n});\nvar NIP05_REGEX = /^(?:([\\w.+-]+)@)?([\\w_-]+(\\.[\\w_-]+)+)$/;\nvar isNip05 = (value) => NIP05_REGEX.test(value || \"\");\nvar _fetch;\ntry {\n  _fetch = fetch;\n} catch (_) {\n  null;\n}\nfunction useFetchImplementation(fetchImplementation) {\n  _fetch = fetchImplementation;\n}\nasync function searchDomain(domain, query = \"\") {\n  try {\n    const url = `https://${domain}/.well-known/nostr.json?name=${query}`;\n    const res = await _fetch(url, { redirect: \"manual\" });\n    if (res.status !== 200) {\n      throw Error(\"Wrong response code\");\n    }\n    const json = await res.json();\n    return json.names;\n  } catch (_) {\n    return {};\n  }\n}\nasync function queryProfile(fullname) {\n  const match = fullname.match(NIP05_REGEX);\n  if (!match)\n    return null;\n  const [, name = \"_\", domain] = match;\n  try {\n    const url = `https://${domain}/.well-known/nostr.json?name=${name}`;\n    const res = await _fetch(url, { redirect: \"manual\" });\n    if (res.status !== 200) {\n      throw Error(\"Wrong response code\");\n    }\n    const json = await res.json();\n    const pubkey = json.names[name];\n    return pubkey ? { pubkey, relays: json.relays?.[pubkey] } : null;\n  } catch (_e) {\n    return null;\n  }\n}\nasync function isValid(pubkey, nip05) {\n  const res = await queryProfile(nip05);\n  return res ? res.pubkey === pubkey : false;\n}\n\n// nip10.ts\nvar nip10_exports = {};\n__export(nip10_exports, {\n  parse: () => parse\n});\nfunction parse(event) {\n  const result = {\n    reply: void 0,\n    root: void 0,\n    mentions: [],\n    profiles: [],\n    quotes: []\n  };\n  let maybeParent;\n  let maybeRoot;\n  for (let i2 = event.tags.length - 1; i2 >= 0; i2--) {\n    const tag = event.tags[i2];\n    if (tag[0] === \"e\" && tag[1]) {\n      const [_, eTagEventId, eTagRelayUrl, eTagMarker, eTagAuthor] = tag;\n      const eventPointer = {\n        id: eTagEventId,\n        relays: eTagRelayUrl ? [eTagRelayUrl] : [],\n        author: eTagAuthor\n      };\n      if (eTagMarker === \"root\") {\n        result.root = eventPointer;\n        continue;\n      }\n      if (eTagMarker === \"reply\") {\n        result.reply = eventPointer;\n        continue;\n      }\n      if (eTagMarker === \"mention\") {\n        result.mentions.push(eventPointer);\n        continue;\n      }\n      if (!maybeParent) {\n        maybeParent = eventPointer;\n      } else {\n        maybeRoot = eventPointer;\n      }\n      result.mentions.push(eventPointer);\n      continue;\n    }\n    if (tag[0] === \"q\" && tag[1]) {\n      const [_, eTagEventId, eTagRelayUrl] = tag;\n      result.quotes.push({\n        id: eTagEventId,\n        relays: eTagRelayUrl ? [eTagRelayUrl] : []\n      });\n    }\n    if (tag[0] === \"p\" && tag[1]) {\n      result.profiles.push({\n        pubkey: tag[1],\n        relays: tag[2] ? [tag[2]] : []\n      });\n      continue;\n    }\n  }\n  if (!result.root) {\n    result.root = maybeRoot || maybeParent || result.reply;\n  }\n  if (!result.reply) {\n    result.reply = maybeParent || result.root;\n  }\n  ;\n  [result.reply, result.root].forEach((ref) => {\n    if (!ref)\n      return;\n    let idx = result.mentions.indexOf(ref);\n    if (idx !== -1) {\n      result.mentions.splice(idx, 1);\n    }\n    if (ref.author) {\n      let author = result.profiles.find((p) => p.pubkey === ref.author);\n      if (author && author.relays) {\n        if (!ref.relays) {\n          ref.relays = [];\n        }\n        author.relays.forEach((url) => {\n          if (ref.relays?.indexOf(url) === -1)\n            ref.relays.push(url);\n        });\n        author.relays = ref.relays;\n      }\n    }\n  });\n  result.mentions.forEach((ref) => {\n    if (ref.author) {\n      let author = result.profiles.find((p) => p.pubkey === ref.author);\n      if (author && author.relays) {\n        if (!ref.relays) {\n          ref.relays = [];\n        }\n        author.relays.forEach((url) => {\n          if (ref.relays.indexOf(url) === -1)\n            ref.relays.push(url);\n        });\n        author.relays = ref.relays;\n      }\n    }\n  });\n  return result;\n}\n\n// nip11.ts\nvar nip11_exports = {};\n__export(nip11_exports, {\n  fetchRelayInformation: () => fetchRelayInformation,\n  useFetchImplementation: () => useFetchImplementation2\n});\nvar _fetch2;\ntry {\n  _fetch2 = fetch;\n} catch {\n}\nfunction useFetchImplementation2(fetchImplementation) {\n  _fetch2 = fetchImplementation;\n}\nasync function fetchRelayInformation(url) {\n  return await (await fetch(url.replace(\"ws://\", \"http://\").replace(\"wss://\", \"https://\"), {\n    headers: { Accept: \"application/nostr+json\" }\n  })).json();\n}\n\n// nip13.ts\nvar nip13_exports = {};\n__export(nip13_exports, {\n  fastEventHash: () => fastEventHash,\n  getPow: () => getPow,\n  minePow: () => minePow\n});\nimport { bytesToHex as bytesToHex5 } from \"@noble/hashes/utils\";\nimport { sha256 as sha2562 } from \"@noble/hashes/sha256\";\nfunction getPow(hex) {\n  let count = 0;\n  for (let i2 = 0; i2 < 64; i2 += 8) {\n    const nibble = parseInt(hex.substring(i2, i2 + 8), 16);\n    if (nibble === 0) {\n      count += 32;\n    } else {\n      count += Math.clz32(nibble);\n      break;\n    }\n  }\n  return count;\n}\nfunction minePow(unsigned, difficulty) {\n  let count = 0;\n  const event = unsigned;\n  const tag = [\"nonce\", count.toString(), difficulty.toString()];\n  event.tags.push(tag);\n  while (true) {\n    const now2 = Math.floor(new Date().getTime() / 1e3);\n    if (now2 !== event.created_at) {\n      count = 0;\n      event.created_at = now2;\n    }\n    tag[1] = (++count).toString();\n    event.id = fastEventHash(event);\n    if (getPow(event.id) >= difficulty) {\n      break;\n    }\n  }\n  return event;\n}\nfunction fastEventHash(evt) {\n  return bytesToHex5(\n    sha2562(utf8Encoder.encode(JSON.stringify([0, evt.pubkey, evt.created_at, evt.kind, evt.tags, evt.content])))\n  );\n}\n\n// nip17.ts\nvar nip17_exports = {};\n__export(nip17_exports, {\n  unwrapEvent: () => unwrapEvent2,\n  unwrapManyEvents: () => unwrapManyEvents2,\n  wrapEvent: () => wrapEvent2,\n  wrapManyEvents: () => wrapManyEvents2\n});\n\n// nip59.ts\nvar nip59_exports = {};\n__export(nip59_exports, {\n  createRumor: () => createRumor,\n  createSeal: () => createSeal,\n  createWrap: () => createWrap,\n  unwrapEvent: () => unwrapEvent,\n  unwrapManyEvents: () => unwrapManyEvents,\n  wrapEvent: () => wrapEvent,\n  wrapManyEvents: () => wrapManyEvents\n});\n\n// nip44.ts\nvar nip44_exports = {};\n__export(nip44_exports, {\n  decrypt: () => decrypt2,\n  encrypt: () => encrypt2,\n  getConversationKey: () => getConversationKey,\n  v2: () => v2\n});\nimport { chacha20 } from \"@noble/ciphers/chacha\";\nimport { equalBytes } from \"@noble/ciphers/utils\";\nimport { secp256k1 as secp256k12 } from \"@noble/curves/secp256k1\";\nimport { extract as hkdf_extract, expand as hkdf_expand } from \"@noble/hashes/hkdf\";\nimport { hmac } from \"@noble/hashes/hmac\";\nimport { sha256 as sha2563 } from \"@noble/hashes/sha256\";\nimport { concatBytes as concatBytes2, randomBytes as randomBytes2 } from \"@noble/hashes/utils\";\nimport { base64 as base642 } from \"@scure/base\";\nvar minPlaintextSize = 1;\nvar maxPlaintextSize = 65535;\nfunction getConversationKey(privkeyA, pubkeyB) {\n  const sharedX = secp256k12.getSharedSecret(privkeyA, \"02\" + pubkeyB).subarray(1, 33);\n  return hkdf_extract(sha2563, sharedX, \"nip44-v2\");\n}\nfunction getMessageKeys(conversationKey, nonce) {\n  const keys = hkdf_expand(sha2563, conversationKey, nonce, 76);\n  return {\n    chacha_key: keys.subarray(0, 32),\n    chacha_nonce: keys.subarray(32, 44),\n    hmac_key: keys.subarray(44, 76)\n  };\n}\nfunction calcPaddedLen(len) {\n  if (!Number.isSafeInteger(len) || len < 1)\n    throw new Error(\"expected positive integer\");\n  if (len <= 32)\n    return 32;\n  const nextPower = 1 << Math.floor(Math.log2(len - 1)) + 1;\n  const chunk = nextPower <= 256 ? 32 : nextPower / 8;\n  return chunk * (Math.floor((len - 1) / chunk) + 1);\n}\nfunction writeU16BE(num) {\n  if (!Number.isSafeInteger(num) || num < minPlaintextSize || num > maxPlaintextSize)\n    throw new Error(\"invalid plaintext size: must be between 1 and 65535 bytes\");\n  const arr = new Uint8Array(2);\n  new DataView(arr.buffer).setUint16(0, num, false);\n  return arr;\n}\nfunction pad(plaintext) {\n  const unpadded = utf8Encoder.encode(plaintext);\n  const unpaddedLen = unpadded.length;\n  const prefix = writeU16BE(unpaddedLen);\n  const suffix = new Uint8Array(calcPaddedLen(unpaddedLen) - unpaddedLen);\n  return concatBytes2(prefix, unpadded, suffix);\n}\nfunction unpad(padded) {\n  const unpaddedLen = new DataView(padded.buffer).getUint16(0);\n  const unpadded = padded.subarray(2, 2 + unpaddedLen);\n  if (unpaddedLen < minPlaintextSize || unpaddedLen > maxPlaintextSize || unpadded.length !== unpaddedLen || padded.length !== 2 + calcPaddedLen(unpaddedLen))\n    throw new Error(\"invalid padding\");\n  return utf8Decoder.decode(unpadded);\n}\nfunction hmacAad(key, message, aad) {\n  if (aad.length !== 32)\n    throw new Error(\"AAD associated data must be 32 bytes\");\n  const combined = concatBytes2(aad, message);\n  return hmac(sha2563, key, combined);\n}\nfunction decodePayload(payload) {\n  if (typeof payload !== \"string\")\n    throw new Error(\"payload must be a valid string\");\n  const plen = payload.length;\n  if (plen < 132 || plen > 87472)\n    throw new Error(\"invalid payload length: \" + plen);\n  if (payload[0] === \"#\")\n    throw new Error(\"unknown encryption version\");\n  let data;\n  try {\n    data = base642.decode(payload);\n  } catch (error) {\n    throw new Error(\"invalid base64: \" + error.message);\n  }\n  const dlen = data.length;\n  if (dlen < 99 || dlen > 65603)\n    throw new Error(\"invalid data length: \" + dlen);\n  const vers = data[0];\n  if (vers !== 2)\n    throw new Error(\"unknown encryption version \" + vers);\n  return {\n    nonce: data.subarray(1, 33),\n    ciphertext: data.subarray(33, -32),\n    mac: data.subarray(-32)\n  };\n}\nfunction encrypt2(plaintext, conversationKey, nonce = randomBytes2(32)) {\n  const { chacha_key, chacha_nonce, hmac_key } = getMessageKeys(conversationKey, nonce);\n  const padded = pad(plaintext);\n  const ciphertext = chacha20(chacha_key, chacha_nonce, padded);\n  const mac = hmacAad(hmac_key, ciphertext, nonce);\n  return base642.encode(concatBytes2(new Uint8Array([2]), nonce, ciphertext, mac));\n}\nfunction decrypt2(payload, conversationKey) {\n  const { nonce, ciphertext, mac } = decodePayload(payload);\n  const { chacha_key, chacha_nonce, hmac_key } = getMessageKeys(conversationKey, nonce);\n  const calculatedMac = hmacAad(hmac_key, ciphertext, nonce);\n  if (!equalBytes(calculatedMac, mac))\n    throw new Error(\"invalid MAC\");\n  const padded = chacha20(chacha_key, chacha_nonce, ciphertext);\n  return unpad(padded);\n}\nvar v2 = {\n  utils: {\n    getConversationKey,\n    calcPaddedLen\n  },\n  encrypt: encrypt2,\n  decrypt: decrypt2\n};\n\n// nip59.ts\nvar TWO_DAYS = 2 * 24 * 60 * 60;\nvar now = () => Math.round(Date.now() / 1e3);\nvar randomNow = () => Math.round(now() - Math.random() * TWO_DAYS);\nvar nip44ConversationKey = (privateKey, publicKey) => getConversationKey(privateKey, publicKey);\nvar nip44Encrypt = (data, privateKey, publicKey) => encrypt2(JSON.stringify(data), nip44ConversationKey(privateKey, publicKey));\nvar nip44Decrypt = (data, privateKey) => JSON.parse(decrypt2(data.content, nip44ConversationKey(privateKey, data.pubkey)));\nfunction createRumor(event, privateKey) {\n  const rumor = {\n    created_at: now(),\n    content: \"\",\n    tags: [],\n    ...event,\n    pubkey: getPublicKey(privateKey)\n  };\n  rumor.id = getEventHash(rumor);\n  return rumor;\n}\nfunction createSeal(rumor, privateKey, recipientPublicKey) {\n  return finalizeEvent(\n    {\n      kind: Seal,\n      content: nip44Encrypt(rumor, privateKey, recipientPublicKey),\n      created_at: randomNow(),\n      tags: []\n    },\n    privateKey\n  );\n}\nfunction createWrap(seal, recipientPublicKey) {\n  const randomKey = generateSecretKey();\n  return finalizeEvent(\n    {\n      kind: GiftWrap,\n      content: nip44Encrypt(seal, randomKey, recipientPublicKey),\n      created_at: randomNow(),\n      tags: [[\"p\", recipientPublicKey]]\n    },\n    randomKey\n  );\n}\nfunction wrapEvent(event, senderPrivateKey, recipientPublicKey) {\n  const rumor = createRumor(event, senderPrivateKey);\n  const seal = createSeal(rumor, senderPrivateKey, recipientPublicKey);\n  return createWrap(seal, recipientPublicKey);\n}\nfunction wrapManyEvents(event, senderPrivateKey, recipientsPublicKeys) {\n  if (!recipientsPublicKeys || recipientsPublicKeys.length === 0) {\n    throw new Error(\"At least one recipient is required.\");\n  }\n  const senderPublicKey = getPublicKey(senderPrivateKey);\n  const wrappeds = [wrapEvent(event, senderPrivateKey, senderPublicKey)];\n  recipientsPublicKeys.forEach((recipientPublicKey) => {\n    wrappeds.push(wrapEvent(event, senderPrivateKey, recipientPublicKey));\n  });\n  return wrappeds;\n}\nfunction unwrapEvent(wrap, recipientPrivateKey) {\n  const unwrappedSeal = nip44Decrypt(wrap, recipientPrivateKey);\n  return nip44Decrypt(unwrappedSeal, recipientPrivateKey);\n}\nfunction unwrapManyEvents(wrappedEvents, recipientPrivateKey) {\n  let unwrappedEvents = [];\n  wrappedEvents.forEach((e) => {\n    unwrappedEvents.push(unwrapEvent(e, recipientPrivateKey));\n  });\n  unwrappedEvents.sort((a, b) => a.created_at - b.created_at);\n  return unwrappedEvents;\n}\n\n// nip17.ts\nfunction createEvent(recipients, message, conversationTitle, replyTo) {\n  const baseEvent = {\n    created_at: Math.ceil(Date.now() / 1e3),\n    kind: PrivateDirectMessage,\n    tags: [],\n    content: message\n  };\n  const recipientsArray = Array.isArray(recipients) ? recipients : [recipients];\n  recipientsArray.forEach(({ publicKey, relayUrl }) => {\n    baseEvent.tags.push(relayUrl ? [\"p\", publicKey, relayUrl] : [\"p\", publicKey]);\n  });\n  if (replyTo) {\n    baseEvent.tags.push([\"e\", replyTo.eventId, replyTo.relayUrl || \"\", \"reply\"]);\n  }\n  if (conversationTitle) {\n    baseEvent.tags.push([\"subject\", conversationTitle]);\n  }\n  return baseEvent;\n}\nfunction wrapEvent2(senderPrivateKey, recipient, message, conversationTitle, replyTo) {\n  const event = createEvent(recipient, message, conversationTitle, replyTo);\n  return wrapEvent(event, senderPrivateKey, recipient.publicKey);\n}\nfunction wrapManyEvents2(senderPrivateKey, recipients, message, conversationTitle, replyTo) {\n  if (!recipients || recipients.length === 0) {\n    throw new Error(\"At least one recipient is required.\");\n  }\n  const senderPublicKey = getPublicKey(senderPrivateKey);\n  return [{ publicKey: senderPublicKey }, ...recipients].map(\n    (recipient) => wrapEvent2(senderPrivateKey, recipient, message, conversationTitle, replyTo)\n  );\n}\nvar unwrapEvent2 = unwrapEvent;\nvar unwrapManyEvents2 = unwrapManyEvents;\n\n// nip18.ts\nvar nip18_exports = {};\n__export(nip18_exports, {\n  finishRepostEvent: () => finishRepostEvent,\n  getRepostedEvent: () => getRepostedEvent,\n  getRepostedEventPointer: () => getRepostedEventPointer\n});\nfunction finishRepostEvent(t, reposted, relayUrl, privateKey) {\n  let kind;\n  const tags = [...t.tags ?? [], [\"e\", reposted.id, relayUrl], [\"p\", reposted.pubkey]];\n  if (reposted.kind === ShortTextNote) {\n    kind = Repost;\n  } else {\n    kind = GenericRepost;\n    tags.push([\"k\", String(reposted.kind)]);\n  }\n  return finalizeEvent(\n    {\n      kind,\n      tags,\n      content: t.content === \"\" || reposted.tags?.find((tag) => tag[0] === \"-\") ? \"\" : JSON.stringify(reposted),\n      created_at: t.created_at\n    },\n    privateKey\n  );\n}\nfunction getRepostedEventPointer(event) {\n  if (![Repost, GenericRepost].includes(event.kind)) {\n    return void 0;\n  }\n  let lastETag;\n  let lastPTag;\n  for (let i2 = event.tags.length - 1; i2 >= 0 && (lastETag === void 0 || lastPTag === void 0); i2--) {\n    const tag = event.tags[i2];\n    if (tag.length >= 2) {\n      if (tag[0] === \"e\" && lastETag === void 0) {\n        lastETag = tag;\n      } else if (tag[0] === \"p\" && lastPTag === void 0) {\n        lastPTag = tag;\n      }\n    }\n  }\n  if (lastETag === void 0) {\n    return void 0;\n  }\n  return {\n    id: lastETag[1],\n    relays: [lastETag[2], lastPTag?.[2]].filter((x) => typeof x === \"string\"),\n    author: lastPTag?.[1]\n  };\n}\nfunction getRepostedEvent(event, { skipVerification } = {}) {\n  const pointer = getRepostedEventPointer(event);\n  if (pointer === void 0 || event.content === \"\") {\n    return void 0;\n  }\n  let repostedEvent;\n  try {\n    repostedEvent = JSON.parse(event.content);\n  } catch (error) {\n    return void 0;\n  }\n  if (repostedEvent.id !== pointer.id) {\n    return void 0;\n  }\n  if (!skipVerification && !verifyEvent(repostedEvent)) {\n    return void 0;\n  }\n  return repostedEvent;\n}\n\n// nip21.ts\nvar nip21_exports = {};\n__export(nip21_exports, {\n  NOSTR_URI_REGEX: () => NOSTR_URI_REGEX,\n  parse: () => parse2,\n  test: () => test\n});\nvar NOSTR_URI_REGEX = new RegExp(`nostr:(${BECH32_REGEX.source})`);\nfunction test(value) {\n  return typeof value === \"string\" && new RegExp(`^${NOSTR_URI_REGEX.source}$`).test(value);\n}\nfunction parse2(uri) {\n  const match = uri.match(new RegExp(`^${NOSTR_URI_REGEX.source}$`));\n  if (!match)\n    throw new Error(`Invalid Nostr URI: ${uri}`);\n  return {\n    uri: match[0],\n    value: match[1],\n    decoded: decode(match[1])\n  };\n}\n\n// nip25.ts\nvar nip25_exports = {};\n__export(nip25_exports, {\n  finishReactionEvent: () => finishReactionEvent,\n  getReactedEventPointer: () => getReactedEventPointer\n});\nfunction finishReactionEvent(t, reacted, privateKey) {\n  const inheritedTags = reacted.tags.filter((tag) => tag.length >= 2 && (tag[0] === \"e\" || tag[0] === \"p\"));\n  return finalizeEvent(\n    {\n      ...t,\n      kind: Reaction,\n      tags: [...t.tags ?? [], ...inheritedTags, [\"e\", reacted.id], [\"p\", reacted.pubkey]],\n      content: t.content ?? \"+\"\n    },\n    privateKey\n  );\n}\nfunction getReactedEventPointer(event) {\n  if (event.kind !== Reaction) {\n    return void 0;\n  }\n  let lastETag;\n  let lastPTag;\n  for (let i2 = event.tags.length - 1; i2 >= 0 && (lastETag === void 0 || lastPTag === void 0); i2--) {\n    const tag = event.tags[i2];\n    if (tag.length >= 2) {\n      if (tag[0] === \"e\" && lastETag === void 0) {\n        lastETag = tag;\n      } else if (tag[0] === \"p\" && lastPTag === void 0) {\n        lastPTag = tag;\n      }\n    }\n  }\n  if (lastETag === void 0 || lastPTag === void 0) {\n    return void 0;\n  }\n  return {\n    id: lastETag[1],\n    relays: [lastETag[2], lastPTag[2]].filter((x) => x !== void 0),\n    author: lastPTag[1]\n  };\n}\n\n// nip27.ts\nvar nip27_exports = {};\n__export(nip27_exports, {\n  parse: () => parse3\n});\nvar noCharacter = /\\W/m;\nvar noURLCharacter = /\\W |\\W$|$|,| /m;\nvar MAX_HASHTAG_LENGTH = 42;\nfunction* parse3(content) {\n  let emojis = [];\n  if (typeof content !== \"string\") {\n    for (let i2 = 0; i2 < content.tags.length; i2++) {\n      const tag = content.tags[i2];\n      if (tag[0] === \"emoji\" && tag.length >= 3) {\n        emojis.push({ type: \"emoji\", shortcode: tag[1], url: tag[2] });\n      }\n    }\n    content = content.content;\n  }\n  const max = content.length;\n  let prevIndex = 0;\n  let index = 0;\n  mainloop:\n    while (index < max) {\n      const u = content.indexOf(\":\", index);\n      const h = content.indexOf(\"#\", index);\n      if (u === -1 && h === -1) {\n        break mainloop;\n      }\n      if (u === -1 || h >= 0 && h < u) {\n        if (h === 0 || content[h - 1] === \" \") {\n          const m = content.slice(h + 1, h + MAX_HASHTAG_LENGTH).match(noCharacter);\n          const end = m ? h + 1 + m.index : max;\n          yield { type: \"text\", text: content.slice(prevIndex, h) };\n          yield { type: \"hashtag\", value: content.slice(h + 1, end) };\n          index = end;\n          prevIndex = index;\n          continue mainloop;\n        }\n        index = h + 1;\n        continue mainloop;\n      }\n      if (content.slice(u - 5, u) === \"nostr\") {\n        const m = content.slice(u + 60).match(noCharacter);\n        const end = m ? u + 60 + m.index : max;\n        try {\n          let pointer;\n          let { data, type } = decode(content.slice(u + 1, end));\n          switch (type) {\n            case \"npub\":\n              pointer = { pubkey: data };\n              break;\n            case \"nsec\":\n            case \"note\":\n              index = end + 1;\n              continue;\n            default:\n              pointer = data;\n          }\n          if (prevIndex !== u - 5) {\n            yield { type: \"text\", text: content.slice(prevIndex, u - 5) };\n          }\n          yield { type: \"reference\", pointer };\n          index = end;\n          prevIndex = index;\n          continue mainloop;\n        } catch (_err) {\n          index = u + 1;\n          continue mainloop;\n        }\n      } else if (content.slice(u - 5, u) === \"https\" || content.slice(u - 4, u) === \"http\") {\n        const m = content.slice(u + 4).match(noURLCharacter);\n        const end = m ? u + 4 + m.index : max;\n        const prefixLen = content[u - 1] === \"s\" ? 5 : 4;\n        try {\n          let url = new URL(content.slice(u - prefixLen, end));\n          if (url.hostname.indexOf(\".\") === -1) {\n            throw new Error(\"invalid url\");\n          }\n          if (prevIndex !== u - prefixLen) {\n            yield { type: \"text\", text: content.slice(prevIndex, u - prefixLen) };\n          }\n          if (/\\.(png|jpe?g|gif|webp|heic|svg)$/i.test(url.pathname)) {\n            yield { type: \"image\", url: url.toString() };\n            index = end;\n            prevIndex = index;\n            continue mainloop;\n          }\n          if (/\\.(mp4|avi|webm|mkv|mov)$/i.test(url.pathname)) {\n            yield { type: \"video\", url: url.toString() };\n            index = end;\n            prevIndex = index;\n            continue mainloop;\n          }\n          if (/\\.(mp3|aac|ogg|opus|wav|flac)$/i.test(url.pathname)) {\n            yield { type: \"audio\", url: url.toString() };\n            index = end;\n            prevIndex = index;\n            continue mainloop;\n          }\n          yield { type: \"url\", url: url.toString() };\n          index = end;\n          prevIndex = index;\n          continue mainloop;\n        } catch (_err) {\n          index = end + 1;\n          continue mainloop;\n        }\n      } else if (content.slice(u - 3, u) === \"wss\" || content.slice(u - 2, u) === \"ws\") {\n        const m = content.slice(u + 4).match(noURLCharacter);\n        const end = m ? u + 4 + m.index : max;\n        const prefixLen = content[u - 1] === \"s\" ? 3 : 2;\n        try {\n          let url = new URL(content.slice(u - prefixLen, end));\n          if (url.hostname.indexOf(\".\") === -1) {\n            throw new Error(\"invalid ws url\");\n          }\n          if (prevIndex !== u - prefixLen) {\n            yield { type: \"text\", text: content.slice(prevIndex, u - prefixLen) };\n          }\n          yield { type: \"relay\", url: url.toString() };\n          index = end;\n          prevIndex = index;\n          continue mainloop;\n        } catch (_err) {\n          index = end + 1;\n          continue mainloop;\n        }\n      } else {\n        for (let e = 0; e < emojis.length; e++) {\n          const emoji = emojis[e];\n          if (content[u + emoji.shortcode.length + 1] === \":\" && content.slice(u + 1, u + emoji.shortcode.length + 1) === emoji.shortcode) {\n            if (prevIndex !== u) {\n              yield { type: \"text\", text: content.slice(prevIndex, u) };\n            }\n            yield emoji;\n            index = u + emoji.shortcode.length + 2;\n            prevIndex = index;\n            continue mainloop;\n          }\n        }\n        index = u + 1;\n        continue mainloop;\n      }\n    }\n  if (prevIndex !== max) {\n    yield { type: \"text\", text: content.slice(prevIndex) };\n  }\n}\n\n// nip28.ts\nvar nip28_exports = {};\n__export(nip28_exports, {\n  channelCreateEvent: () => channelCreateEvent,\n  channelHideMessageEvent: () => channelHideMessageEvent,\n  channelMessageEvent: () => channelMessageEvent,\n  channelMetadataEvent: () => channelMetadataEvent,\n  channelMuteUserEvent: () => channelMuteUserEvent\n});\nvar channelCreateEvent = (t, privateKey) => {\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finalizeEvent(\n    {\n      kind: ChannelCreation,\n      tags: [...t.tags ?? []],\n      content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\nvar channelMetadataEvent = (t, privateKey) => {\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finalizeEvent(\n    {\n      kind: ChannelMetadata,\n      tags: [[\"e\", t.channel_create_event_id], ...t.tags ?? []],\n      content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\nvar channelMessageEvent = (t, privateKey) => {\n  const tags = [[\"e\", t.channel_create_event_id, t.relay_url, \"root\"]];\n  if (t.reply_to_channel_message_event_id) {\n    tags.push([\"e\", t.reply_to_channel_message_event_id, t.relay_url, \"reply\"]);\n  }\n  return finalizeEvent(\n    {\n      kind: ChannelMessage,\n      tags: [...tags, ...t.tags ?? []],\n      content: t.content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\nvar channelHideMessageEvent = (t, privateKey) => {\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finalizeEvent(\n    {\n      kind: ChannelHideMessage,\n      tags: [[\"e\", t.channel_message_event_id], ...t.tags ?? []],\n      content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\nvar channelMuteUserEvent = (t, privateKey) => {\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finalizeEvent(\n    {\n      kind: ChannelMuteUser,\n      tags: [[\"p\", t.pubkey_to_mute], ...t.tags ?? []],\n      content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\n\n// nip30.ts\nvar nip30_exports = {};\n__export(nip30_exports, {\n  EMOJI_SHORTCODE_REGEX: () => EMOJI_SHORTCODE_REGEX,\n  matchAll: () => matchAll,\n  regex: () => regex,\n  replaceAll: () => replaceAll\n});\nvar EMOJI_SHORTCODE_REGEX = /:(\\w+):/;\nvar regex = () => new RegExp(`\\\\B${EMOJI_SHORTCODE_REGEX.source}\\\\B`, \"g\");\nfunction* matchAll(content) {\n  const matches = content.matchAll(regex());\n  for (const match of matches) {\n    try {\n      const [shortcode, name] = match;\n      yield {\n        shortcode,\n        name,\n        start: match.index,\n        end: match.index + shortcode.length\n      };\n    } catch (_e) {\n    }\n  }\n}\nfunction replaceAll(content, replacer) {\n  return content.replaceAll(regex(), (shortcode, name) => {\n    return replacer({\n      shortcode,\n      name\n    });\n  });\n}\n\n// nip39.ts\nvar nip39_exports = {};\n__export(nip39_exports, {\n  useFetchImplementation: () => useFetchImplementation3,\n  validateGithub: () => validateGithub\n});\nvar _fetch3;\ntry {\n  _fetch3 = fetch;\n} catch {\n}\nfunction useFetchImplementation3(fetchImplementation) {\n  _fetch3 = fetchImplementation;\n}\nasync function validateGithub(pubkey, username, proof) {\n  try {\n    let res = await (await _fetch3(`https://gist.github.com/${username}/${proof}/raw`)).text();\n    return res === `Verifying that I control the following Nostr public key: ${pubkey}`;\n  } catch (_) {\n    return false;\n  }\n}\n\n// nip47.ts\nvar nip47_exports = {};\n__export(nip47_exports, {\n  makeNwcRequestEvent: () => makeNwcRequestEvent,\n  parseConnectionString: () => parseConnectionString\n});\nfunction parseConnectionString(connectionString) {\n  const { host, pathname, searchParams } = new URL(connectionString);\n  const pubkey = pathname || host;\n  const relay = searchParams.get(\"relay\");\n  const secret = searchParams.get(\"secret\");\n  if (!pubkey || !relay || !secret) {\n    throw new Error(\"invalid connection string\");\n  }\n  return { pubkey, relay, secret };\n}\nasync function makeNwcRequestEvent(pubkey, secretKey, invoice) {\n  const content = {\n    method: \"pay_invoice\",\n    params: {\n      invoice\n    }\n  };\n  const encryptedContent = encrypt(secretKey, pubkey, JSON.stringify(content));\n  const eventTemplate = {\n    kind: NWCWalletRequest,\n    created_at: Math.round(Date.now() / 1e3),\n    content: encryptedContent,\n    tags: [[\"p\", pubkey]]\n  };\n  return finalizeEvent(eventTemplate, secretKey);\n}\n\n// nip54.ts\nvar nip54_exports = {};\n__export(nip54_exports, {\n  normalizeIdentifier: () => normalizeIdentifier\n});\nfunction normalizeIdentifier(name) {\n  name = name.trim().toLowerCase();\n  name = name.normalize(\"NFKC\");\n  return Array.from(name).map((char) => {\n    if (/\\p{Letter}/u.test(char) || /\\p{Number}/u.test(char)) {\n      return char;\n    }\n    return \"-\";\n  }).join(\"\");\n}\n\n// nip57.ts\nvar nip57_exports = {};\n__export(nip57_exports, {\n  getSatoshisAmountFromBolt11: () => getSatoshisAmountFromBolt11,\n  getZapEndpoint: () => getZapEndpoint,\n  makeZapReceipt: () => makeZapReceipt,\n  makeZapRequest: () => makeZapRequest,\n  useFetchImplementation: () => useFetchImplementation4,\n  validateZapRequest: () => validateZapRequest\n});\nimport { bech32 as bech322 } from \"@scure/base\";\nvar _fetch4;\ntry {\n  _fetch4 = fetch;\n} catch {\n}\nfunction useFetchImplementation4(fetchImplementation) {\n  _fetch4 = fetchImplementation;\n}\nasync function getZapEndpoint(metadata) {\n  try {\n    let lnurl = \"\";\n    let { lud06, lud16 } = JSON.parse(metadata.content);\n    if (lud16) {\n      let [name, domain] = lud16.split(\"@\");\n      lnurl = new URL(`/.well-known/lnurlp/${name}`, `https://${domain}`).toString();\n    } else if (lud06) {\n      let { words } = bech322.decode(lud06, 1e3);\n      let data = bech322.fromWords(words);\n      lnurl = utf8Decoder.decode(data);\n    } else {\n      return null;\n    }\n    let res = await _fetch4(lnurl);\n    let body = await res.json();\n    if (body.allowsNostr && body.nostrPubkey) {\n      return body.callback;\n    }\n  } catch (err) {\n  }\n  return null;\n}\nfunction makeZapRequest(params) {\n  let zr = {\n    kind: 9734,\n    created_at: Math.round(Date.now() / 1e3),\n    content: params.comment || \"\",\n    tags: [\n      [\"p\", \"pubkey\" in params ? params.pubkey : params.event.pubkey],\n      [\"amount\", params.amount.toString()],\n      [\"relays\", ...params.relays]\n    ]\n  };\n  if (\"event\" in params) {\n    zr.tags.push([\"e\", params.event.id]);\n    if (isReplaceableKind(params.event.kind)) {\n      const a = [\"a\", `${params.event.kind}:${params.event.pubkey}:`];\n      zr.tags.push(a);\n    } else if (isAddressableKind(params.event.kind)) {\n      let d = params.event.tags.find(([t, v]) => t === \"d\" && v);\n      if (!d)\n        throw new Error(\"d tag not found or is empty\");\n      const a = [\"a\", `${params.event.kind}:${params.event.pubkey}:${d[1]}`];\n      zr.tags.push(a);\n    }\n    zr.tags.push([\"k\", params.event.kind.toString()]);\n  }\n  return zr;\n}\nfunction validateZapRequest(zapRequestString) {\n  let zapRequest;\n  try {\n    zapRequest = JSON.parse(zapRequestString);\n  } catch (err) {\n    return \"Invalid zap request JSON.\";\n  }\n  if (!validateEvent(zapRequest))\n    return \"Zap request is not a valid Nostr event.\";\n  if (!verifyEvent(zapRequest))\n    return \"Invalid signature on zap request.\";\n  let p = zapRequest.tags.find(([t, v]) => t === \"p\" && v);\n  if (!p)\n    return \"Zap request doesn't have a 'p' tag.\";\n  if (!p[1].match(/^[a-f0-9]{64}$/))\n    return \"Zap request 'p' tag is not valid hex.\";\n  let e = zapRequest.tags.find(([t, v]) => t === \"e\" && v);\n  if (e && !e[1].match(/^[a-f0-9]{64}$/))\n    return \"Zap request 'e' tag is not valid hex.\";\n  let relays = zapRequest.tags.find(([t, v]) => t === \"relays\" && v);\n  if (!relays)\n    return \"Zap request doesn't have a 'relays' tag.\";\n  return null;\n}\nfunction makeZapReceipt({\n  zapRequest,\n  preimage,\n  bolt11,\n  paidAt\n}) {\n  let zr = JSON.parse(zapRequest);\n  let tagsFromZapRequest = zr.tags.filter(([t]) => t === \"e\" || t === \"p\" || t === \"a\");\n  let zap = {\n    kind: 9735,\n    created_at: Math.round(paidAt.getTime() / 1e3),\n    content: \"\",\n    tags: [...tagsFromZapRequest, [\"P\", zr.pubkey], [\"bolt11\", bolt11], [\"description\", zapRequest]]\n  };\n  if (preimage) {\n    zap.tags.push([\"preimage\", preimage]);\n  }\n  return zap;\n}\nfunction getSatoshisAmountFromBolt11(bolt11) {\n  if (bolt11.length < 50) {\n    return 0;\n  }\n  bolt11 = bolt11.substring(0, 50);\n  const idx = bolt11.lastIndexOf(\"1\");\n  if (idx === -1) {\n    return 0;\n  }\n  const hrp = bolt11.substring(0, idx);\n  if (!hrp.startsWith(\"lnbc\")) {\n    return 0;\n  }\n  const amount = hrp.substring(4);\n  if (amount.length < 1) {\n    return 0;\n  }\n  const char = amount[amount.length - 1];\n  const digit = char.charCodeAt(0) - \"0\".charCodeAt(0);\n  const isDigit = digit >= 0 && digit <= 9;\n  let cutPoint = amount.length - 1;\n  if (isDigit) {\n    cutPoint++;\n  }\n  if (cutPoint < 1) {\n    return 0;\n  }\n  const num = parseInt(amount.substring(0, cutPoint));\n  switch (char) {\n    case \"m\":\n      return num * 1e5;\n    case \"u\":\n      return num * 100;\n    case \"n\":\n      return num / 10;\n    case \"p\":\n      return num / 1e4;\n    default:\n      return num * 1e8;\n  }\n}\n\n// nip77.ts\nvar nip77_exports = {};\n__export(nip77_exports, {\n  Negentropy: () => Negentropy,\n  NegentropyStorageVector: () => NegentropyStorageVector,\n  NegentropySync: () => NegentropySync\n});\nimport { bytesToHex as bytesToHex6, hexToBytes as hexToBytes3 } from \"@noble/ciphers/utils\";\nimport { sha256 as sha2564 } from \"@noble/hashes/sha256\";\nvar PROTOCOL_VERSION = 97;\nvar ID_SIZE = 32;\nvar FINGERPRINT_SIZE = 16;\nvar Mode = {\n  Skip: 0,\n  Fingerprint: 1,\n  IdList: 2\n};\nvar WrappedBuffer = class {\n  _raw;\n  length;\n  constructor(buffer) {\n    if (typeof buffer === \"number\") {\n      this._raw = new Uint8Array(buffer);\n      this.length = 0;\n    } else if (buffer instanceof Uint8Array) {\n      this._raw = new Uint8Array(buffer);\n      this.length = buffer.length;\n    } else {\n      this._raw = new Uint8Array(512);\n      this.length = 0;\n    }\n  }\n  unwrap() {\n    return this._raw.subarray(0, this.length);\n  }\n  get capacity() {\n    return this._raw.byteLength;\n  }\n  extend(buf) {\n    if (buf instanceof WrappedBuffer)\n      buf = buf.unwrap();\n    if (typeof buf.length !== \"number\")\n      throw Error(\"bad length\");\n    const targetSize = buf.length + this.length;\n    if (this.capacity < targetSize) {\n      const oldRaw = this._raw;\n      const newCapacity = Math.max(this.capacity * 2, targetSize);\n      this._raw = new Uint8Array(newCapacity);\n      this._raw.set(oldRaw);\n    }\n    this._raw.set(buf, this.length);\n    this.length += buf.length;\n  }\n  shift() {\n    const first = this._raw[0];\n    this._raw = this._raw.subarray(1);\n    this.length--;\n    return first;\n  }\n  shiftN(n = 1) {\n    const firstSubarray = this._raw.subarray(0, n);\n    this._raw = this._raw.subarray(n);\n    this.length -= n;\n    return firstSubarray;\n  }\n};\nfunction decodeVarInt(buf) {\n  let res = 0;\n  while (1) {\n    if (buf.length === 0)\n      throw Error(\"parse ends prematurely\");\n    let byte = buf.shift();\n    res = res << 7 | byte & 127;\n    if ((byte & 128) === 0)\n      break;\n  }\n  return res;\n}\nfunction encodeVarInt(n) {\n  if (n === 0)\n    return new WrappedBuffer(new Uint8Array([0]));\n  let o = [];\n  while (n !== 0) {\n    o.push(n & 127);\n    n >>>= 7;\n  }\n  o.reverse();\n  for (let i2 = 0; i2 < o.length - 1; i2++)\n    o[i2] |= 128;\n  return new WrappedBuffer(new Uint8Array(o));\n}\nfunction getByte(buf) {\n  return getBytes(buf, 1)[0];\n}\nfunction getBytes(buf, n) {\n  if (buf.length < n)\n    throw Error(\"parse ends prematurely\");\n  return buf.shiftN(n);\n}\nvar Accumulator = class {\n  buf;\n  constructor() {\n    this.setToZero();\n  }\n  setToZero() {\n    this.buf = new Uint8Array(ID_SIZE);\n  }\n  add(otherBuf) {\n    let currCarry = 0, nextCarry = 0;\n    let p = new DataView(this.buf.buffer);\n    let po = new DataView(otherBuf.buffer);\n    for (let i2 = 0; i2 < 8; i2++) {\n      let offset = i2 * 4;\n      let orig = p.getUint32(offset, true);\n      let otherV = po.getUint32(offset, true);\n      let next = orig;\n      next += currCarry;\n      next += otherV;\n      if (next > 4294967295)\n        nextCarry = 1;\n      p.setUint32(offset, next & 4294967295, true);\n      currCarry = nextCarry;\n      nextCarry = 0;\n    }\n  }\n  negate() {\n    let p = new DataView(this.buf.buffer);\n    for (let i2 = 0; i2 < 8; i2++) {\n      let offset = i2 * 4;\n      p.setUint32(offset, ~p.getUint32(offset, true));\n    }\n    let one = new Uint8Array(ID_SIZE);\n    one[0] = 1;\n    this.add(one);\n  }\n  getFingerprint(n) {\n    let input = new WrappedBuffer();\n    input.extend(this.buf);\n    input.extend(encodeVarInt(n));\n    let hash = sha2564(input.unwrap());\n    return hash.subarray(0, FINGERPRINT_SIZE);\n  }\n};\nvar NegentropyStorageVector = class {\n  items;\n  sealed;\n  constructor() {\n    this.items = [];\n    this.sealed = false;\n  }\n  insert(timestamp, id) {\n    if (this.sealed)\n      throw Error(\"already sealed\");\n    const idb = hexToBytes3(id);\n    if (idb.byteLength !== ID_SIZE)\n      throw Error(\"bad id size for added item\");\n    this.items.push({ timestamp, id: idb });\n  }\n  seal() {\n    if (this.sealed)\n      throw Error(\"already sealed\");\n    this.sealed = true;\n    this.items.sort(itemCompare);\n    for (let i2 = 1; i2 < this.items.length; i2++) {\n      if (itemCompare(this.items[i2 - 1], this.items[i2]) === 0)\n        throw Error(\"duplicate item inserted\");\n    }\n  }\n  unseal() {\n    this.sealed = false;\n  }\n  size() {\n    this._checkSealed();\n    return this.items.length;\n  }\n  getItem(i2) {\n    this._checkSealed();\n    if (i2 >= this.items.length)\n      throw Error(\"out of range\");\n    return this.items[i2];\n  }\n  iterate(begin, end, cb) {\n    this._checkSealed();\n    this._checkBounds(begin, end);\n    for (let i2 = begin; i2 < end; ++i2) {\n      if (!cb(this.items[i2], i2))\n        break;\n    }\n  }\n  findLowerBound(begin, end, bound) {\n    this._checkSealed();\n    this._checkBounds(begin, end);\n    return this._binarySearch(this.items, begin, end, (a) => itemCompare(a, bound) < 0);\n  }\n  fingerprint(begin, end) {\n    let out = new Accumulator();\n    out.setToZero();\n    this.iterate(begin, end, (item) => {\n      out.add(item.id);\n      return true;\n    });\n    return out.getFingerprint(end - begin);\n  }\n  _checkSealed() {\n    if (!this.sealed)\n      throw Error(\"not sealed\");\n  }\n  _checkBounds(begin, end) {\n    if (begin > end || end > this.items.length)\n      throw Error(\"bad range\");\n  }\n  _binarySearch(arr, first, last, cmp) {\n    let count = last - first;\n    while (count > 0) {\n      let it = first;\n      let step = Math.floor(count / 2);\n      it += step;\n      if (cmp(arr[it])) {\n        first = ++it;\n        count -= step + 1;\n      } else {\n        count = step;\n      }\n    }\n    return first;\n  }\n};\nvar Negentropy = class {\n  storage;\n  frameSizeLimit;\n  lastTimestampIn;\n  lastTimestampOut;\n  constructor(storage, frameSizeLimit = 6e4) {\n    if (frameSizeLimit < 4096)\n      throw Error(\"frameSizeLimit too small\");\n    this.storage = storage;\n    this.frameSizeLimit = frameSizeLimit;\n    this.lastTimestampIn = 0;\n    this.lastTimestampOut = 0;\n  }\n  _bound(timestamp, id) {\n    return { timestamp, id: id || new Uint8Array(0) };\n  }\n  initiate() {\n    let output = new WrappedBuffer();\n    output.extend(new Uint8Array([PROTOCOL_VERSION]));\n    this.splitRange(0, this.storage.size(), this._bound(Number.MAX_VALUE), output);\n    return bytesToHex6(output.unwrap());\n  }\n  reconcile(queryMsg, onhave, onneed) {\n    const query = new WrappedBuffer(hexToBytes3(queryMsg));\n    this.lastTimestampIn = this.lastTimestampOut = 0;\n    let fullOutput = new WrappedBuffer();\n    fullOutput.extend(new Uint8Array([PROTOCOL_VERSION]));\n    let protocolVersion = getByte(query);\n    if (protocolVersion < 96 || protocolVersion > 111)\n      throw Error(\"invalid negentropy protocol version byte\");\n    if (protocolVersion !== PROTOCOL_VERSION) {\n      throw Error(\"unsupported negentropy protocol version requested: \" + (protocolVersion - 96));\n    }\n    let storageSize = this.storage.size();\n    let prevBound = this._bound(0);\n    let prevIndex = 0;\n    let skip = false;\n    while (query.length !== 0) {\n      let o = new WrappedBuffer();\n      let doSkip = () => {\n        if (skip) {\n          skip = false;\n          o.extend(this.encodeBound(prevBound));\n          o.extend(encodeVarInt(Mode.Skip));\n        }\n      };\n      let currBound = this.decodeBound(query);\n      let mode = decodeVarInt(query);\n      let lower = prevIndex;\n      let upper = this.storage.findLowerBound(prevIndex, storageSize, currBound);\n      if (mode === Mode.Skip) {\n        skip = true;\n      } else if (mode === Mode.Fingerprint) {\n        let theirFingerprint = getBytes(query, FINGERPRINT_SIZE);\n        let ourFingerprint = this.storage.fingerprint(lower, upper);\n        if (compareUint8Array(theirFingerprint, ourFingerprint) !== 0) {\n          doSkip();\n          this.splitRange(lower, upper, currBound, o);\n        } else {\n          skip = true;\n        }\n      } else if (mode === Mode.IdList) {\n        let numIds = decodeVarInt(query);\n        let theirElems = {};\n        for (let i2 = 0; i2 < numIds; i2++) {\n          let e = getBytes(query, ID_SIZE);\n          theirElems[bytesToHex6(e)] = e;\n        }\n        skip = true;\n        this.storage.iterate(lower, upper, (item) => {\n          let k = item.id;\n          const id = bytesToHex6(k);\n          if (!theirElems[id]) {\n            onhave?.(id);\n          } else {\n            delete theirElems[bytesToHex6(k)];\n          }\n          return true;\n        });\n        if (onneed) {\n          for (let v of Object.values(theirElems)) {\n            onneed(bytesToHex6(v));\n          }\n        }\n      } else {\n        throw Error(\"unexpected mode\");\n      }\n      if (this.exceededFrameSizeLimit(fullOutput.length + o.length)) {\n        let remainingFingerprint = this.storage.fingerprint(upper, storageSize);\n        fullOutput.extend(this.encodeBound(this._bound(Number.MAX_VALUE)));\n        fullOutput.extend(encodeVarInt(Mode.Fingerprint));\n        fullOutput.extend(remainingFingerprint);\n        break;\n      } else {\n        fullOutput.extend(o);\n      }\n      prevIndex = upper;\n      prevBound = currBound;\n    }\n    return fullOutput.length === 1 ? null : bytesToHex6(fullOutput.unwrap());\n  }\n  splitRange(lower, upper, upperBound, o) {\n    let numElems = upper - lower;\n    let buckets = 16;\n    if (numElems < buckets * 2) {\n      o.extend(this.encodeBound(upperBound));\n      o.extend(encodeVarInt(Mode.IdList));\n      o.extend(encodeVarInt(numElems));\n      this.storage.iterate(lower, upper, (item) => {\n        o.extend(item.id);\n        return true;\n      });\n    } else {\n      let itemsPerBucket = Math.floor(numElems / buckets);\n      let bucketsWithExtra = numElems % buckets;\n      let curr = lower;\n      for (let i2 = 0; i2 < buckets; i2++) {\n        let bucketSize = itemsPerBucket + (i2 < bucketsWithExtra ? 1 : 0);\n        let ourFingerprint = this.storage.fingerprint(curr, curr + bucketSize);\n        curr += bucketSize;\n        let nextBound;\n        if (curr === upper) {\n          nextBound = upperBound;\n        } else {\n          let prevItem;\n          let currItem;\n          this.storage.iterate(curr - 1, curr + 1, (item, index) => {\n            if (index === curr - 1)\n              prevItem = item;\n            else\n              currItem = item;\n            return true;\n          });\n          nextBound = this.getMinimalBound(prevItem, currItem);\n        }\n        o.extend(this.encodeBound(nextBound));\n        o.extend(encodeVarInt(Mode.Fingerprint));\n        o.extend(ourFingerprint);\n      }\n    }\n  }\n  exceededFrameSizeLimit(n) {\n    return n > this.frameSizeLimit - 200;\n  }\n  decodeTimestampIn(encoded) {\n    let timestamp = decodeVarInt(encoded);\n    timestamp = timestamp === 0 ? Number.MAX_VALUE : timestamp - 1;\n    if (this.lastTimestampIn === Number.MAX_VALUE || timestamp === Number.MAX_VALUE) {\n      this.lastTimestampIn = Number.MAX_VALUE;\n      return Number.MAX_VALUE;\n    }\n    timestamp += this.lastTimestampIn;\n    this.lastTimestampIn = timestamp;\n    return timestamp;\n  }\n  decodeBound(encoded) {\n    let timestamp = this.decodeTimestampIn(encoded);\n    let len = decodeVarInt(encoded);\n    if (len > ID_SIZE)\n      throw Error(\"bound key too long\");\n    let id = getBytes(encoded, len);\n    return { timestamp, id };\n  }\n  encodeTimestampOut(timestamp) {\n    if (timestamp === Number.MAX_VALUE) {\n      this.lastTimestampOut = Number.MAX_VALUE;\n      return encodeVarInt(0);\n    }\n    let temp = timestamp;\n    timestamp -= this.lastTimestampOut;\n    this.lastTimestampOut = temp;\n    return encodeVarInt(timestamp + 1);\n  }\n  encodeBound(key) {\n    let output = new WrappedBuffer();\n    output.extend(this.encodeTimestampOut(key.timestamp));\n    output.extend(encodeVarInt(key.id.length));\n    output.extend(key.id);\n    return output;\n  }\n  getMinimalBound(prev, curr) {\n    if (curr.timestamp !== prev.timestamp) {\n      return this._bound(curr.timestamp);\n    } else {\n      let sharedPrefixBytes = 0;\n      let currKey = curr.id;\n      let prevKey = prev.id;\n      for (let i2 = 0; i2 < ID_SIZE; i2++) {\n        if (currKey[i2] !== prevKey[i2])\n          break;\n        sharedPrefixBytes++;\n      }\n      return this._bound(curr.timestamp, curr.id.subarray(0, sharedPrefixBytes + 1));\n    }\n  }\n};\nfunction compareUint8Array(a, b) {\n  for (let i2 = 0; i2 < a.byteLength; i2++) {\n    if (a[i2] < b[i2])\n      return -1;\n    if (a[i2] > b[i2])\n      return 1;\n  }\n  if (a.byteLength > b.byteLength)\n    return 1;\n  if (a.byteLength < b.byteLength)\n    return -1;\n  return 0;\n}\nfunction itemCompare(a, b) {\n  if (a.timestamp === b.timestamp) {\n    return compareUint8Array(a.id, b.id);\n  }\n  return a.timestamp - b.timestamp;\n}\nvar NegentropySync = class {\n  relay;\n  storage;\n  neg;\n  filter;\n  subscription;\n  onhave;\n  onneed;\n  constructor(relay, storage, filter, params = {}) {\n    this.relay = relay;\n    this.storage = storage;\n    this.neg = new Negentropy(storage);\n    this.onhave = params.onhave;\n    this.onneed = params.onneed;\n    this.filter = filter;\n    this.subscription = this.relay.prepareSubscription([{}], { label: params.label || \"negentropy\" });\n    this.subscription.oncustom = (data) => {\n      switch (data[0]) {\n        case \"NEG-MSG\": {\n          if (data.length < 3) {\n            console.warn(`got invalid NEG-MSG from ${this.relay.url}: ${data}`);\n          }\n          try {\n            const response = this.neg.reconcile(data[2], this.onhave, this.onneed);\n            if (response) {\n              this.relay.send(`[\"NEG-MSG\", \"${this.subscription.id}\", \"${response}\"]`);\n            } else {\n              this.close();\n              params.onclose?.();\n            }\n          } catch (error) {\n            console.error(\"negentropy reconcile error:\", error);\n            params?.onclose?.(`reconcile error: ${error}`);\n          }\n          break;\n        }\n        case \"NEG-CLOSE\": {\n          const reason = data[2];\n          console.warn(\"negentropy error:\", reason);\n          params.onclose?.(reason);\n          break;\n        }\n        case \"NEG-ERR\": {\n          params.onclose?.();\n        }\n      }\n    };\n  }\n  async start() {\n    const initMsg = this.neg.initiate();\n    this.relay.send(`[\"NEG-OPEN\",\"${this.subscription.id}\",${JSON.stringify(this.filter)},\"${initMsg}\"]`);\n  }\n  close() {\n    this.relay.send(`[\"NEG-CLOSE\",\"${this.subscription.id}\"]`);\n    this.subscription.close();\n  }\n};\n\n// nip98.ts\nvar nip98_exports = {};\n__export(nip98_exports, {\n  getToken: () => getToken,\n  hashPayload: () => hashPayload,\n  unpackEventFromToken: () => unpackEventFromToken,\n  validateEvent: () => validateEvent2,\n  validateEventKind: () => validateEventKind,\n  validateEventMethodTag: () => validateEventMethodTag,\n  validateEventPayloadTag: () => validateEventPayloadTag,\n  validateEventTimestamp: () => validateEventTimestamp,\n  validateEventUrlTag: () => validateEventUrlTag,\n  validateToken: () => validateToken\n});\nimport { sha256 as sha2565 } from \"@noble/hashes/sha256\";\nimport { bytesToHex as bytesToHex7 } from \"@noble/hashes/utils\";\nimport { base64 as base643 } from \"@scure/base\";\nvar _authorizationScheme = \"Nostr \";\nasync function getToken(loginUrl, httpMethod, sign, includeAuthorizationScheme = false, payload) {\n  const event = {\n    kind: HTTPAuth,\n    tags: [\n      [\"u\", loginUrl],\n      [\"method\", httpMethod]\n    ],\n    created_at: Math.round(new Date().getTime() / 1e3),\n    content: \"\"\n  };\n  if (payload) {\n    event.tags.push([\"payload\", hashPayload(payload)]);\n  }\n  const signedEvent = await sign(event);\n  const authorizationScheme = includeAuthorizationScheme ? _authorizationScheme : \"\";\n  return authorizationScheme + base643.encode(utf8Encoder.encode(JSON.stringify(signedEvent)));\n}\nasync function validateToken(token, url, method) {\n  const event = await unpackEventFromToken(token).catch((error) => {\n    throw error;\n  });\n  const valid = await validateEvent2(event, url, method).catch((error) => {\n    throw error;\n  });\n  return valid;\n}\nasync function unpackEventFromToken(token) {\n  if (!token) {\n    throw new Error(\"Missing token\");\n  }\n  token = token.replace(_authorizationScheme, \"\");\n  const eventB64 = utf8Decoder.decode(base643.decode(token));\n  if (!eventB64 || eventB64.length === 0 || !eventB64.startsWith(\"{\")) {\n    throw new Error(\"Invalid token\");\n  }\n  const event = JSON.parse(eventB64);\n  return event;\n}\nfunction validateEventTimestamp(event) {\n  if (!event.created_at) {\n    return false;\n  }\n  return Math.round(new Date().getTime() / 1e3) - event.created_at < 60;\n}\nfunction validateEventKind(event) {\n  return event.kind === HTTPAuth;\n}\nfunction validateEventUrlTag(event, url) {\n  const urlTag = event.tags.find((t) => t[0] === \"u\");\n  if (!urlTag) {\n    return false;\n  }\n  return urlTag.length > 0 && urlTag[1] === url;\n}\nfunction validateEventMethodTag(event, method) {\n  const methodTag = event.tags.find((t) => t[0] === \"method\");\n  if (!methodTag) {\n    return false;\n  }\n  return methodTag.length > 0 && methodTag[1].toLowerCase() === method.toLowerCase();\n}\nfunction hashPayload(payload) {\n  const hash = sha2565(utf8Encoder.encode(JSON.stringify(payload)));\n  return bytesToHex7(hash);\n}\nfunction validateEventPayloadTag(event, payload) {\n  const payloadTag = event.tags.find((t) => t[0] === \"payload\");\n  if (!payloadTag) {\n    return false;\n  }\n  const payloadHash = hashPayload(payload);\n  return payloadTag.length > 0 && payloadTag[1] === payloadHash;\n}\nasync function validateEvent2(event, url, method, body) {\n  if (!verifyEvent(event)) {\n    throw new Error(\"Invalid nostr event, signature invalid\");\n  }\n  if (!validateEventKind(event)) {\n    throw new Error(\"Invalid nostr event, kind invalid\");\n  }\n  if (!validateEventTimestamp(event)) {\n    throw new Error(\"Invalid nostr event, created_at timestamp invalid\");\n  }\n  if (!validateEventUrlTag(event, url)) {\n    throw new Error(\"Invalid nostr event, url tag invalid\");\n  }\n  if (!validateEventMethodTag(event, method)) {\n    throw new Error(\"Invalid nostr event, method tag invalid\");\n  }\n  if (Boolean(body) && typeof body === \"object\" && Object.keys(body).length > 0) {\n    if (!validateEventPayloadTag(event, body)) {\n      throw new Error(\"Invalid nostr event, payload tag does not match request body hash\");\n    }\n  }\n  return true;\n}\nexport {\n  Relay,\n  SimplePool,\n  finalizeEvent,\n  fakejson_exports as fj,\n  generateSecretKey,\n  getEventHash,\n  getFilterLimit,\n  getPublicKey,\n  kinds_exports as kinds,\n  matchFilter,\n  matchFilters,\n  mergeFilters,\n  nip04_exports as nip04,\n  nip05_exports as nip05,\n  nip10_exports as nip10,\n  nip11_exports as nip11,\n  nip13_exports as nip13,\n  nip17_exports as nip17,\n  nip18_exports as nip18,\n  nip19_exports as nip19,\n  nip21_exports as nip21,\n  nip25_exports as nip25,\n  nip27_exports as nip27,\n  nip28_exports as nip28,\n  nip30_exports as nip30,\n  nip39_exports as nip39,\n  nip42_exports as nip42,\n  nip44_exports as nip44,\n  nip47_exports as nip47,\n  nip54_exports as nip54,\n  nip57_exports as nip57,\n  nip59_exports as nip59,\n  nip77_exports as nip77,\n  nip98_exports as nip98,\n  parseReferences,\n  serializeEvent,\n  sortEvents,\n  utils_exports as utils,\n  validateEvent,\n  verifiedSymbol,\n  verifyEvent\n};\n"],"names":["ensure_array_like","array_like_or_iterator","destroy_block","block","lookup","update_keyed_each","old_blocks","dirty","get_key","dynamic","ctx","list","node","destroy","create_each_block","next","get_context","o","n","i","old_indexes","new_blocks","new_lookup","deltas","updates","child_ctx","key","will_move","did_move","insert","transition_in","new_block","old_block","new_key","old_key","run_all","number","bytes","b","lengths","hash","exists","instance","checkFinished","output","out","min","crypto","u8a","a","createView","arr","rotr","word","shift","isLE","utf8ToBytes","str","toBytes","data","concatBytes","arrays","r","sum","pad","Hash$1","wrapConstructor","hashCons","hashC","msg","tmp","randomBytes","bytesLength","setBigUint64","view","byteOffset","value","_32n","_u32_max","wh","wl","h","l","Hash","blockLen","outputLen","padOffset","buffer","len","pos","take","dataView","oview","outLen","state","res","to","length","finished","destroyed","Chi","c","Maj","SHA256_K","IV","SHA256_W","SHA2","A","B","C","D","E","F","G","H","offset","W15","W2","s0","s1","sigma1","T1","T2","sha256","SHA256","_0n","_1n","_2n","hexes","_","bytesToHex","hex","numberToHexUnpadded","num","hexToNumber","hexToBytes","array","j","hexByte","byte","bytesToNumberBE","bytesToNumberLE","numberToBytesBE","numberToBytesLE","numberToVarBytesBE","ensureBytes","title","expectedLength","e","equalBytes","b1","b2","bitLen","bitGet","bitSet","bitMask","u8n","u8fr","createHmacDrbg","hashLen","qByteLen","hmacFn","v","k","reset","reseed","seed","gen","sl","pred","validatorFns","val","object","validateObject","validators","optValidators","checkField","fieldName","type","isOptional","checkVal","_3n","_4n","_5n","_8n","mod","result","pow","power","modulo","pow2","x","invert","u","q","m","tonelliShanks","P","legendreC","Q","S","Z","p1div4","Fp","root","Q1div2","g","t2","ge","FpSqrt","c1","n2","nv","FIELD_FIELDS","validateField","field","initial","opts","map","FpPow","f","p","d","FpInvertBatch","nums","lastMultiplied","acc","inverted","nLength","nBitLength","_nBitLength","nByteLength","Field","ORDER","redef","BITS","BYTES","sqrtP","lhs","rhs","lst","getFieldBytesLength","fieldOrder","bitLength","getMinHashLength","mapHashToField","fieldLen","minLen","reduced","wNAF","bits","constTimeNegate","condition","item","neg","W","windows","windowSize","elm","points","base","window","precomputes","mask","maxNumber","shiftBy","wbits","offset1","offset2","cond1","cond2","precomputesMap","transform","comp","validateBasic","curve","validatePointOpts","ut.validateObject","endo","b2n","h2b","ut","DER","sBytes","rBytesLeft","sig","slice","s","shl","rhl","rl","weierstrassPoints","CURVE","_c","point","_isCompressed","ut.concatBytes","fromBytes","tail","y","weierstrassEquation","x2","x3","isWithinCurveOrder","assertGE","normPrivateKeyToScalar","wrapPrivateKey","ut.bytesToHex","ut.bytesToNumberBE","mod.mod","pointPrecomputes","assertPrjPoint","other","Point","px","py","pz","is0","toInv","privateKey","left","right","X1","Y1","Z1","X2","Y2","Z2","U1","U2","b3","X3","Y3","Z3","t0","t1","t3","t4","t5","wnaf","I","k1neg","k1","k2neg","k2","k1p","k2p","scalar","fake","f1p","f2p","mul","iz","z","ax","ay","zz","cofactor","isTorsionFree","clearCofactor","isCompressed","_bits","validateOpts","weierstrass","curveDef","CURVE_ORDER","compressedLen","uncompressedLen","isValidFieldElement","modN","invN","mod.invert","cat","head","y2","isYOdd","numToNByteStr","ut.numberToBytesBE","isBiggerThanHalfOrder","HALF","normalizeS","slcNum","from","Signature","recovery","msgHash","rec","bits2int_modN","radj","prefix","R","ir","u1","u2","ut.hexToBytes","utils","mod.getMinHashLength","mod.mapHashToField","getPublicKey","isProbPub","getSharedSecret","privateA","publicB","bits2int","delta","ORDER_MASK","ut.bitMask","int2octets","prepSig","defaultSigOpts","lowS","prehash","ent","h1int","seedArgs","k2sig","kBytes","ik","normS","defaultVerOpts","sign","privKey","ut.createHmacDrbg","verify","signature","publicKey","sg","_sig","derError","error","is","_key","assertHash","buf","assertExists","assertBytes","oHash","iHash","hmac","message","HMAC","getHash","msgs","createCurve","defHash","create","secp256k1P","secp256k1N","divNearest","sqrtMod","_6n","_11n","_22n","_23n","_44n","_88n","b6","b9","b11","b22","b44","b88","b176","b220","b223","secp256k1","a1","a2","POW_2_128","c2","fe","TAGGED_HASH_PREFIXES","taggedHash","tag","messages","tagP","tagH","pointToBytes","numTo32b","modP","GmulAdd","schnorrGetExtPubKey","priv","d_","lift_x","xx","challenge","args","schnorrGetPublicKey","schnorrSign","auxRand","t","rand","k_","rx","schnorrVerify","pub","schnorr","u32","isPlainObject","obj","checkOpts","defaults","bool","assert","SHA224","assertNumber","chain","wrap","encode","decode","alphabet","digits","input","letter","index","join","separator","padding","chr","end","normalize","fn","convertRadix","carry","done","digit","digitBase","gcd","radix2carry","convertRadix2","radix","radix2","revPadding","unsafeWrapper","base16","base32","base64","base64url","genBase58","abc","base58","XMR_BLOCK_LEN","base58xmr","BECH_ALPHABET","POLYMOD_GENERATORS","bech32Polymod","pre","chk","bechChecksum","words","encodingConst","genBech32","encoding","ENCODING_CONST","_words","fromWords","toWords","fromWordsUnsafe","limit","actualLength","lowered","sepIndex","decodeUnsafe","decodeToBytes","bech32","utf8","CODERS","isBytes","abytes","asciis","asciiToBase16","char","hl","al","ai","hi","n1","diff","wrapCipher","params","BLOCK_SIZE","POLY","mul2","sbox","box","invSbox","rotr32_8","rotl32_8","genTtable","T0","T3","T01","T23","sbox2","idx","tableEncoding","tableDecoding","xPowers","expandKeyLE","k32","Nk","subByte","applySbox","xk","expandKeyDecLE","encKey","w","apply0123","s2","s3","encrypt","rounds","decrypt","getDst","dst","validateBlockDecrypt","validateBlockEncrypt","plaintext","pcks5","remaining","validatePCKS","lastByte","padPCKS","tmp32","paddingByte","cbc","iv","_out","n32","ciphertext","ps0","ps1","ps2","ps3","o0","o1","o2","o3","u8to16","Poly1305","t6","t7","isLast","hibit","r0","r1","r2","r3","r4","r5","r6","r7","r8","r9","h0","h1","h2","h3","h4","h5","h6","h7","h8","h9","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","aexists","aoutput","opos","wrapConstructorWithKey","poly1305","_utf8ToBytes","sigma16","sigma32","sigma16_32","sigma32_32","rotl","isAligned32","BLOCK_LEN","BLOCK_LEN32","MAX_COUNTER","U32_EMPTY","runCipher","core","sigma","nonce","counter","b32","isAligned","d32","o32","pos32","posj","createCipher","allowShortKeys","extendNonceFn","counterLength","counterRight","anumber","abool","toClean","nonceNcLen","nc","chachaCore","cnt","y00","y01","y02","y03","y04","y05","y06","y07","y08","y09","y10","y11","y12","y13","y14","y15","x00","x01","x02","x03","x04","x05","x06","x07","x08","x09","x10","x11","x12","x13","x14","x15","oi","hchacha","chacha20","xchacha20","ZEROS16","updatePadded","ZEROS32","computeTag","AAD","authKey","_poly1305_aead","xorStream","plength","clength","passedTag","xchacha20poly1305","extract","ikm","salt","HKDF_COUNTER","EMPTY_BUFFER","expand","prk","info","blocks","okm","HMACTmp","T","__defProp","__export","target","all","name","verifiedSymbol","isRecord","validateEvent","event","i2","utils_exports","Queue","QueueNode","binarySearch","insertEventIntoAscendingList","insertEventIntoDescendingList","normalizeURL","utf8Decoder","utf8Encoder","url","sortedArray","found","compare","start","mid","cmp","newNode","target2","JS","secretKey","bytesToHex2","getEventHash","valid","serializeEvent","evt","eventHash","generateSecretKey","finalizeEvent","verifyEvent","kinds_exports","Application","BadgeAward","BadgeDefinition","BlockedRelaysList","BlossomServerList","BookmarkList","Bookmarksets","Calendar","CalendarEventRSVP","ChannelCreation","ChannelHideMessage","ChannelMessage","ChannelMetadata","ChannelMuteUser","ChatMessage","ClassifiedListing","ClientAuth","Comment","CommunitiesList","CommunityDefinition","CommunityPostApproval","Contacts","CreateOrUpdateProduct","CreateOrUpdateStall","Curationsets","Date2","DirectMessageRelaysList","DraftClassifiedListing","DraftLong","Emojisets","EncryptedDirectMessage","EventDeletion","FavoriteRelays","FileMessage","FileMetadata","FileServerPreference","Followsets","ForumThread","GenericRepost","Genericlists","GiftWrap","GroupMetadata","HTTPAuth","Handlerinformation","Handlerrecommendation","Highlights","InterestsList","Interestsets","JobFeedback","JobRequest","JobResult","Label","LightningPubRPC","LiveChatMessage","LiveEvent","LongFormArticle","Metadata","Mutelist","NWCWalletInfo","NWCWalletRequest","NWCWalletResponse","NormalVideo","NostrConnect","OpenTimestamps","Photo","Pinlist","Poll","PollResponse","PrivateDirectMessage","ProblemTracker","ProfileBadges","PublicChatsList","Reaction","RecommendRelay","RelayList","RelayReview","Relaysets","Report","Reporting","Repost","Seal","SearchRelaysList","ShortTextNote","ShortVideo","Time","UserEmojiList","UserStatuses","Voice","VoiceComment","Zap","ZapGoal","ZapRequest","classifyKind","isAddressableKind","isEphemeralKind","isKind","isRegularKind","isReplaceableKind","kind","kindAsArray","matchFilter","filter","tagName","values","matchFilters","filters","fakejson_exports","getHex64","getInt","getSubscriptionId","matchEventId","matchEventKind","matchEventPubkey","json","sliced","pstart","pend","id","pubkey","nip42_exports","makeAuthEvent","relayURL","_WebSocket","_WebSocket2","nip19_exports","BECH32_REGEX","Bech32MaxSize","NostrTypeGuard","decodeNostrURI","encodeBytes","naddrEncode","neventEncode","noteEncode","nprofileEncode","npubEncode","nsecEncode","integerToUint8Array","uint8Array","nip19code","code","tlv","parseTLV","bytesToHex3","rest","hexToBytes2","encodeBech32","profile","encodeTLV","kindArray","addr","entries","vs","entry","nip04_exports","text","privkey","bytesToHex4","normalizedKey","getNormalizedX","ctb64","ivb64","nip05_exports","NIP05_REGEX","isNip05","isValid","queryProfile","searchDomain","useFetchImplementation","_fetch","fetchImplementation","domain","query","fullname","match","nip05","nip10_exports","parse","maybeParent","maybeRoot","eTagEventId","eTagRelayUrl","eTagMarker","eTagAuthor","eventPointer","ref","author","nip11_exports","fetchRelayInformation","useFetchImplementation2","_fetch2","nip13_exports","fastEventHash","getPow","minePow","count","nibble","unsigned","difficulty","now2","bytesToHex5","sha2562","nip17_exports","unwrapEvent2","unwrapManyEvents2","wrapEvent2","wrapManyEvents2","nip59_exports","createRumor","createSeal","createWrap","unwrapEvent","unwrapManyEvents","wrapEvent","wrapManyEvents","nip44_exports","decrypt2","encrypt2","getConversationKey","v2","minPlaintextSize","maxPlaintextSize","privkeyA","pubkeyB","sharedX","secp256k12","hkdf_extract","sha2563","getMessageKeys","conversationKey","keys","hkdf_expand","calcPaddedLen","nextPower","chunk","writeU16BE","unpadded","unpaddedLen","suffix","concatBytes2","unpad","padded","hmacAad","aad","combined","decodePayload","payload","plen","base642","dlen","vers","randomBytes2","chacha_key","chacha_nonce","hmac_key","mac","calculatedMac","TWO_DAYS","now","randomNow","nip44ConversationKey","nip44Encrypt","nip44Decrypt","rumor","recipientPublicKey","seal","randomKey","senderPrivateKey","recipientsPublicKeys","senderPublicKey","wrappeds","recipientPrivateKey","unwrappedSeal","wrappedEvents","unwrappedEvents","createEvent","recipients","conversationTitle","replyTo","baseEvent","relayUrl","recipient","nip18_exports","finishRepostEvent","getRepostedEvent","getRepostedEventPointer","reposted","tags","lastETag","lastPTag","skipVerification","pointer","repostedEvent","nip21_exports","NOSTR_URI_REGEX","parse2","test","uri","nip25_exports","finishReactionEvent","getReactedEventPointer","reacted","inheritedTags","nip27_exports","parse3","noCharacter","noURLCharacter","MAX_HASHTAG_LENGTH","content","emojis","max","prevIndex","mainloop","prefixLen","emoji","nip28_exports","channelCreateEvent","channelHideMessageEvent","channelMessageEvent","channelMetadataEvent","channelMuteUserEvent","nip30_exports","EMOJI_SHORTCODE_REGEX","matchAll","regex","replaceAll","matches","shortcode","replacer","nip39_exports","useFetchImplementation3","validateGithub","_fetch3","username","proof","nip47_exports","makeNwcRequestEvent","parseConnectionString","connectionString","host","pathname","searchParams","relay","secret","invoice","encryptedContent","eventTemplate","nip54_exports","normalizeIdentifier","nip57_exports","getSatoshisAmountFromBolt11","getZapEndpoint","makeZapReceipt","makeZapRequest","useFetchImplementation4","validateZapRequest","_fetch4","metadata","lnurl","lud06","lud16","bech322","body","zr","zapRequestString","zapRequest","preimage","bolt11","paidAt","tagsFromZapRequest","zap","hrp","amount","isDigit","cutPoint","nip77_exports","Negentropy","NegentropyStorageVector","NegentropySync","PROTOCOL_VERSION","ID_SIZE","FINGERPRINT_SIZE","Mode","WrappedBuffer","targetSize","oldRaw","newCapacity","first","firstSubarray","decodeVarInt","encodeVarInt","getByte","getBytes","Accumulator","otherBuf","currCarry","nextCarry","po","orig","otherV","one","sha2564","timestamp","idb","hexToBytes3","itemCompare","begin","cb","bound","last","it","step","storage","frameSizeLimit","bytesToHex6","queryMsg","onhave","onneed","fullOutput","protocolVersion","storageSize","prevBound","skip","doSkip","currBound","mode","lower","upper","theirFingerprint","ourFingerprint","compareUint8Array","numIds","theirElems","remainingFingerprint","upperBound","numElems","buckets","itemsPerBucket","bucketsWithExtra","curr","bucketSize","nextBound","prevItem","currItem","encoded","temp","prev","sharedPrefixBytes","currKey","prevKey","response","reason","initMsg","nip98_exports","getToken","hashPayload","unpackEventFromToken","validateEvent2","validateEventKind","validateEventMethodTag","validateEventPayloadTag","validateEventTimestamp","validateEventUrlTag","validateToken","_authorizationScheme","loginUrl","httpMethod","includeAuthorizationScheme","signedEvent","base643","token","method","eventB64","urlTag","methodTag","sha2565","bytesToHex7","payloadTag","payloadHash"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]}