import{c as s,n as o,h as f,N as u}from"./QaGk0KJq.js";const d={CREATE:40};async function g(e){if(!f())throw new Error("No signer configured. Please login first.");await s();const c={name:e.name,about:e.description},t=new u(o);return t.kind=d.CREATE,t.content=JSON.stringify(c),e.visibility&&e.visibility!=="public"&&t.tags.push(["visibility",e.visibility]),e.cohorts&&e.cohorts.length>0&&t.tags.push(["cohort",e.cohorts.join(",")]),e.encrypted&&t.tags.push(["encrypted","true"]),await t.sign(),await t.publish(),console.log("Channel created:",t.id),{id:t.id,name:e.name,description:e.description,visibility:e.visibility||"public",cohorts:e.cohorts||[],encrypted:e.encrypted||!1,createdAt:t.created_at||Math.floor(Date.now()/1e3),creatorPubkey:t.pubkey}}async function v(e=100){await s();const c={kinds:[d.CREATE],limit:e},t=await o.fetchEvents(c),r=[];for(const a of t)try{const i=JSON.parse(a.content),l=a.tags.find(n=>n[0]==="visibility"),h=a.tags.find(n=>n[0]==="cohort"),y=a.tags.find(n=>n[0]==="encrypted");r.push({id:a.id,name:i.name||"Unnamed Channel",description:i.about,visibility:l?.[1]||"public",cohorts:h?.[1]?.split(",").filter(Boolean)||[],encrypted:y?.[1]==="true",createdAt:a.created_at||0,creatorPubkey:a.pubkey})}catch(i){console.error("Failed to parse channel event:",i)}return r.sort((a,i)=>i.createdAt-a.createdAt),r}export{g as c,v as f};
//# sourceMappingURL=SG5lmA__.js.map
