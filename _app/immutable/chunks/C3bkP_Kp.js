import{a as Po}from"./BuTC0y2q.js";import{w as qo}from"./B7P-bQO9.js";function el(t){return t?.length!==void 0?t:Array.from(t)}function nl(t,e){t.d(1),e.delete(t.key)}function rl(t,e,n,r,o,i,s,a,c,f,l,u){let g=t.length,y=i.length,p=g;const h={};for(;p--;)h[t[p].key]=p;const d=[],w=new Map,m=new Map,A=[];for(p=y;p--;){const v=u(o,i,p),B=n(v);let N=s.get(B);N?A.push(()=>N.p(v,e)):(N=f(B,v),N.c()),w.set(B,d[p]=N),B in h&&m.set(B,Math.abs(p-h[B]))}const I=new Set,k=new Set;function _(v){Po(v,1),v.m(a,l),s.set(v.key,v),l=v.first,y--}for(;g&&y;){const v=d[y-1],B=t[g-1],N=v.key,U=B.key;v===B?(l=v.first,g--,y--):w.has(U)?!s.has(N)||I.has(N)?_(v):k.has(U)?g--:m.get(N)>m.get(U)?(k.add(N),_(v)):(I.add(U),g--):(c(B,s),g--)}for(;g--;){const v=t[g];w.has(v.key)||c(v,s)}for(;y;)_(d[y-1]);return qo(A),d}function Tn(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function er(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function Vo(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Tn(t.outputLen),Tn(t.blockLen)}function ne(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function zo(t,e){er(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const xe=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const nr=t=>t instanceof Uint8Array,Ee=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),at=(t,e)=>t<<32-e|t>>>e,jo=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!jo)throw new Error("Non little-endian hardware is not supported");function Do(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Ke(t){if(typeof t=="string"&&(t=Do(t)),!nr(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function Fo(...t){const e=new Uint8Array(t.reduce((r,o)=>r+o.length,0));let n=0;return t.forEach(r=>{if(!nr(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}let rr=class{clone(){return this._cloneInto()}};function Ko(t){const e=r=>t().update(Ke(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function or(t=32){if(xe&&typeof xe.getRandomValues=="function")return xe.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Go(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,f=r?0:4;t.setUint32(e+c,s,r),t.setUint32(e+f,a,r)}let Wo=class extends rr{constructor(e,n,r,o){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Ee(this.buffer)}update(e){ne(this);const{view:n,buffer:r,blockLen:o}=this;e=Ke(e);const i=e.length;for(let s=0;s<i;){const a=Math.min(o-this.pos,i-s);if(a===o){const c=Ee(e);for(;o<=i-s;s+=o)this.process(c,s);continue}r.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ne(this),zo(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:i}=this;let{pos:s}=this;n[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>o-s&&(this.process(r,0),s=0);for(let u=s;u<o;u++)n[u]=0;Go(r,o-8,BigInt(this.length*8),i),this.process(r,0);const a=Ee(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=c/4,l=this.get();if(f>l.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<f;u++)a.setUint32(4*u,l[u],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:i,destroyed:s,pos:a}=this;return e.length=o,e.pos=a,e.finished=i,e.destroyed=s,o%n&&e.buffer.set(r),e}};const Zo=(t,e,n)=>t&e^~t&n,Xo=(t,e,n)=>t&e^t&n^e&n,Jo=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Et=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),vt=new Uint32Array(64);let Yo=class extends Wo{constructor(){super(64,32,8,!1),this.A=Et[0]|0,this.B=Et[1]|0,this.C=Et[2]|0,this.D=Et[3]|0,this.E=Et[4]|0,this.F=Et[5]|0,this.G=Et[6]|0,this.H=Et[7]|0}get(){const{A:e,B:n,C:r,D:o,E:i,F:s,G:a,H:c}=this;return[e,n,r,o,i,s,a,c]}set(e,n,r,o,i,s,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=i|0,this.F=s|0,this.G=a|0,this.H=c|0}process(e,n){for(let u=0;u<16;u++,n+=4)vt[u]=e.getUint32(n,!1);for(let u=16;u<64;u++){const g=vt[u-15],y=vt[u-2],p=at(g,7)^at(g,18)^g>>>3,h=at(y,17)^at(y,19)^y>>>10;vt[u]=h+vt[u-7]+p+vt[u-16]|0}let{A:r,B:o,C:i,D:s,E:a,F:c,G:f,H:l}=this;for(let u=0;u<64;u++){const g=at(a,6)^at(a,11)^at(a,25),y=l+g+Zo(a,c,f)+Jo[u]+vt[u]|0,h=(at(r,2)^at(r,13)^at(r,22))+Xo(r,o,i)|0;l=f,f=c,c=a,a=s+y|0,s=i,i=o,o=r,r=y+h|0}r=r+this.A|0,o=o+this.B|0,i=i+this.C|0,s=s+this.D|0,a=a+this.E|0,c=c+this.F|0,f=f+this.G|0,l=l+this.H|0,this.set(r,o,i,s,a,c,f,l)}roundClean(){vt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const Ne=Ko(()=>new Yo);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ir=BigInt(0),ce=BigInt(1),Qo=BigInt(2),fe=t=>t instanceof Uint8Array,ti=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Vt(t){if(!fe(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=ti[t[n]];return e}function sr(t){const e=t.toString(16);return e.length&1?`0${e}`:e}function Ge(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function zt(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let r=0;r<n.length;r++){const o=r*2,i=t.slice(o,o+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");n[r]=s}return n}function Q(t){return Ge(Vt(t))}function We(t){if(!fe(t))throw new Error("Uint8Array expected");return Ge(Vt(Uint8Array.from(t).reverse()))}function Lt(t,e){return zt(t.toString(16).padStart(e*2,"0"))}function Ze(t,e){return Lt(t,e).reverse()}function ei(t){return zt(sr(t))}function K(t,e,n){let r;if(typeof e=="string")try{r=zt(e)}catch(i){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${i}`)}else if(fe(e))r=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const o=r.length;if(typeof n=="number"&&o!==n)throw new Error(`${t} expected ${n} bytes, got ${o}`);return r}function kt(...t){const e=new Uint8Array(t.reduce((r,o)=>r+o.length,0));let n=0;return t.forEach(r=>{if(!fe(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}function ni(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function ri(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function oi(t){let e;for(e=0;t>ir;t>>=ce,e+=1);return e}function ii(t,e){return t>>BigInt(e)&ce}const si=(t,e,n)=>t|(n?ce:ir)<<BigInt(e),Xe=t=>(Qo<<BigInt(t-1))-ce,ve=t=>new Uint8Array(t),kn=t=>Uint8Array.from(t);function ar(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=ve(t),o=ve(t),i=0;const s=()=>{r.fill(1),o.fill(0),i=0},a=(...u)=>n(o,r,...u),c=(u=ve())=>{o=a(kn([0]),u),r=a(),u.length!==0&&(o=a(kn([1]),u),r=a())},f=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let u=0;const g=[];for(;u<e;){r=a();const y=r.slice();g.push(y),u+=r.length}return kt(...g)};return(u,g)=>{s(),c(u);let y;for(;!(y=g(f()));)c();return s(),y}}const ai={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Xt(t,e,n={}){const r=(o,i,s)=>{const a=ai[i];if(typeof a!="function")throw new Error(`Invalid validator "${i}", expected function`);const c=t[o];if(!(s&&c===void 0)&&!a(c,t))throw new Error(`Invalid param ${String(o)}=${c} (${typeof c}), expected ${i}`)};for(const[o,i]of Object.entries(e))r(o,i,!1);for(const[o,i]of Object.entries(n))r(o,i,!0);return t}const ci=Object.freeze(Object.defineProperty({__proto__:null,bitGet:ii,bitLen:oi,bitMask:Xe,bitSet:si,bytesToHex:Vt,bytesToNumberBE:Q,bytesToNumberLE:We,concatBytes:kt,createHmacDrbg:ar,ensureBytes:K,equalBytes:ni,hexToBytes:zt,hexToNumber:Ge,numberToBytesBE:Lt,numberToBytesLE:Ze,numberToHexUnpadded:sr,numberToVarBytesBE:ei,utf8ToBytes:ri,validateObject:Xt},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const j=BigInt(0),V=BigInt(1),$t=BigInt(2),fi=BigInt(3),Re=BigInt(4),Nn=BigInt(5),Rn=BigInt(8);BigInt(9);BigInt(16);function F(t,e){const n=t%e;return n>=j?n:e+n}function li(t,e,n){if(n<=j||e<j)throw new Error("Expected power/modulo > 0");if(n===V)return j;let r=V;for(;e>j;)e&V&&(r=r*t%n),t=t*t%n,e>>=V;return r}function nt(t,e,n){let r=t;for(;e-- >j;)r*=r,r%=n;return r}function Oe(t,e){if(t===j||e<=j)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=F(t,e),r=e,o=j,i=V;for(;n!==j;){const a=r/n,c=r%n,f=o-i*a;r=n,n=c,o=i,i=f}if(r!==V)throw new Error("invert: does not exist");return F(o,e)}function ui(t){const e=(t-V)/$t;let n,r,o;for(n=t-V,r=0;n%$t===j;n/=$t,r++);for(o=$t;o<t&&li(o,e,t)!==t-V;o++);if(r===1){const s=(t+V)/Re;return function(c,f){const l=c.pow(f,s);if(!c.eql(c.sqr(l),f))throw new Error("Cannot find square root");return l}}const i=(n+V)/$t;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let f=r,l=a.pow(a.mul(a.ONE,o),n),u=a.pow(c,i),g=a.pow(c,n);for(;!a.eql(g,a.ONE);){if(a.eql(g,a.ZERO))return a.ZERO;let y=1;for(let h=a.sqr(g);y<f&&!a.eql(h,a.ONE);y++)h=a.sqr(h);const p=a.pow(l,V<<BigInt(f-y-1));l=a.sqr(p),u=a.mul(u,p),g=a.mul(g,l),f=y}return u}}function hi(t){if(t%Re===fi){const e=(t+V)/Re;return function(r,o){const i=r.pow(o,e);if(!r.eql(r.sqr(i),o))throw new Error("Cannot find square root");return i}}if(t%Rn===Nn){const e=(t-Nn)/Rn;return function(r,o){const i=r.mul(o,$t),s=r.pow(i,e),a=r.mul(o,s),c=r.mul(r.mul(a,$t),s),f=r.mul(a,r.sub(c,r.ONE));if(!r.eql(r.sqr(f),o))throw new Error("Cannot find square root");return f}}return ui(t)}const di=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function pi(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=di.reduce((r,o)=>(r[o]="function",r),e);return Xt(t,n)}function gi(t,e,n){if(n<j)throw new Error("Expected power > 0");if(n===j)return t.ONE;if(n===V)return e;let r=t.ONE,o=e;for(;n>j;)n&V&&(r=t.mul(r,o)),o=t.sqr(o),n>>=V;return r}function yi(t,e){const n=new Array(e.length),r=e.reduce((i,s,a)=>t.is0(s)?i:(n[a]=i,t.mul(i,s)),t.ONE),o=t.inv(r);return e.reduceRight((i,s,a)=>t.is0(s)?i:(n[a]=t.mul(i,n[a]),t.mul(i,s)),o),n}function cr(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function wi(t,e,n=!1,r={}){if(t<=j)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:o,nByteLength:i}=cr(t,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=hi(t),a=Object.freeze({ORDER:t,BITS:o,BYTES:i,MASK:Xe(o),ZERO:j,ONE:V,create:c=>F(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return j<=c&&c<t},is0:c=>c===j,isOdd:c=>(c&V)===V,neg:c=>F(-c,t),eql:(c,f)=>c===f,sqr:c=>F(c*c,t),add:(c,f)=>F(c+f,t),sub:(c,f)=>F(c-f,t),mul:(c,f)=>F(c*f,t),pow:(c,f)=>gi(a,c,f),div:(c,f)=>F(c*Oe(f,t),t),sqrN:c=>c*c,addN:(c,f)=>c+f,subN:(c,f)=>c-f,mulN:(c,f)=>c*f,inv:c=>Oe(c,t),sqrt:r.sqrt||(c=>s(a,c)),invertBatch:c=>yi(a,c),cmov:(c,f,l)=>l?f:c,toBytes:c=>n?Ze(c,i):Lt(c,i),fromBytes:c=>{if(c.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${c.length}`);return n?We(c):Q(c)}});return Object.freeze(a)}function fr(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function lr(t){const e=fr(t);return e+Math.ceil(e/2)}function bi(t,e,n=!1){const r=t.length,o=fr(e),i=lr(e);if(r<16||r<i||r>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${r}`);const s=n?Q(t):We(t),a=F(s,e-V)+V;return n?Ze(a,o):Lt(a,o)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const mi=BigInt(0),Ae=BigInt(1);function xi(t,e){const n=(o,i)=>{const s=i.negate();return o?s:i},r=o=>{const i=Math.ceil(e/o)+1,s=2**(o-1);return{windows:i,windowSize:s}};return{constTimeNegate:n,unsafeLadder(o,i){let s=t.ZERO,a=o;for(;i>mi;)i&Ae&&(s=s.add(a)),a=a.double(),i>>=Ae;return s},precomputeWindow(o,i){const{windows:s,windowSize:a}=r(i),c=[];let f=o,l=f;for(let u=0;u<s;u++){l=f,c.push(l);for(let g=1;g<a;g++)l=l.add(f),c.push(l);f=l.double()}return c},wNAF(o,i,s){const{windows:a,windowSize:c}=r(o);let f=t.ZERO,l=t.BASE;const u=BigInt(2**o-1),g=2**o,y=BigInt(o);for(let p=0;p<a;p++){const h=p*c;let d=Number(s&u);s>>=y,d>c&&(d-=g,s+=Ae);const w=h,m=h+Math.abs(d)-1,A=p%2!==0,I=d<0;d===0?l=l.add(n(A,i[w])):f=f.add(n(I,i[m]))}return{p:f,f:l}},wNAFCached(o,i,s,a){const c=o._WINDOW_SIZE||1;let f=i.get(o);return f||(f=this.precomputeWindow(o,c),c!==1&&i.set(o,a(f))),this.wNAF(c,f,s)}}}function ur(t){return pi(t.Fp),Xt(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...cr(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Ei(t){const e=ur(t);Xt(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:o}=e;if(n){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:vi,hexToBytes:Ai}=ci,Tt={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){const{Err:e}=Tt;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");const n=t[1],r=t.subarray(2,n+2);if(!n||r.length!==n)throw new e("Invalid signature integer: wrong length");if(r[0]&128)throw new e("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:vi(r),l:t.subarray(n+2)}},toSig(t){const{Err:e}=Tt,n=typeof t=="string"?Ai(t):t;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||n[0]!=48)throw new e("Invalid signature tag");if(n[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:o,l:i}=Tt._parseInt(n.subarray(2)),{d:s,l:a}=Tt._parseInt(i);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:o,s}},hexFromSig(t){const e=f=>Number.parseInt(f[0],16)&8?"00"+f:f,n=f=>{const l=f.toString(16);return l.length&1?`0${l}`:l},r=e(n(t.s)),o=e(n(t.r)),i=r.length/2,s=o.length/2,a=n(i),c=n(s);return`30${n(s+i+4)}02${c}${o}02${a}${r}`}},pt=BigInt(0),rt=BigInt(1);BigInt(2);const On=BigInt(3);BigInt(4);function _i(t){const e=Ei(t),{Fp:n}=e,r=e.toBytes||((p,h,d)=>{const w=h.toAffine();return kt(Uint8Array.from([4]),n.toBytes(w.x),n.toBytes(w.y))}),o=e.fromBytes||(p=>{const h=p.subarray(1),d=n.fromBytes(h.subarray(0,n.BYTES)),w=n.fromBytes(h.subarray(n.BYTES,2*n.BYTES));return{x:d,y:w}});function i(p){const{a:h,b:d}=e,w=n.sqr(p),m=n.mul(w,p);return n.add(n.add(m,n.mul(p,h)),d)}if(!n.eql(n.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function s(p){return typeof p=="bigint"&&pt<p&&p<e.n}function a(p){if(!s(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(p){const{allowedPrivateKeyLengths:h,nByteLength:d,wrapPrivateKey:w,n:m}=e;if(h&&typeof p!="bigint"){if(p instanceof Uint8Array&&(p=Vt(p)),typeof p!="string"||!h.includes(p.length))throw new Error("Invalid key");p=p.padStart(d*2,"0")}let A;try{A=typeof p=="bigint"?p:Q(K("private key",p,d))}catch{throw new Error(`private key must be ${d} bytes, hex or bigint, not ${typeof p}`)}return w&&(A=F(A,m)),a(A),A}const f=new Map;function l(p){if(!(p instanceof u))throw new Error("ProjectivePoint expected")}class u{constructor(h,d,w){if(this.px=h,this.py=d,this.pz=w,h==null||!n.isValid(h))throw new Error("x required");if(d==null||!n.isValid(d))throw new Error("y required");if(w==null||!n.isValid(w))throw new Error("z required")}static fromAffine(h){const{x:d,y:w}=h||{};if(!h||!n.isValid(d)||!n.isValid(w))throw new Error("invalid affine point");if(h instanceof u)throw new Error("projective point not allowed");const m=A=>n.eql(A,n.ZERO);return m(d)&&m(w)?u.ZERO:new u(d,w,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(h){const d=n.invertBatch(h.map(w=>w.pz));return h.map((w,m)=>w.toAffine(d[m])).map(u.fromAffine)}static fromHex(h){const d=u.fromAffine(o(K("pointHex",h)));return d.assertValidity(),d}static fromPrivateKey(h){return u.BASE.multiply(c(h))}_setWindowSize(h){this._WINDOW_SIZE=h,f.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:h,y:d}=this.toAffine();if(!n.isValid(h)||!n.isValid(d))throw new Error("bad point: x or y not FE");const w=n.sqr(d),m=i(h);if(!n.eql(w,m))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:h}=this.toAffine();if(n.isOdd)return!n.isOdd(h);throw new Error("Field doesn't support isOdd")}equals(h){l(h);const{px:d,py:w,pz:m}=this,{px:A,py:I,pz:k}=h,_=n.eql(n.mul(d,k),n.mul(A,m)),v=n.eql(n.mul(w,k),n.mul(I,m));return _&&v}negate(){return new u(this.px,n.neg(this.py),this.pz)}double(){const{a:h,b:d}=e,w=n.mul(d,On),{px:m,py:A,pz:I}=this;let k=n.ZERO,_=n.ZERO,v=n.ZERO,B=n.mul(m,m),N=n.mul(A,A),U=n.mul(I,I),$=n.mul(m,A);return $=n.add($,$),v=n.mul(m,I),v=n.add(v,v),k=n.mul(h,v),_=n.mul(w,U),_=n.add(k,_),k=n.sub(N,_),_=n.add(N,_),_=n.mul(k,_),k=n.mul($,k),v=n.mul(w,v),U=n.mul(h,U),$=n.sub(B,U),$=n.mul(h,$),$=n.add($,v),v=n.add(B,B),B=n.add(v,B),B=n.add(B,U),B=n.mul(B,$),_=n.add(_,B),U=n.mul(A,I),U=n.add(U,U),B=n.mul(U,$),k=n.sub(k,B),v=n.mul(U,N),v=n.add(v,v),v=n.add(v,v),new u(k,_,v)}add(h){l(h);const{px:d,py:w,pz:m}=this,{px:A,py:I,pz:k}=h;let _=n.ZERO,v=n.ZERO,B=n.ZERO;const N=e.a,U=n.mul(e.b,On);let $=n.mul(d,A),O=n.mul(w,I),C=n.mul(m,k),P=n.add(d,w),b=n.add(A,I);P=n.mul(P,b),b=n.add($,O),P=n.sub(P,b),b=n.add(d,m);let x=n.add(A,k);return b=n.mul(b,x),x=n.add($,C),b=n.sub(b,x),x=n.add(w,m),_=n.add(I,k),x=n.mul(x,_),_=n.add(O,C),x=n.sub(x,_),B=n.mul(N,b),_=n.mul(U,C),B=n.add(_,B),_=n.sub(O,B),B=n.add(O,B),v=n.mul(_,B),O=n.add($,$),O=n.add(O,$),C=n.mul(N,C),b=n.mul(U,b),O=n.add(O,C),C=n.sub($,C),C=n.mul(N,C),b=n.add(b,C),$=n.mul(O,b),v=n.add(v,$),$=n.mul(x,b),_=n.mul(P,_),_=n.sub(_,$),$=n.mul(P,O),B=n.mul(x,B),B=n.add(B,$),new u(_,v,B)}subtract(h){return this.add(h.negate())}is0(){return this.equals(u.ZERO)}wNAF(h){return y.wNAFCached(this,f,h,d=>{const w=n.invertBatch(d.map(m=>m.pz));return d.map((m,A)=>m.toAffine(w[A])).map(u.fromAffine)})}multiplyUnsafe(h){const d=u.ZERO;if(h===pt)return d;if(a(h),h===rt)return this;const{endo:w}=e;if(!w)return y.unsafeLadder(this,h);let{k1neg:m,k1:A,k2neg:I,k2:k}=w.splitScalar(h),_=d,v=d,B=this;for(;A>pt||k>pt;)A&rt&&(_=_.add(B)),k&rt&&(v=v.add(B)),B=B.double(),A>>=rt,k>>=rt;return m&&(_=_.negate()),I&&(v=v.negate()),v=new u(n.mul(v.px,w.beta),v.py,v.pz),_.add(v)}multiply(h){a(h);let d=h,w,m;const{endo:A}=e;if(A){const{k1neg:I,k1:k,k2neg:_,k2:v}=A.splitScalar(d);let{p:B,f:N}=this.wNAF(k),{p:U,f:$}=this.wNAF(v);B=y.constTimeNegate(I,B),U=y.constTimeNegate(_,U),U=new u(n.mul(U.px,A.beta),U.py,U.pz),w=B.add(U),m=N.add($)}else{const{p:I,f:k}=this.wNAF(d);w=I,m=k}return u.normalizeZ([w,m])[0]}multiplyAndAddUnsafe(h,d,w){const m=u.BASE,A=(k,_)=>_===pt||_===rt||!k.equals(m)?k.multiplyUnsafe(_):k.multiply(_),I=A(this,d).add(A(h,w));return I.is0()?void 0:I}toAffine(h){const{px:d,py:w,pz:m}=this,A=this.is0();h==null&&(h=A?n.ONE:n.inv(m));const I=n.mul(d,h),k=n.mul(w,h),_=n.mul(m,h);if(A)return{x:n.ZERO,y:n.ZERO};if(!n.eql(_,n.ONE))throw new Error("invZ was invalid");return{x:I,y:k}}isTorsionFree(){const{h,isTorsionFree:d}=e;if(h===rt)return!0;if(d)return d(u,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h,clearCofactor:d}=e;return h===rt?this:d?d(u,this):this.multiplyUnsafe(e.h)}toRawBytes(h=!0){return this.assertValidity(),r(u,this,h)}toHex(h=!0){return Vt(this.toRawBytes(h))}}u.BASE=new u(e.Gx,e.Gy,n.ONE),u.ZERO=new u(n.ZERO,n.ONE,n.ZERO);const g=e.nBitLength,y=xi(u,e.endo?Math.ceil(g/2):g);return{CURVE:e,ProjectivePoint:u,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:s}}function Bi(t){const e=ur(t);return Xt(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function Si(t){const e=Bi(t),{Fp:n,n:r}=e,o=n.BYTES+1,i=2*n.BYTES+1;function s(b){return pt<b&&b<n.ORDER}function a(b){return F(b,r)}function c(b){return Oe(b,r)}const{ProjectivePoint:f,normPrivateKeyToScalar:l,weierstrassEquation:u,isWithinCurveOrder:g}=_i({...e,toBytes(b,x,L){const T=x.toAffine(),E=n.toBytes(T.x),R=kt;return L?R(Uint8Array.from([x.hasEvenY()?2:3]),E):R(Uint8Array.from([4]),E,n.toBytes(T.y))},fromBytes(b){const x=b.length,L=b[0],T=b.subarray(1);if(x===o&&(L===2||L===3)){const E=Q(T);if(!s(E))throw new Error("Point is not on curve");const R=u(E);let M=n.sqrt(R);const H=(M&rt)===rt;return(L&1)===1!==H&&(M=n.neg(M)),{x:E,y:M}}else if(x===i&&L===4){const E=n.fromBytes(T.subarray(0,n.BYTES)),R=n.fromBytes(T.subarray(n.BYTES,2*n.BYTES));return{x:E,y:R}}else throw new Error(`Point of length ${x} was invalid. Expected ${o} compressed bytes or ${i} uncompressed bytes`)}}),y=b=>Vt(Lt(b,e.nByteLength));function p(b){const x=r>>rt;return b>x}function h(b){return p(b)?a(-b):b}const d=(b,x,L)=>Q(b.slice(x,L));class w{constructor(x,L,T){this.r=x,this.s=L,this.recovery=T,this.assertValidity()}static fromCompact(x){const L=e.nByteLength;return x=K("compactSignature",x,L*2),new w(d(x,0,L),d(x,L,2*L))}static fromDER(x){const{r:L,s:T}=Tt.toSig(K("DER",x));return new w(L,T)}assertValidity(){if(!g(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!g(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(x){return new w(this.r,this.s,x)}recoverPublicKey(x){const{r:L,s:T,recovery:E}=this,R=v(K("msgHash",x));if(E==null||![0,1,2,3].includes(E))throw new Error("recovery id invalid");const M=E===2||E===3?L+e.n:L;if(M>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const H=E&1?"03":"02",z=f.fromHex(H+y(M)),X=c(M),tt=a(-R*X),et=a(T*X),J=f.BASE.multiplyAndAddUnsafe(z,tt,et);if(!J)throw new Error("point at infinify");return J.assertValidity(),J}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new w(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return zt(this.toDERHex())}toDERHex(){return Tt.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return zt(this.toCompactHex())}toCompactHex(){return y(this.r)+y(this.s)}}const m={isValidPrivateKey(b){try{return l(b),!0}catch{return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{const b=lr(e.n);return bi(e.randomBytes(b),e.n)},precompute(b=8,x=f.BASE){return x._setWindowSize(b),x.multiply(BigInt(3)),x}};function A(b,x=!0){return f.fromPrivateKey(b).toRawBytes(x)}function I(b){const x=b instanceof Uint8Array,L=typeof b=="string",T=(x||L)&&b.length;return x?T===o||T===i:L?T===2*o||T===2*i:b instanceof f}function k(b,x,L=!0){if(I(b))throw new Error("first arg must be private key");if(!I(x))throw new Error("second arg must be public key");return f.fromHex(x).multiply(l(b)).toRawBytes(L)}const _=e.bits2int||function(b){const x=Q(b),L=b.length*8-e.nBitLength;return L>0?x>>BigInt(L):x},v=e.bits2int_modN||function(b){return a(_(b))},B=Xe(e.nBitLength);function N(b){if(typeof b!="bigint")throw new Error("bigint expected");if(!(pt<=b&&b<B))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Lt(b,e.nByteLength)}function U(b,x,L=$){if(["recovered","canonical"].some(Y=>Y in L))throw new Error("sign() legacy options not supported");const{hash:T,randomBytes:E}=e;let{lowS:R,prehash:M,extraEntropy:H}=L;R==null&&(R=!0),b=K("msgHash",b),M&&(b=K("prehashed msgHash",T(b)));const z=v(b),X=l(x),tt=[N(X),N(z)];if(H!=null){const Y=H===!0?E(n.BYTES):H;tt.push(K("extraEntropy",Y))}const et=kt(...tt),J=z;function it(Y){const Ot=_(Y);if(!g(Ot))return;const In=c(Ot),st=f.BASE.multiply(Ot).toAffine(),Ct=a(st.x);if(Ct===pt)return;const Jt=a(In*a(J+Ct*X));if(Jt===pt)return;let Un=(st.x===Ct?0:2)|Number(st.y&rt),$n=Jt;return R&&p(Jt)&&($n=h(Jt),Un^=1),new w(Ct,$n,Un)}return{seed:et,k2sig:it}}const $={lowS:e.lowS,prehash:!1},O={lowS:e.lowS,prehash:!1};function C(b,x,L=$){const{seed:T,k2sig:E}=U(b,x,L),R=e;return ar(R.hash.outputLen,R.nByteLength,R.hmac)(T,E)}f.BASE._setWindowSize(8);function P(b,x,L,T=O){const E=b;if(x=K("msgHash",x),L=K("publicKey",L),"strict"in T)throw new Error("options.strict was renamed to lowS");const{lowS:R,prehash:M}=T;let H,z;try{if(typeof E=="string"||E instanceof Uint8Array)try{H=w.fromDER(E)}catch(st){if(!(st instanceof Tt.Err))throw st;H=w.fromCompact(E)}else if(typeof E=="object"&&typeof E.r=="bigint"&&typeof E.s=="bigint"){const{r:st,s:Ct}=E;H=new w(st,Ct)}else throw new Error("PARSE");z=f.fromHex(L)}catch(st){if(st.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(R&&H.hasHighS())return!1;M&&(x=e.hash(x));const{r:X,s:tt}=H,et=v(x),J=c(tt),it=a(et*J),Y=a(X*J),Ot=f.BASE.multiplyAndAddUnsafe(z,it,Y)?.toAffine();return Ot?a(Ot.x)===X:!1}return{CURVE:e,getPublicKey:A,getSharedSecret:k,sign:C,verify:P,ProjectivePoint:f,Signature:w,utils:m}}let hr=class extends rr{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,Vo(e);const r=Ke(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,i=new Uint8Array(o);i.set(r.length>o?e.create().update(r).digest():r);for(let s=0;s<i.length;s++)i[s]^=54;this.iHash.update(i),this.oHash=e.create();for(let s=0;s<i.length;s++)i[s]^=106;this.oHash.update(i),i.fill(0)}update(e){return ne(this),this.iHash.update(e),this}digestInto(e){ne(this),er(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:o,destroyed:i,blockLen:s,outputLen:a}=this;return e=e,e.finished=o,e.destroyed=i,e.blockLen=s,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const dr=(t,e,n)=>new hr(t,e).update(n).digest();dr.create=(t,e)=>new hr(t,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Li(t){return{hash:t,hmac:(e,...n)=>dr(t,e,Fo(...n)),randomBytes:or}}function Ii(t,e){const n=r=>Si({...t,...Li(r)});return Object.freeze({...n(e),create:n})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const le=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),re=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),pr=BigInt(1),oe=BigInt(2),Cn=(t,e)=>(t+e/oe)/e;function gr(t){const e=le,n=BigInt(3),r=BigInt(6),o=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),f=t*t*t%e,l=f*f*t%e,u=nt(l,n,e)*l%e,g=nt(u,n,e)*l%e,y=nt(g,oe,e)*f%e,p=nt(y,o,e)*y%e,h=nt(p,i,e)*p%e,d=nt(h,a,e)*h%e,w=nt(d,c,e)*d%e,m=nt(w,a,e)*h%e,A=nt(m,n,e)*l%e,I=nt(A,s,e)*p%e,k=nt(I,r,e)*f%e,_=nt(k,oe,e);if(!Ce.eql(Ce.sqr(_),t))throw new Error("Cannot find square root");return _}const Ce=wi(le,void 0,void 0,{sqrt:gr}),Dt=Ii({a:BigInt(0),b:BigInt(7),Fp:Ce,n:re,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=re,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-pr*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,s=BigInt("0x100000000000000000000000000000000"),a=Cn(i*t,e),c=Cn(-r*t,e);let f=F(t-a*n-c*o,e),l=F(-a*r-c*i,e);const u=f>s,g=l>s;if(u&&(f=e-f),g&&(l=e-l),f>s||l>s)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:u,k1:f,k2neg:g,k2:l}}}},Ne),ue=BigInt(0),yr=t=>typeof t=="bigint"&&ue<t&&t<le,Ui=t=>typeof t=="bigint"&&ue<t&&t<re,Hn={};function ie(t,...e){let n=Hn[t];if(n===void 0){const r=Ne(Uint8Array.from(t,o=>o.charCodeAt(0)));n=kt(r,r),Hn[t]=n}return Ne(kt(n,...e))}const Je=t=>t.toRawBytes(!0).slice(1),He=t=>Lt(t,32),_e=t=>F(t,le),Wt=t=>F(t,re),Ye=Dt.ProjectivePoint,$i=(t,e,n)=>Ye.BASE.multiplyAndAddUnsafe(t,e,n);function Me(t){let e=Dt.utils.normPrivateKeyToScalar(t),n=Ye.fromPrivateKey(e);return{scalar:n.hasEvenY()?e:Wt(-e),bytes:Je(n)}}function wr(t){if(!yr(t))throw new Error("bad x: need 0 < x < p");const e=_e(t*t),n=_e(e*t+BigInt(7));let r=gr(n);r%oe!==ue&&(r=_e(-r));const o=new Ye(t,r,pr);return o.assertValidity(),o}function br(...t){return Wt(Q(ie("BIP0340/challenge",...t)))}function Ti(t){return Me(t).bytes}function ki(t,e,n=or(32)){const r=K("message",t),{bytes:o,scalar:i}=Me(e),s=K("auxRand",n,32),a=He(i^Q(ie("BIP0340/aux",s))),c=ie("BIP0340/nonce",a,o,r),f=Wt(Q(c));if(f===ue)throw new Error("sign failed: k is zero");const{bytes:l,scalar:u}=Me(f),g=br(l,o,r),y=new Uint8Array(64);if(y.set(l,0),y.set(He(Wt(u+g*i)),32),!mr(y,r,o))throw new Error("sign: Invalid signature produced");return y}function mr(t,e,n){const r=K("signature",t,64),o=K("message",e),i=K("publicKey",n,32);try{const s=wr(Q(i)),a=Q(r.subarray(0,32));if(!yr(a))return!1;const c=Q(r.subarray(32,64));if(!Ui(c))return!1;const f=br(He(a),Je(s),o),l=$i(s,c,Wt(-f));return!(!l||!l.hasEvenY()||l.toAffine().x!==a)}catch{return!1}}const Kt={getPublicKey:Ti,sign:ki,verify:mr,utils:{randomPrivateKey:Dt.utils.randomPrivateKey,lift_x:wr,pointToBytes:Je,numberToBytesBE:Lt,bytesToNumberBE:Q,taggedHash:ie,mod:F}},Be=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Qe=t=>t instanceof Uint8Array,fl=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),Se=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),ct=(t,e)=>t<<32-e|t>>>e,Ni=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Ni)throw new Error("Non little-endian hardware is not supported");const Ri=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function G(t){if(!Qe(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=Ri[t[n]];return e}function Nt(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let r=0;r<n.length;r++){const o=r*2,i=t.slice(o,o+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");n[r]=s}return n}function Oi(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Zt(t){if(typeof t=="string"&&(t=Oi(t)),!Qe(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function he(...t){const e=new Uint8Array(t.reduce((r,o)=>r+o.length,0));let n=0;return t.forEach(r=>{if(!Qe(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}class xr{clone(){return this._cloneInto()}}const Ci=t=>Object.prototype.toString.call(t)==="[object Object]"&&t.constructor===Object;function ll(t,e){if(e!==void 0&&(typeof e!="object"||!Ci(e)))throw new Error("Options should be object or undefined");return Object.assign(t,e)}function Er(t){const e=r=>t().update(Zt(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function vr(t=32){if(Be&&typeof Be.getRandomValues=="function")return Be.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Pe(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Hi(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function Ar(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function Mi(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Pe(t.outputLen),Pe(t.blockLen)}function Pi(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function qi(t,e){Ar(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const ft={number:Pe,bool:Hi,bytes:Ar,hash:Mi,exists:Pi,output:qi};function Vi(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,f=r?0:4;t.setUint32(e+c,s,r),t.setUint32(e+f,a,r)}class zi extends xr{constructor(e,n,r,o){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Se(this.buffer)}update(e){ft.exists(this);const{view:n,buffer:r,blockLen:o}=this;e=Zt(e);const i=e.length;for(let s=0;s<i;){const a=Math.min(o-this.pos,i-s);if(a===o){const c=Se(e);for(;o<=i-s;s+=o)this.process(c,s);continue}r.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ft.exists(this),ft.output(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:i}=this;let{pos:s}=this;n[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>o-s&&(this.process(r,0),s=0);for(let u=s;u<o;u++)n[u]=0;Vi(r,o-8,BigInt(this.length*8),i),this.process(r,0);const a=Se(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=c/4,l=this.get();if(f>l.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<f;u++)a.setUint32(4*u,l[u],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:i,destroyed:s,pos:a}=this;return e.length=o,e.pos=a,e.finished=i,e.destroyed=s,o%n&&e.buffer.set(r),e}}const ji=(t,e,n)=>t&e^~t&n,Di=(t,e,n)=>t&e^t&n^e&n,Fi=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),At=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),_t=new Uint32Array(64);class _r extends zi{constructor(){super(64,32,8,!1),this.A=At[0]|0,this.B=At[1]|0,this.C=At[2]|0,this.D=At[3]|0,this.E=At[4]|0,this.F=At[5]|0,this.G=At[6]|0,this.H=At[7]|0}get(){const{A:e,B:n,C:r,D:o,E:i,F:s,G:a,H:c}=this;return[e,n,r,o,i,s,a,c]}set(e,n,r,o,i,s,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=i|0,this.F=s|0,this.G=a|0,this.H=c|0}process(e,n){for(let u=0;u<16;u++,n+=4)_t[u]=e.getUint32(n,!1);for(let u=16;u<64;u++){const g=_t[u-15],y=_t[u-2],p=ct(g,7)^ct(g,18)^g>>>3,h=ct(y,17)^ct(y,19)^y>>>10;_t[u]=h+_t[u-7]+p+_t[u-16]|0}let{A:r,B:o,C:i,D:s,E:a,F:c,G:f,H:l}=this;for(let u=0;u<64;u++){const g=ct(a,6)^ct(a,11)^ct(a,25),y=l+g+ji(a,c,f)+Fi[u]+_t[u]|0,h=(ct(r,2)^ct(r,13)^ct(r,22))+Di(r,o,i)|0;l=f,f=c,c=a,a=s+y|0,s=i,i=o,o=r,r=y+h|0}r=r+this.A|0,o=o+this.B|0,i=i+this.C|0,s=s+this.D|0,a=a+this.E|0,c=c+this.F|0,f=f+this.G|0,l=l+this.H|0,this.set(r,o,i,s,a,c,f,l)}roundClean(){_t.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Ki extends _r{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const Rt=Er(()=>new _r);Er(()=>new Ki);/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Ft(t){if(!Number.isSafeInteger(t))throw new Error(`Wrong integer: ${t}`)}function bt(...t){const e=(o,i)=>s=>o(i(s)),n=Array.from(t).reverse().reduce((o,i)=>o?e(o,i.encode):i.encode,void 0),r=t.reduce((o,i)=>o?e(o,i.decode):i.decode,void 0);return{encode:n,decode:r}}function mt(t){return{encode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return e.map(n=>{if(Ft(n),n<0||n>=t.length)throw new Error(`Digit index outside alphabet: ${n} (alphabet: ${t.length})`);return t[n]})},decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("alphabet.decode input should be array of strings");return e.map(n=>{if(typeof n!="string")throw new Error(`alphabet.decode: not string element=${n}`);const r=t.indexOf(n);if(r===-1)throw new Error(`Unknown letter: "${n}". Allowed: ${t}`);return r})}}}function xt(t=""){if(typeof t!="string")throw new Error("join separator should be string");return{encode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("join.encode input should be array of strings");for(let n of e)if(typeof n!="string")throw new Error(`join.encode: non-string input=${n}`);return e.join(t)},decode:e=>{if(typeof e!="string")throw new Error("join.decode input should be string");return e.split(t)}}}function de(t,e="="){if(Ft(t),typeof e!="string")throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let r of n)if(typeof r!="string")throw new Error(`padding.encode: non-string input=${r}`);for(;n.length*t%8;)n.push(e);return n},decode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let o of n)if(typeof o!="string")throw new Error(`padding.decode: non-string input=${o}`);let r=n.length;if(r*t%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===e;r--)if(!((r-1)*t%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function Br(t){if(typeof t!="function")throw new Error("normalize fn should be function");return{encode:e=>e,decode:e=>t(e)}}function Mn(t,e,n){if(e<2)throw new Error(`convertRadix: wrong from=${e}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(t))throw new Error("convertRadix: data should be array");if(!t.length)return[];let r=0;const o=[],i=Array.from(t);for(i.forEach(s=>{if(Ft(s),s<0||s>=e)throw new Error(`Wrong integer: ${s}`)});;){let s=0,a=!0;for(let c=r;c<i.length;c++){const f=i[c],l=e*s+f;if(!Number.isSafeInteger(l)||e*s/e!==s||l-f!==e*s)throw new Error("convertRadix: carry overflow");if(s=l%n,i[c]=Math.floor(l/n),!Number.isSafeInteger(i[c])||i[c]*n+s!==l)throw new Error("convertRadix: carry overflow");if(a)i[c]?a=!1:r=c;else continue}if(o.push(s),a)break}for(let s=0;s<t.length-1&&t[s]===0;s++)o.push(0);return o.reverse()}const Sr=(t,e)=>e?Sr(e,t%e):t,se=(t,e)=>t+(e-Sr(t,e));function qe(t,e,n,r){if(!Array.isArray(t))throw new Error("convertRadix2: data should be array");if(e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(se(e,n)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${n} carryBits=${se(e,n)}`);let o=0,i=0;const s=2**n-1,a=[];for(const c of t){if(Ft(c),c>=2**e)throw new Error(`convertRadix2: invalid data word=${c} from=${e}`);if(o=o<<e|c,i+e>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${e}`);for(i+=e;i>=n;i-=n)a.push((o>>i-n&s)>>>0);o&=2**i-1}if(o=o<<n-i&s,!r&&i>=e)throw new Error("Excess padding");if(!r&&o)throw new Error(`Non-zero padding: ${o}`);return r&&i>0&&a.push(o>>>0),a}function Gi(t){return Ft(t),{encode:e=>{if(!(e instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return Mn(Array.from(e),2**8,t)},decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(Mn(e,t,2**8))}}}function It(t,e=!1){if(Ft(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(se(8,t)>32||se(t,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return qe(Array.from(n),8,t,!e)},decode:n=>{if(!Array.isArray(n)||n.length&&typeof n[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(qe(n,t,8,e))}}}function Pn(t){if(typeof t!="function")throw new Error("unsafeWrapper fn should be function");return function(...e){try{return t.apply(null,e)}catch{}}}const Wi=bt(It(4),mt("0123456789ABCDEF"),xt("")),Zi=bt(It(5),mt("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),de(5),xt(""));bt(It(5),mt("0123456789ABCDEFGHIJKLMNOPQRSTUV"),de(5),xt(""));bt(It(5),mt("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),xt(""),Br(t=>t.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));const wt=bt(It(6),mt("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),de(6),xt("")),Xi=bt(It(6),mt("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),de(6),xt("")),tn=t=>bt(Gi(58),mt(t),xt("")),Ve=tn("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");tn("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ");tn("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const qn=[0,2,3,5,6,7,9,10,11],Ji={encode(t){let e="";for(let n=0;n<t.length;n+=8){const r=t.subarray(n,n+8);e+=Ve.encode(r).padStart(qn[r.length],"1")}return e},decode(t){let e=[];for(let n=0;n<t.length;n+=11){const r=t.slice(n,n+11),o=qn.indexOf(r.length),i=Ve.decode(r);for(let s=0;s<i.length-o;s++)if(i[s]!==0)throw new Error("base58xmr: wrong padding");e=e.concat(Array.from(i.slice(i.length-o)))}return Uint8Array.from(e)}},ze=bt(mt("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),xt("")),Vn=[996825010,642813549,513874426,1027748829,705979059];function Gt(t){const e=t>>25;let n=(t&33554431)<<5;for(let r=0;r<Vn.length;r++)(e>>r&1)===1&&(n^=Vn[r]);return n}function zn(t,e,n=1){const r=t.length;let o=1;for(let i=0;i<r;i++){const s=t.charCodeAt(i);if(s<33||s>126)throw new Error(`Invalid prefix (${t})`);o=Gt(o)^s>>5}o=Gt(o);for(let i=0;i<r;i++)o=Gt(o)^t.charCodeAt(i)&31;for(let i of e)o=Gt(o)^i;for(let i=0;i<6;i++)o=Gt(o);return o^=n,ze.encode(qe([o%2**30],30,5,!1))}function Lr(t){const e=t==="bech32"?1:734539939,n=It(5),r=n.decode,o=n.encode,i=Pn(r);function s(l,u,g=90){if(typeof l!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof l}`);if(!Array.isArray(u)||u.length&&typeof u[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof u}`);const y=l.length+7+u.length;if(g!==!1&&y>g)throw new TypeError(`Length ${y} exceeds limit ${g}`);return l=l.toLowerCase(),`${l}1${ze.encode(u)}${zn(l,u,e)}`}function a(l,u=90){if(typeof l!="string")throw new Error(`bech32.decode input should be string, not ${typeof l}`);if(l.length<8||u!==!1&&l.length>u)throw new TypeError(`Wrong string length: ${l.length} (${l}). Expected (8..${u})`);const g=l.toLowerCase();if(l!==g&&l!==l.toUpperCase())throw new Error("String must be lowercase or uppercase");l=g;const y=l.lastIndexOf("1");if(y===0||y===-1)throw new Error('Letter "1" must be present between prefix and data only');const p=l.slice(0,y),h=l.slice(y+1);if(h.length<6)throw new Error("Data must be at least 6 characters long");const d=ze.decode(h).slice(0,-6),w=zn(p,d,e);if(!h.endsWith(w))throw new Error(`Invalid checksum in ${l}: expected "${w}"`);return{prefix:p,words:d}}const c=Pn(a);function f(l){const{prefix:u,words:g}=a(l,!1);return{prefix:u,words:g,bytes:r(g)}}return{encode:s,decode:a,decodeToBytes:f,decodeUnsafe:c,fromWords:r,fromWordsUnsafe:i,toWords:o}}const jt=Lr("bech32");Lr("bech32m");const Yi={encode:t=>new TextDecoder().decode(t),decode:t=>new TextEncoder().encode(t)},Qi=bt(It(4),mt("0123456789abcdef"),xt(""),Br(t=>{if(typeof t!="string"||t.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof t} with length ${t.length}`);return t.toLowerCase()})),ts={utf8:Yi,hex:Qi,base16:Wi,base32:Zi,base64:wt,base64url:Xi,base58:Ve,base58xmr:Ji};`${Object.keys(ts).join(", ")}`;function Le(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function jn(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function Ir(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function W(t,...e){if(!Ir(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function Dn(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function es(t,e){W(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const Z=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),ns=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),rs=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!rs)throw new Error("Non little-endian hardware is not supported");const os=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ht(t){W(t);let e="";for(let n=0;n<t.length;n++)e+=os[t[n]];return e}const ht={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function Fn(t){if(t>=ht._0&&t<=ht._9)return t-ht._0;if(t>=ht._A&&t<=ht._F)return t-(ht._A-10);if(t>=ht._a&&t<=ht._f)return t-(ht._a-10)}function Ur(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,n=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let o=0,i=0;o<n;o++,i+=2){const s=Fn(t.charCodeAt(i)),a=Fn(t.charCodeAt(i+1));if(s===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[o]=s*16+a}return r}function is(t){if(typeof t!="string")throw new Error(`string expected, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function je(t){if(typeof t=="string")t=is(t);else if(Ir(t))t=t.slice();else throw new Error(`Uint8Array expected, got ${typeof t}`);return t}function ss(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function $r(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return n===0}const Tr=(t,e)=>(Object.assign(e,t),e);function Kn(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=4,f=0;t.setUint32(e+c,s,r),t.setUint32(e+f,a,r)}const St=16,as=283;function en(t){return t<<1^as&-(t>>7)}function Pt(t,e){let n=0;for(;e>0;e>>=1)n^=t&-(e&1),t=en(t);return n}const De=(()=>{let t=new Uint8Array(256);for(let n=0,r=1;n<256;n++,r^=en(r))t[n]=r;const e=new Uint8Array(256);e[0]=99;for(let n=0;n<255;n++){let r=t[255-n];r|=r<<8,e[t[n]]=(r^r>>4^r>>5^r>>6^r>>7^99)&255}return e})(),cs=De.map((t,e)=>De.indexOf(e)),fs=t=>t<<24|t>>>8,Ie=t=>t<<8|t>>>24;function kr(t,e){if(t.length!==256)throw new Error("Wrong sbox length");const n=new Uint32Array(256).map((f,l)=>e(t[l])),r=n.map(Ie),o=r.map(Ie),i=o.map(Ie),s=new Uint32Array(256*256),a=new Uint32Array(256*256),c=new Uint16Array(256*256);for(let f=0;f<256;f++)for(let l=0;l<256;l++){const u=f*256+l;s[u]=n[f]^r[l],a[u]=o[f]^i[l],c[u]=t[f]<<8|t[l]}return{sbox:t,sbox2:c,T0:n,T1:r,T2:o,T3:i,T01:s,T23:a}}const nn=kr(De,t=>Pt(t,3)<<24|t<<16|t<<8|Pt(t,2)),Nr=kr(cs,t=>Pt(t,11)<<24|Pt(t,13)<<16|Pt(t,9)<<8|Pt(t,14)),ls=(()=>{const t=new Uint8Array(16);for(let e=0,n=1;e<16;e++,n=en(n))t[e]=n;return t})();function Rr(t){W(t);const e=t.length;if(![16,24,32].includes(e))throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${e}`);const{sbox2:n}=nn,r=Z(t),o=r.length,i=a=>lt(n,a,a,a,a),s=new Uint32Array(e+28);s.set(r);for(let a=o;a<s.length;a++){let c=s[a-1];a%o===0?c=i(fs(c))^ls[a/o-1]:o>6&&a%o===4&&(c=i(c)),s[a]=s[a-o]^c}return s}function us(t){const e=Rr(t),n=e.slice(),r=e.length,{sbox2:o}=nn,{T0:i,T1:s,T2:a,T3:c}=Nr;for(let f=0;f<r;f+=4)for(let l=0;l<4;l++)n[f+l]=e[r-f-4+l];e.fill(0);for(let f=4;f<r-4;f++){const l=n[f],u=lt(o,l,l,l,l);n[f]=i[u&255]^s[u>>>8&255]^a[u>>>16&255]^c[u>>>24]}return n}function Bt(t,e,n,r,o,i){return t[n<<8&65280|r>>>8&255]^e[o>>>8&65280|i>>>24&255]}function lt(t,e,n,r,o){return t[e&255|n&65280]|t[r>>>16&255|o>>>16&65280]<<16}function Gn(t,e,n,r,o){const{sbox2:i,T01:s,T23:a}=nn;let c=0;e^=t[c++],n^=t[c++],r^=t[c++],o^=t[c++];const f=t.length/4-2;for(let p=0;p<f;p++){const h=t[c++]^Bt(s,a,e,n,r,o),d=t[c++]^Bt(s,a,n,r,o,e),w=t[c++]^Bt(s,a,r,o,e,n),m=t[c++]^Bt(s,a,o,e,n,r);e=h,n=d,r=w,o=m}const l=t[c++]^lt(i,e,n,r,o),u=t[c++]^lt(i,n,r,o,e),g=t[c++]^lt(i,r,o,e,n),y=t[c++]^lt(i,o,e,n,r);return{s0:l,s1:u,s2:g,s3:y}}function hs(t,e,n,r,o){const{sbox2:i,T01:s,T23:a}=Nr;let c=0;e^=t[c++],n^=t[c++],r^=t[c++],o^=t[c++];const f=t.length/4-2;for(let p=0;p<f;p++){const h=t[c++]^Bt(s,a,e,o,r,n),d=t[c++]^Bt(s,a,n,e,o,r),w=t[c++]^Bt(s,a,r,n,e,o),m=t[c++]^Bt(s,a,o,r,n,e);e=h,n=d,r=w,o=m}const l=t[c++]^lt(i,e,o,r,n),u=t[c++]^lt(i,n,e,o,r),g=t[c++]^lt(i,r,n,e,o),y=t[c++]^lt(i,o,r,n,e);return{s0:l,s1:u,s2:g,s3:y}}function Or(t,e){if(!e)return new Uint8Array(t);if(W(e),e.length<t)throw new Error(`aes: wrong destination length, expected at least ${t}, got: ${e.length}`);return e}function ds(t){if(W(t),t.length%St!==0)throw new Error(`aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size ${St}`)}function ps(t,e,n){let r=t.length;const o=r%St;if(!e&&o!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");const i=Z(t);if(e){let c=St-o;c||(c=St),r=r+c}const s=Or(r,n),a=Z(s);return{b:i,o:a,out:s}}function gs(t,e){if(!e)return t;const n=t.length;if(!n)throw new Error("aes/pcks5: empty ciphertext not allowed");const r=t[n-1];if(r<=0||r>16)throw new Error(`aes/pcks5: wrong padding byte: ${r}`);const o=t.subarray(0,-r);for(let i=0;i<r;i++)if(t[n-i-1]!==r)throw new Error("aes/pcks5: wrong padding");return o}function ys(t){const e=new Uint8Array(16),n=Z(e);e.set(t);const r=St-t.length;for(let o=St-r;o<St;o++)e[o]=r;return n}const Cr=Tr({blockSize:16,nonceLength:16},function(e,n,r={}){W(e),W(n,16);const o=!r.disablePadding;return{encrypt:(i,s)=>{const a=Rr(e),{b:c,o:f,out:l}=ps(i,o,s),u=Z(n);let g=u[0],y=u[1],p=u[2],h=u[3],d=0;for(;d+4<=c.length;)g^=c[d+0],y^=c[d+1],p^=c[d+2],h^=c[d+3],{s0:g,s1:y,s2:p,s3:h}=Gn(a,g,y,p,h),f[d++]=g,f[d++]=y,f[d++]=p,f[d++]=h;if(o){const w=ys(i.subarray(d*4));g^=w[0],y^=w[1],p^=w[2],h^=w[3],{s0:g,s1:y,s2:p,s3:h}=Gn(a,g,y,p,h),f[d++]=g,f[d++]=y,f[d++]=p,f[d++]=h}return a.fill(0),l},decrypt:(i,s)=>{ds(i);const a=us(e),c=Z(n),f=Or(i.length,s),l=Z(i),u=Z(f);let g=c[0],y=c[1],p=c[2],h=c[3];for(let d=0;d+4<=l.length;){const w=g,m=y,A=p,I=h;g=l[d+0],y=l[d+1],p=l[d+2],h=l[d+3];const{s0:k,s1:_,s2:v,s3:B}=hs(a,g,y,p,h);u[d++]=k^w,u[d++]=_^m,u[d++]=v^A,u[d++]=B^I}return a.fill(0),gs(f,o)}}}),D=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class ws{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=je(e),W(e,32);const n=D(e,0),r=D(e,2),o=D(e,4),i=D(e,6),s=D(e,8),a=D(e,10),c=D(e,12),f=D(e,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|o<<6)&7939,this.r[3]=(o>>>7|i<<9)&8191,this.r[4]=(i>>>4|s<<12)&255,this.r[5]=s>>>1&8190,this.r[6]=(s>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|f<<8)&8191,this.r[9]=f>>>5&127;for(let l=0;l<8;l++)this.pad[l]=D(e,16+2*l)}process(e,n,r=!1){const o=r?0:2048,{h:i,r:s}=this,a=s[0],c=s[1],f=s[2],l=s[3],u=s[4],g=s[5],y=s[6],p=s[7],h=s[8],d=s[9],w=D(e,n+0),m=D(e,n+2),A=D(e,n+4),I=D(e,n+6),k=D(e,n+8),_=D(e,n+10),v=D(e,n+12),B=D(e,n+14);let N=i[0]+(w&8191),U=i[1]+((w>>>13|m<<3)&8191),$=i[2]+((m>>>10|A<<6)&8191),O=i[3]+((A>>>7|I<<9)&8191),C=i[4]+((I>>>4|k<<12)&8191),P=i[5]+(k>>>1&8191),b=i[6]+((k>>>14|_<<2)&8191),x=i[7]+((_>>>11|v<<5)&8191),L=i[8]+((v>>>8|B<<8)&8191),T=i[9]+(B>>>5|o),E=0,R=E+N*a+U*(5*d)+$*(5*h)+O*(5*p)+C*(5*y);E=R>>>13,R&=8191,R+=P*(5*g)+b*(5*u)+x*(5*l)+L*(5*f)+T*(5*c),E+=R>>>13,R&=8191;let M=E+N*c+U*a+$*(5*d)+O*(5*h)+C*(5*p);E=M>>>13,M&=8191,M+=P*(5*y)+b*(5*g)+x*(5*u)+L*(5*l)+T*(5*f),E+=M>>>13,M&=8191;let H=E+N*f+U*c+$*a+O*(5*d)+C*(5*h);E=H>>>13,H&=8191,H+=P*(5*p)+b*(5*y)+x*(5*g)+L*(5*u)+T*(5*l),E+=H>>>13,H&=8191;let z=E+N*l+U*f+$*c+O*a+C*(5*d);E=z>>>13,z&=8191,z+=P*(5*h)+b*(5*p)+x*(5*y)+L*(5*g)+T*(5*u),E+=z>>>13,z&=8191;let X=E+N*u+U*l+$*f+O*c+C*a;E=X>>>13,X&=8191,X+=P*(5*d)+b*(5*h)+x*(5*p)+L*(5*y)+T*(5*g),E+=X>>>13,X&=8191;let tt=E+N*g+U*u+$*l+O*f+C*c;E=tt>>>13,tt&=8191,tt+=P*a+b*(5*d)+x*(5*h)+L*(5*p)+T*(5*y),E+=tt>>>13,tt&=8191;let et=E+N*y+U*g+$*u+O*l+C*f;E=et>>>13,et&=8191,et+=P*c+b*a+x*(5*d)+L*(5*h)+T*(5*p),E+=et>>>13,et&=8191;let J=E+N*p+U*y+$*g+O*u+C*l;E=J>>>13,J&=8191,J+=P*f+b*c+x*a+L*(5*d)+T*(5*h),E+=J>>>13,J&=8191;let it=E+N*h+U*p+$*y+O*g+C*u;E=it>>>13,it&=8191,it+=P*l+b*f+x*c+L*a+T*(5*d),E+=it>>>13,it&=8191;let Y=E+N*d+U*h+$*p+O*y+C*g;E=Y>>>13,Y&=8191,Y+=P*u+b*l+x*f+L*c+T*a,E+=Y>>>13,Y&=8191,E=(E<<2)+E|0,E=E+R|0,R=E&8191,E=E>>>13,M+=E,i[0]=R,i[1]=M,i[2]=H,i[3]=z,i[4]=X,i[5]=tt,i[6]=et,i[7]=J,i[8]=it,i[9]=Y}finalize(){const{h:e,pad:n}=this,r=new Uint16Array(10);let o=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=o,o=e[a]>>>13,e[a]&=8191;e[0]+=o*5,o=e[0]>>>13,e[0]&=8191,e[1]+=o,o=e[1]>>>13,e[1]&=8191,e[2]+=o,r[0]=e[0]+5,o=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=e[a]+o,o=r[a]>>>13,r[a]&=8191;r[9]-=8192;let i=(o^1)-1;for(let a=0;a<10;a++)r[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|r[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let s=e[0]+n[0];e[0]=s&65535;for(let a=1;a<8;a++)s=(e[a]+n[a]|0)+(s>>>16)|0,e[a]=s&65535}update(e){Dn(this);const{buffer:n,blockLen:r}=this;e=je(e);const o=e.length;for(let i=0;i<o;){const s=Math.min(r-this.pos,o-i);if(s===r){for(;r<=o-i;i+=r)this.process(e,i);continue}n.set(e.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(e){Dn(this),es(e,this),this.finished=!0;const{buffer:n,h:r}=this;let{pos:o}=this;if(o){for(n[o++]=1;o<16;o++)n[o]=0;this.process(n,0,!0)}this.finalize();let i=0;for(let s=0;s<8;s++)e[i++]=r[s]>>>0,e[i++]=r[s]>>>8;return e}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}}function bs(t){const e=(r,o)=>t(o).update(je(r)).digest(),n=t(new Uint8Array(32));return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}const ms=bs(t=>new ws(t)),Hr=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),xs=Hr("expand 16-byte k"),Es=Hr("expand 32-byte k"),vs=Z(xs),Mr=Z(Es);Mr.slice();function S(t,e){return t<<e|t>>>32-e}function Fe(t){return t.byteOffset%4===0}const Yt=64,As=16,Pr=2**32-1,Wn=new Uint32Array;function _s(t,e,n,r,o,i,s,a){const c=o.length,f=new Uint8Array(Yt),l=Z(f),u=Fe(o)&&Fe(i),g=u?Z(o):Wn,y=u?Z(i):Wn;for(let p=0;p<c;s++){if(t(e,n,r,l,s,a),s>=Pr)throw new Error("arx: counter overflow");const h=Math.min(Yt,c-p);if(u&&h===Yt){const d=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let w=0,m;w<As;w++)m=d+w,y[m]=g[m]^l[w];p+=Yt;continue}for(let d=0,w;d<h;d++)w=p+d,i[w]=o[w]^f[d];p+=h}}function qr(t,e){const{allowShortKeys:n,extendNonceFn:r,counterLength:o,counterRight:i,rounds:s}=ss({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return Le(o),Le(s),jn(i),jn(n),(a,c,f,l,u=0)=>{W(a),W(c),W(f);const g=f.length;if(l||(l=new Uint8Array(g)),W(l),Le(u),u<0||u>=Pr)throw new Error("arx: counter overflow");if(l.length<g)throw new Error(`arx: output (${l.length}) is shorter than data (${g})`);const y=[];let p=a.length,h,d;if(p===32)h=a.slice(),y.push(h),d=Mr;else if(p===16&&n)h=new Uint8Array(32),h.set(a),h.set(a,16),d=vs,y.push(h);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);Fe(c)||(c=c.slice(),y.push(c));const w=Z(h);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(d,w,Z(c.subarray(0,16)),w),c=c.subarray(16)}const m=16-o;if(m!==c.length)throw new Error(`arx: nonce must be ${m} or 16 bytes`);if(m!==12){const I=new Uint8Array(12);I.set(c,i?0:12-c.length),c=I,y.push(c)}const A=Z(c);for(_s(t,d,w,A,f,l,u,s);y.length>0;)y.pop().fill(0);return l}}function Vr(t,e,n,r,o,i=20){let s=t[0],a=t[1],c=t[2],f=t[3],l=e[0],u=e[1],g=e[2],y=e[3],p=e[4],h=e[5],d=e[6],w=e[7],m=o,A=n[0],I=n[1],k=n[2],_=s,v=a,B=c,N=f,U=l,$=u,O=g,C=y,P=p,b=h,x=d,L=w,T=m,E=A,R=I,M=k;for(let z=0;z<i;z+=2)_=_+U|0,T=S(T^_,16),P=P+T|0,U=S(U^P,12),_=_+U|0,T=S(T^_,8),P=P+T|0,U=S(U^P,7),v=v+$|0,E=S(E^v,16),b=b+E|0,$=S($^b,12),v=v+$|0,E=S(E^v,8),b=b+E|0,$=S($^b,7),B=B+O|0,R=S(R^B,16),x=x+R|0,O=S(O^x,12),B=B+O|0,R=S(R^B,8),x=x+R|0,O=S(O^x,7),N=N+C|0,M=S(M^N,16),L=L+M|0,C=S(C^L,12),N=N+C|0,M=S(M^N,8),L=L+M|0,C=S(C^L,7),_=_+$|0,M=S(M^_,16),x=x+M|0,$=S($^x,12),_=_+$|0,M=S(M^_,8),x=x+M|0,$=S($^x,7),v=v+O|0,T=S(T^v,16),L=L+T|0,O=S(O^L,12),v=v+O|0,T=S(T^v,8),L=L+T|0,O=S(O^L,7),B=B+C|0,E=S(E^B,16),P=P+E|0,C=S(C^P,12),B=B+C|0,E=S(E^B,8),P=P+E|0,C=S(C^P,7),N=N+U|0,R=S(R^N,16),b=b+R|0,U=S(U^b,12),N=N+U|0,R=S(R^N,8),b=b+R|0,U=S(U^b,7);let H=0;r[H++]=s+_|0,r[H++]=a+v|0,r[H++]=c+B|0,r[H++]=f+N|0,r[H++]=l+U|0,r[H++]=u+$|0,r[H++]=g+O|0,r[H++]=y+C|0,r[H++]=p+P|0,r[H++]=h+b|0,r[H++]=d+x|0,r[H++]=w+L|0,r[H++]=m+T|0,r[H++]=A+E|0,r[H++]=I+R|0,r[H++]=k+M|0}function Bs(t,e,n,r){let o=t[0],i=t[1],s=t[2],a=t[3],c=e[0],f=e[1],l=e[2],u=e[3],g=e[4],y=e[5],p=e[6],h=e[7],d=n[0],w=n[1],m=n[2],A=n[3];for(let k=0;k<20;k+=2)o=o+c|0,d=S(d^o,16),g=g+d|0,c=S(c^g,12),o=o+c|0,d=S(d^o,8),g=g+d|0,c=S(c^g,7),i=i+f|0,w=S(w^i,16),y=y+w|0,f=S(f^y,12),i=i+f|0,w=S(w^i,8),y=y+w|0,f=S(f^y,7),s=s+l|0,m=S(m^s,16),p=p+m|0,l=S(l^p,12),s=s+l|0,m=S(m^s,8),p=p+m|0,l=S(l^p,7),a=a+u|0,A=S(A^a,16),h=h+A|0,u=S(u^h,12),a=a+u|0,A=S(A^a,8),h=h+A|0,u=S(u^h,7),o=o+f|0,A=S(A^o,16),p=p+A|0,f=S(f^p,12),o=o+f|0,A=S(A^o,8),p=p+A|0,f=S(f^p,7),i=i+l|0,d=S(d^i,16),h=h+d|0,l=S(l^h,12),i=i+l|0,d=S(d^i,8),h=h+d|0,l=S(l^h,7),s=s+u|0,w=S(w^s,16),g=g+w|0,u=S(u^g,12),s=s+u|0,w=S(w^s,8),g=g+w|0,u=S(u^g,7),a=a+c|0,m=S(m^a,16),y=y+m|0,c=S(c^y,12),a=a+c|0,m=S(m^a,8),y=y+m|0,c=S(c^y,7);let I=0;r[I++]=o,r[I++]=i,r[I++]=s,r[I++]=a,r[I++]=d,r[I++]=w,r[I++]=m,r[I++]=A}const zr=qr(Vr,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Ss=qr(Vr,{counterRight:!1,counterLength:8,extendNonceFn:Bs,allowShortKeys:!1}),Ls=new Uint8Array(16),Zn=(t,e)=>{t.update(e);const n=e.length%16;n&&t.update(Ls.subarray(n))},Is=new Uint8Array(32);function Xn(t,e,n,r,o){const i=t(e,n,Is),s=ms.create(i);o&&Zn(s,o),Zn(s,r);const a=new Uint8Array(16),c=ns(a);Kn(c,0,BigInt(o?o.length:0),!0),Kn(c,8,BigInt(r.length),!0),s.update(a);const f=s.digest();return i.fill(0),f}const Us=t=>(e,n,r)=>(W(e,32),W(n),{encrypt:(i,s)=>{const a=i.length,c=a+16;s?W(s,c):s=new Uint8Array(c),t(e,n,i,s,1);const f=Xn(t,e,n,s.subarray(0,-16),r);return s.set(f,a),s},decrypt:(i,s)=>{const a=i.length,c=a-16;if(a<16)throw new Error("encrypted data must be at least 16 bytes");s?W(s,c):s=new Uint8Array(c);const f=i.subarray(0,-16),l=i.subarray(-16),u=Xn(t,e,n,f,r);if(!$r(l,u))throw new Error("invalid tag");return t(e,n,f,s,1),s}}),ul=Tr({blockSize:64,nonceLength:24,tagLength:16},Us(Ss));class jr extends xr{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,ft.hash(e);const r=Zt(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,i=new Uint8Array(o);i.set(r.length>o?e.create().update(r).digest():r);for(let s=0;s<i.length;s++)i[s]^=54;this.iHash.update(i),this.oHash=e.create();for(let s=0;s<i.length;s++)i[s]^=106;this.oHash.update(i),i.fill(0)}update(e){return ft.exists(this),this.iHash.update(e),this}digestInto(e){ft.exists(this),ft.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:o,destroyed:i,blockLen:s,outputLen:a}=this;return e=e,e.finished=o,e.destroyed=i,e.blockLen=s,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const pe=(t,e,n)=>new jr(t,e).update(n).digest();pe.create=(t,e)=>new jr(t,e);function $s(t,e,n){return ft.hash(t),pe(t,Zt(n),Zt(e))}const Ue=new Uint8Array([0]),Jn=new Uint8Array;function Ts(t,e,n,r=32){if(ft.hash(t),ft.number(r),r>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const o=Math.ceil(r/t.outputLen);n===void 0&&(n=Jn);const i=new Uint8Array(o*t.outputLen),s=pe.create(t,e),a=s._cloneInto(),c=new Uint8Array(s.outputLen);for(let f=0;f<o;f++)Ue[0]=f+1,a.update(f===0?Jn:c).update(n).update(Ue).digestInto(c),i.set(c,t.outputLen*f),s._cloneInto(a);return s.destroy(),a.destroy(),c.fill(0),Ue.fill(0),i.slice(0,r)}var ks=Object.defineProperty,q=(t,e)=>{for(var n in e)ks(t,n,{get:e[n],enumerable:!0})},Mt=Symbol("verified"),Ns=t=>t instanceof Object;function rn(t){if(!Ns(t)||typeof t.kind!="number"||typeof t.content!="string"||typeof t.created_at!="number"||typeof t.pubkey!="string"||!t.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(t.tags))return!1;for(let e=0;e<t.tags.length;e++){let n=t.tags[e];if(!Array.isArray(n))return!1;for(let r=0;r<n.length;r++)if(typeof n[r]!="string")return!1}return!0}var Rs={};q(Rs,{Queue:()=>Ms,QueueNode:()=>Dr,binarySearch:()=>on,bytesToHex:()=>G,hexToBytes:()=>Nt,insertEventIntoAscendingList:()=>Hs,insertEventIntoDescendingList:()=>Cs,normalizeURL:()=>Os,utf8Decoder:()=>yt,utf8Encoder:()=>ot});var yt=new TextDecoder("utf-8"),ot=new TextEncoder;function Os(t){try{t.indexOf("://")===-1&&(t="wss://"+t);let e=new URL(t);return e.protocol==="http:"?e.protocol="ws:":e.protocol==="https:"&&(e.protocol="wss:"),e.pathname=e.pathname.replace(/\/+/g,"/"),e.pathname.endsWith("/")&&(e.pathname=e.pathname.slice(0,-1)),(e.port==="80"&&e.protocol==="ws:"||e.port==="443"&&e.protocol==="wss:")&&(e.port=""),e.searchParams.sort(),e.hash="",e.toString()}catch{throw new Error(`Invalid URL: ${t}`)}}function Cs(t,e){const[n,r]=on(t,o=>e.id===o.id?0:e.created_at===o.created_at?-1:o.created_at-e.created_at);return r||t.splice(n,0,e),t}function Hs(t,e){const[n,r]=on(t,o=>e.id===o.id?0:e.created_at===o.created_at?-1:e.created_at-o.created_at);return r||t.splice(n,0,e),t}function on(t,e){let n=0,r=t.length-1;for(;n<=r;){const o=Math.floor((n+r)/2),i=e(t[o]);if(i===0)return[o,!0];i<0?r=o-1:n=o+1}return[n,!1]}var Dr=class{value;next=null;prev=null;constructor(t){this.value=t}},Ms=class{first;last;constructor(){this.first=null,this.last=null}enqueue(t){const e=new Dr(t);return this.last?this.last===this.first?(this.last=e,this.last.prev=this.first,this.first.next=e):(e.prev=this.last,this.last.next=e,this.last=e):(this.first=e,this.last=e),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const e=this.first;return this.first=null,this.last=null,e.value}const t=this.first;return this.first=t.next,this.first&&(this.first.prev=null),t.value}},Ps=class{generateSecretKey(){return Kt.utils.randomPrivateKey()}getPublicKey(t){return G(Kt.getPublicKey(t))}finalizeEvent(t,e){const n=t;return n.pubkey=G(Kt.getPublicKey(e)),n.id=te(n),n.sig=G(Kt.sign(te(n),e)),n[Mt]=!0,n}verifyEvent(t){if(typeof t[Mt]=="boolean")return t[Mt];const e=te(t);if(e!==t.id)return t[Mt]=!1,!1;try{const n=Kt.verify(t.sig,e,t.pubkey);return t[Mt]=n,n}catch{return t[Mt]=!1,!1}}};function qs(t){if(!rn(t))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content])}function te(t){let e=Rt(ot.encode(qs(t)));return G(e)}var ge=new Ps,Vs=ge.generateSecretKey,sn=ge.getPublicKey,ut=ge.finalizeEvent,an=ge.verifyEvent,zs={};q(zs,{Application:()=>tc,BadgeAward:()=>Xs,BadgeDefinition:()=>Ga,BlockedRelaysList:()=>Ua,BlossomServerList:()=>Ca,BookmarkList:()=>Sa,Bookmarksets:()=>Da,Calendar:()=>ac,CalendarEventRSVP:()=>cc,ChannelCreation:()=>Xr,ChannelHideMessage:()=>Qr,ChannelMessage:()=>Yr,ChannelMetadata:()=>Jr,ChannelMuteUser:()=>to,ChatMessage:()=>Js,ClassifiedListing:()=>rc,ClientAuth:()=>no,Comment:()=>sa,CommunitiesList:()=>La,CommunityDefinition:()=>hc,CommunityPostApproval:()=>pa,Contacts:()=>Gs,CreateOrUpdateProduct:()=>Xa,CreateOrUpdateStall:()=>Za,Curationsets:()=>Fa,Date:()=>ic,DirectMessageRelaysList:()=>Ra,DraftClassifiedListing:()=>oc,DraftLong:()=>Ya,Emojisets:()=>Qa,EncryptedDirectMessage:()=>Ws,EventDeletion:()=>Zs,FavoriteRelays:()=>Ta,FileMessage:()=>Qs,FileMetadata:()=>ia,FileServerPreference:()=>Oa,Followsets:()=>Va,ForumThread:()=>Ys,GenericRepost:()=>hn,Genericlists:()=>za,GiftWrap:()=>eo,GroupMetadata:()=>dc,HTTPAuth:()=>dn,Handlerinformation:()=>uc,Handlerrecommendation:()=>lc,Highlights:()=>Ea,InterestsList:()=>ka,Interestsets:()=>Wa,JobFeedback:()=>wa,JobRequest:()=>ga,JobResult:()=>ya,Label:()=>da,LightningPubRPC:()=>Ma,LiveChatMessage:()=>aa,LiveEvent:()=>ec,LongFormArticle:()=>Ja,Metadata:()=>Fs,Mutelist:()=>Aa,NWCWalletInfo:()=>Ha,NWCWalletRequest:()=>ro,NWCWalletResponse:()=>Pa,NormalVideo:()=>ea,NostrConnect:()=>qa,OpenTimestamps:()=>ra,Photo:()=>ta,Pinlist:()=>_a,Poll:()=>oa,PollResponse:()=>va,PrivateDirectMessage:()=>Zr,ProblemTracker:()=>la,ProfileBadges:()=>Ka,PublicChatsList:()=>Ia,Reaction:()=>un,RecommendRelay:()=>Ks,RelayList:()=>Ba,RelayReview:()=>fc,Relaysets:()=>ja,Report:()=>ua,Reporting:()=>ha,Repost:()=>ln,Seal:()=>Wr,SearchRelaysList:()=>$a,ShortTextNote:()=>Gr,ShortVideo:()=>na,Time:()=>sc,UserEmojiList:()=>Na,UserStatuses:()=>nc,Voice:()=>ca,VoiceComment:()=>fa,Zap:()=>xa,ZapGoal:()=>ba,ZapRequest:()=>ma,classifyKind:()=>js,isAddressableKind:()=>fn,isEphemeralKind:()=>Kr,isKind:()=>Ds,isRegularKind:()=>Fr,isReplaceableKind:()=>cn});function Fr(t){return t<1e4&&t!==0&&t!==3}function cn(t){return t===0||t===3||1e4<=t&&t<2e4}function Kr(t){return 2e4<=t&&t<3e4}function fn(t){return 3e4<=t&&t<4e4}function js(t){return Fr(t)?"regular":cn(t)?"replaceable":Kr(t)?"ephemeral":fn(t)?"parameterized":"unknown"}function Ds(t,e){const n=e instanceof Array?e:[e];return rn(t)&&n.includes(t.kind)||!1}var Fs=0,Gr=1,Ks=2,Gs=3,Ws=4,Zs=5,ln=6,un=7,Xs=8,Js=9,Ys=11,Wr=13,Zr=14,Qs=15,hn=16,ta=20,ea=21,na=22,Xr=40,Jr=41,Yr=42,Qr=43,to=44,ra=1040,eo=1059,oa=1068,ia=1063,sa=1111,aa=1311,ca=1222,fa=1244,la=1971,ua=1984,ha=1984,da=1985,pa=4550,ga=5999,ya=6999,wa=7e3,ba=9041,ma=9734,xa=9735,Ea=9802,va=1018,Aa=1e4,_a=10001,Ba=10002,Sa=10003,La=10004,Ia=10005,Ua=10006,$a=10007,Ta=10012,ka=10015,Na=10030,Ra=10050,Oa=10096,Ca=10063,Ha=13194,Ma=21e3,no=22242,ro=23194,Pa=23195,qa=24133,dn=27235,Va=3e4,za=30001,ja=30002,Da=30003,Fa=30004,Ka=30008,Ga=30009,Wa=30015,Za=30017,Xa=30018,Ja=30023,Ya=30024,Qa=30030,tc=30078,ec=30311,nc=30315,rc=30402,oc=30403,ic=31922,sc=31923,ac=31924,cc=31925,fc=31987,lc=31989,uc=31990,hc=34550,dc=39e3;function pc(t,e){if(t.ids&&t.ids.indexOf(e.id)===-1||t.kinds&&t.kinds.indexOf(e.kind)===-1||t.authors&&t.authors.indexOf(e.pubkey)===-1)return!1;for(let n in t)if(n[0]==="#"){let r=n.slice(1),o=t[`#${r}`];if(o&&!e.tags.find(([i,s])=>i===n.slice(1)&&o.indexOf(s)!==-1))return!1}return!(t.since&&e.created_at<t.since||t.until&&e.created_at>t.until)}function hl(t,e){for(let n=0;n<t.length;n++)if(pc(t[n],e))return!0;return!1}var gc={};q(gc,{getHex64:()=>pn,getInt:()=>oo,getSubscriptionId:()=>yc,matchEventId:()=>wc,matchEventKind:()=>mc,matchEventPubkey:()=>bc});function pn(t,e){let n=e.length+3,r=t.indexOf(`"${e}":`)+n,o=t.slice(r).indexOf('"')+r+1;return t.slice(o,o+64)}function oo(t,e){let n=e.length,r=t.indexOf(`"${e}":`)+n+3,o=t.slice(r),i=Math.min(o.indexOf(","),o.indexOf("}"));return parseInt(o.slice(0,i),10)}function yc(t){let e=t.slice(0,22).indexOf('"EVENT"');if(e===-1)return null;let n=t.slice(e+7+1).indexOf('"');if(n===-1)return null;let r=e+7+1+n,o=t.slice(r+1,80).indexOf('"');if(o===-1)return null;let i=r+1+o;return t.slice(r+1,i)}function wc(t,e){return e===pn(t,"id")}function bc(t,e){return e===pn(t,"pubkey")}function mc(t,e){return e===oo(t,"kind")}var xc={};q(xc,{makeAuthEvent:()=>Ec});function Ec(t,e){return{kind:no,created_at:Math.floor(Date.now()/1e3),tags:[["relay",t],["challenge",e]],content:""}}var vc;try{vc=WebSocket}catch{}var Ac;try{Ac=WebSocket}catch{}var _c={};q(_c,{BECH32_REGEX:()=>io,Bech32MaxSize:()=>gn,NostrTypeGuard:()=>Bc,decode:()=>ye,decodeNostrURI:()=>Lc,encodeBytes:()=>be,naddrEncode:()=>Nc,neventEncode:()=>kc,noteEncode:()=>$c,nprofileEncode:()=>Tc,npubEncode:()=>Uc,nsecEncode:()=>Ic});var Bc={isNProfile:t=>/^nprofile1[a-z\d]+$/.test(t||""),isNEvent:t=>/^nevent1[a-z\d]+$/.test(t||""),isNAddr:t=>/^naddr1[a-z\d]+$/.test(t||""),isNSec:t=>/^nsec1[a-z\d]{58}$/.test(t||""),isNPub:t=>/^npub1[a-z\d]{58}$/.test(t||""),isNote:t=>/^note1[a-z\d]+$/.test(t||""),isNcryptsec:t=>/^ncryptsec1[a-z\d]+$/.test(t||"")},gn=5e3,io=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function Sc(t){const e=new Uint8Array(4);return e[0]=t>>24&255,e[1]=t>>16&255,e[2]=t>>8&255,e[3]=t&255,e}function Lc(t){try{return t.startsWith("nostr:")&&(t=t.substring(6)),ye(t)}catch{return{type:"invalid",data:null}}}function ye(t){let{prefix:e,words:n}=jt.decode(t,gn),r=new Uint8Array(jt.fromWords(n));switch(e){case"nprofile":{let o=$e(r);if(!o[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(o[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:G(o[0][0]),relays:o[1]?o[1].map(i=>yt.decode(i)):[]}}}case"nevent":{let o=$e(r);if(!o[0]?.[0])throw new Error("missing TLV 0 for nevent");if(o[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(o[2]&&o[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(o[3]&&o[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:G(o[0][0]),relays:o[1]?o[1].map(i=>yt.decode(i)):[],author:o[2]?.[0]?G(o[2][0]):void 0,kind:o[3]?.[0]?parseInt(G(o[3][0]),16):void 0}}}case"naddr":{let o=$e(r);if(!o[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!o[2]?.[0])throw new Error("missing TLV 2 for naddr");if(o[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!o[3]?.[0])throw new Error("missing TLV 3 for naddr");if(o[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:yt.decode(o[0][0]),pubkey:G(o[2][0]),kind:parseInt(G(o[3][0]),16),relays:o[1]?o[1].map(i=>yt.decode(i)):[]}}}case"nsec":return{type:e,data:r};case"npub":case"note":return{type:e,data:G(r)};default:throw new Error(`unknown prefix ${e}`)}}function $e(t){let e={},n=t;for(;n.length>0;){let r=n[0],o=n[1],i=n.slice(2,2+o);if(n=n.slice(2+o),i.length<o)throw new Error(`not enough data to read on TLV ${r}`);e[r]=e[r]||[],e[r].push(i)}return e}function Ic(t){return be("nsec",t)}function Uc(t){return be("npub",Nt(t))}function $c(t){return be("note",Nt(t))}function we(t,e){let n=jt.toWords(e);return jt.encode(t,n,gn)}function be(t,e){return we(t,e)}function Tc(t){let e=yn({0:[Nt(t.pubkey)],1:(t.relays||[]).map(n=>ot.encode(n))});return we("nprofile",e)}function kc(t){let e;t.kind!==void 0&&(e=Sc(t.kind));let n=yn({0:[Nt(t.id)],1:(t.relays||[]).map(r=>ot.encode(r)),2:t.author?[Nt(t.author)]:[],3:e?[new Uint8Array(e)]:[]});return we("nevent",n)}function Nc(t){let e=new ArrayBuffer(4);new DataView(e).setUint32(0,t.kind,!1);let n=yn({0:[ot.encode(t.identifier)],1:(t.relays||[]).map(r=>ot.encode(r)),2:[Nt(t.pubkey)],3:[new Uint8Array(e)]});return we("naddr",n)}function yn(t){let e=[];return Object.entries(t).reverse().forEach(([n,r])=>{r.forEach(o=>{let i=new Uint8Array(o.length+2);i.set([parseInt(n)],0),i.set([o.length],1),i.set(o,2),e.push(i)})}),he(...e)}var Rc={};q(Rc,{decrypt:()=>Oc,encrypt:()=>so});function so(t,e,n){const r=t instanceof Uint8Array?G(t):t,o=Dt.getSharedSecret(r,"02"+e),i=ao(o);let s=Uint8Array.from(vr(16)),a=ot.encode(n),c=Cr(i,s).encrypt(a),f=wt.encode(new Uint8Array(c)),l=wt.encode(new Uint8Array(s.buffer));return`${f}?iv=${l}`}function Oc(t,e,n){const r=t instanceof Uint8Array?G(t):t;let[o,i]=n.split("?iv="),s=Dt.getSharedSecret(r,"02"+e),a=ao(s),c=wt.decode(i),f=wt.decode(o),l=Cr(a,c).decrypt(f);return yt.decode(l)}function ao(t){return t.slice(1,33)}var Cc={};q(Cc,{NIP05_REGEX:()=>wn,isNip05:()=>Hc,isValid:()=>qc,queryProfile:()=>co,searchDomain:()=>Pc,useFetchImplementation:()=>Mc});var wn=/^(?:([\w.+-]+)@)?([\w_-]+(\.[\w_-]+)+)$/,Hc=t=>wn.test(t||""),me;try{me=fetch}catch{}function Mc(t){me=t}async function Pc(t,e=""){try{const n=`https://${t}/.well-known/nostr.json?name=${e}`,r=await me(n,{redirect:"manual"});if(r.status!==200)throw Error("Wrong response code");return(await r.json()).names}catch{return{}}}async function co(t){const e=t.match(wn);if(!e)return null;const[,n="_",r]=e;try{const o=`https://${r}/.well-known/nostr.json?name=${n}`,i=await me(o,{redirect:"manual"});if(i.status!==200)throw Error("Wrong response code");const s=await i.json(),a=s.names[n];return a?{pubkey:a,relays:s.relays?.[a]}:null}catch{return null}}async function qc(t,e){const n=await co(e);return n?n.pubkey===t:!1}var Vc={};q(Vc,{parse:()=>zc});function zc(t){const e={reply:void 0,root:void 0,mentions:[],profiles:[],quotes:[]};let n,r;for(let o=t.tags.length-1;o>=0;o--){const i=t.tags[o];if(i[0]==="e"&&i[1]){const[s,a,c,f,l]=i,u={id:a,relays:c?[c]:[],author:l};if(f==="root"){e.root=u;continue}if(f==="reply"){e.reply=u;continue}if(f==="mention"){e.mentions.push(u);continue}n?r=u:n=u,e.mentions.push(u);continue}if(i[0]==="q"&&i[1]){const[s,a,c]=i;e.quotes.push({id:a,relays:c?[c]:[]})}if(i[0]==="p"&&i[1]){e.profiles.push({pubkey:i[1],relays:i[2]?[i[2]]:[]});continue}}return e.root||(e.root=r||n||e.reply),e.reply||(e.reply=n||e.root),[e.reply,e.root].forEach(o=>{if(!o)return;let i=e.mentions.indexOf(o);if(i!==-1&&e.mentions.splice(i,1),o.author){let s=e.profiles.find(a=>a.pubkey===o.author);s&&s.relays&&(o.relays||(o.relays=[]),s.relays.forEach(a=>{o.relays?.indexOf(a)===-1&&o.relays.push(a)}),s.relays=o.relays)}}),e.mentions.forEach(o=>{if(o.author){let i=e.profiles.find(s=>s.pubkey===o.author);i&&i.relays&&(o.relays||(o.relays=[]),i.relays.forEach(s=>{o.relays.indexOf(s)===-1&&o.relays.push(s)}),i.relays=o.relays)}}),e}var jc={};q(jc,{fetchRelayInformation:()=>Fc,useFetchImplementation:()=>Dc});var fo;try{fo=fetch}catch{}function Dc(t){fo=t}async function Fc(t){return await(await fetch(t.replace("ws://","http://").replace("wss://","https://"),{headers:{Accept:"application/nostr+json"}})).json()}var Kc={};q(Kc,{fastEventHash:()=>uo,getPow:()=>lo,minePow:()=>Gc});function lo(t){let e=0;for(let n=0;n<64;n+=8){const r=parseInt(t.substring(n,n+8),16);if(r===0)e+=32;else{e+=Math.clz32(r);break}}return e}function Gc(t,e){let n=0;const r=t,o=["nonce",n.toString(),e.toString()];for(r.tags.push(o);;){const i=Math.floor(new Date().getTime()/1e3);if(i!==r.created_at&&(n=0,r.created_at=i),o[1]=(++n).toString(),r.id=uo(r),lo(r.id)>=e)break}return r}function uo(t){return G(Rt(ot.encode(JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content]))))}var Wc={};q(Wc,{unwrapEvent:()=>af,unwrapManyEvents:()=>cf,wrapEvent:()=>Bo,wrapManyEvents:()=>sf});var Zc={};q(Zc,{createRumor:()=>Eo,createSeal:()=>vo,createWrap:()=>Ao,unwrapEvent:()=>vn,unwrapManyEvents:()=>_o,wrapEvent:()=>ae,wrapManyEvents:()=>rf});var Xc={};q(Xc,{decrypt:()=>En,encrypt:()=>xn,getConversationKey:()=>bn,v2:()=>ef});var ho=1,po=65535;function bn(t,e){const n=Dt.getSharedSecret(t,"02"+e).subarray(1,33);return $s(Rt,n,"nip44-v2")}function go(t,e){const n=Ts(Rt,t,e,76);return{chacha_key:n.subarray(0,32),chacha_nonce:n.subarray(32,44),hmac_key:n.subarray(44,76)}}function mn(t){if(!Number.isSafeInteger(t)||t<1)throw new Error("expected positive integer");if(t<=32)return 32;const e=1<<Math.floor(Math.log2(t-1))+1,n=e<=256?32:e/8;return n*(Math.floor((t-1)/n)+1)}function Jc(t){if(!Number.isSafeInteger(t)||t<ho||t>po)throw new Error("invalid plaintext size: must be between 1 and 65535 bytes");const e=new Uint8Array(2);return new DataView(e.buffer).setUint16(0,t,!1),e}function Yc(t){const e=ot.encode(t),n=e.length,r=Jc(n),o=new Uint8Array(mn(n)-n);return he(r,e,o)}function Qc(t){const e=new DataView(t.buffer).getUint16(0),n=t.subarray(2,2+e);if(e<ho||e>po||n.length!==e||t.length!==2+mn(e))throw new Error("invalid padding");return yt.decode(n)}function yo(t,e,n){if(n.length!==32)throw new Error("AAD associated data must be 32 bytes");const r=he(n,e);return pe(Rt,t,r)}function tf(t){if(typeof t!="string")throw new Error("payload must be a valid string");const e=t.length;if(e<132||e>87472)throw new Error("invalid payload length: "+e);if(t[0]==="#")throw new Error("unknown encryption version");let n;try{n=wt.decode(t)}catch(i){throw new Error("invalid base64: "+i.message)}const r=n.length;if(r<99||r>65603)throw new Error("invalid data length: "+r);const o=n[0];if(o!==2)throw new Error("unknown encryption version "+o);return{nonce:n.subarray(1,33),ciphertext:n.subarray(33,-32),mac:n.subarray(-32)}}function xn(t,e,n=vr(32)){const{chacha_key:r,chacha_nonce:o,hmac_key:i}=go(e,n),s=Yc(t),a=zr(r,o,s),c=yo(i,a,n);return wt.encode(he(new Uint8Array([2]),n,a,c))}function En(t,e){const{nonce:n,ciphertext:r,mac:o}=tf(t),{chacha_key:i,chacha_nonce:s,hmac_key:a}=go(e,n),c=yo(a,r,n);if(!$r(c,o))throw new Error("invalid MAC");const f=zr(i,s,r);return Qc(f)}var ef={utils:{getConversationKey:bn,calcPaddedLen:mn},encrypt:xn,decrypt:En},nf=2*24*60*60,wo=()=>Math.round(Date.now()/1e3),bo=()=>Math.round(wo()-Math.random()*nf),mo=(t,e)=>bn(t,e),xo=(t,e,n)=>xn(JSON.stringify(t),mo(e,n)),Yn=(t,e)=>JSON.parse(En(t.content,mo(e,t.pubkey)));function Eo(t,e){const n={created_at:wo(),content:"",tags:[],...t,pubkey:sn(e)};return n.id=te(n),n}function vo(t,e,n){return ut({kind:Wr,content:xo(t,e,n),created_at:bo(),tags:[]},e)}function Ao(t,e){const n=Vs();return ut({kind:eo,content:xo(t,n,e),created_at:bo(),tags:[["p",e]]},n)}function ae(t,e,n){const r=Eo(t,e),o=vo(r,e,n);return Ao(o,n)}function rf(t,e,n){if(!n||n.length===0)throw new Error("At least one recipient is required.");const r=sn(e),o=[ae(t,e,r)];return n.forEach(i=>{o.push(ae(t,e,i))}),o}function vn(t,e){const n=Yn(t,e);return Yn(n,e)}function _o(t,e){let n=[];return t.forEach(r=>{n.push(vn(r,e))}),n.sort((r,o)=>r.created_at-o.created_at),n}function of(t,e,n,r){const o={created_at:Math.ceil(Date.now()/1e3),kind:Zr,tags:[],content:e};return(Array.isArray(t)?t:[t]).forEach(({publicKey:s,relayUrl:a})=>{o.tags.push(a?["p",s,a]:["p",s])}),r&&o.tags.push(["e",r.eventId,r.relayUrl||"","reply"]),n&&o.tags.push(["subject",n]),o}function Bo(t,e,n,r,o){const i=of(e,n,r,o);return ae(i,t,e.publicKey)}function sf(t,e,n,r,o){if(!e||e.length===0)throw new Error("At least one recipient is required.");return[{publicKey:sn(t)},...e].map(s=>Bo(t,s,n,r,o))}var af=vn,cf=_o,ff={};q(ff,{finishRepostEvent:()=>lf,getRepostedEvent:()=>uf,getRepostedEventPointer:()=>So});function lf(t,e,n,r){let o;const i=[...t.tags??[],["e",e.id,n],["p",e.pubkey]];return e.kind===Gr?o=ln:(o=hn,i.push(["k",String(e.kind)])),ut({kind:o,tags:i,content:t.content===""||e.tags?.find(s=>s[0]==="-")?"":JSON.stringify(e),created_at:t.created_at},r)}function So(t){if(![ln,hn].includes(t.kind))return;let e,n;for(let r=t.tags.length-1;r>=0&&(e===void 0||n===void 0);r--){const o=t.tags[r];o.length>=2&&(o[0]==="e"&&e===void 0?e=o:o[0]==="p"&&n===void 0&&(n=o))}if(e!==void 0)return{id:e[1],relays:[e[2],n?.[2]].filter(r=>typeof r=="string"),author:n?.[1]}}function uf(t,{skipVerification:e}={}){const n=So(t);if(n===void 0||t.content==="")return;let r;try{r=JSON.parse(t.content)}catch{return}if(r.id===n.id&&!(!e&&!an(r)))return r}var hf={};q(hf,{NOSTR_URI_REGEX:()=>An,parse:()=>pf,test:()=>df});var An=new RegExp(`nostr:(${io.source})`);function df(t){return typeof t=="string"&&new RegExp(`^${An.source}$`).test(t)}function pf(t){const e=t.match(new RegExp(`^${An.source}$`));if(!e)throw new Error(`Invalid Nostr URI: ${t}`);return{uri:e[0],value:e[1],decoded:ye(e[1])}}var gf={};q(gf,{finishReactionEvent:()=>yf,getReactedEventPointer:()=>wf});function yf(t,e,n){const r=e.tags.filter(o=>o.length>=2&&(o[0]==="e"||o[0]==="p"));return ut({...t,kind:un,tags:[...t.tags??[],...r,["e",e.id],["p",e.pubkey]],content:t.content??"+"},n)}function wf(t){if(t.kind!==un)return;let e,n;for(let r=t.tags.length-1;r>=0&&(e===void 0||n===void 0);r--){const o=t.tags[r];o.length>=2&&(o[0]==="e"&&e===void 0?e=o:o[0]==="p"&&n===void 0&&(n=o))}if(!(e===void 0||n===void 0))return{id:e[1],relays:[e[2],n[2]].filter(r=>r!==void 0),author:n[1]}}var bf={};q(bf,{parse:()=>xf});var Qn=/\W/m,tr=/\W |\W$|$|,| /m,mf=42;function*xf(t){let e=[];if(typeof t!="string"){for(let i=0;i<t.tags.length;i++){const s=t.tags[i];s[0]==="emoji"&&s.length>=3&&e.push({type:"emoji",shortcode:s[1],url:s[2]})}t=t.content}const n=t.length;let r=0,o=0;t:for(;o<n;){const i=t.indexOf(":",o),s=t.indexOf("#",o);if(i===-1&&s===-1)break t;if(i===-1||s>=0&&s<i){if(s===0||t[s-1]===" "){const a=t.slice(s+1,s+mf).match(Qn),c=a?s+1+a.index:n;yield{type:"text",text:t.slice(r,s)},yield{type:"hashtag",value:t.slice(s+1,c)},o=c,r=o;continue t}o=s+1;continue t}if(t.slice(i-5,i)==="nostr"){const a=t.slice(i+60).match(Qn),c=a?i+60+a.index:n;try{let f,{data:l,type:u}=ye(t.slice(i+1,c));switch(u){case"npub":f={pubkey:l};break;case"nsec":case"note":o=c+1;continue;default:f=l}r!==i-5&&(yield{type:"text",text:t.slice(r,i-5)}),yield{type:"reference",pointer:f},o=c,r=o;continue t}catch{o=i+1;continue t}}else if(t.slice(i-5,i)==="https"||t.slice(i-4,i)==="http"){const a=t.slice(i+4).match(tr),c=a?i+4+a.index:n,f=t[i-1]==="s"?5:4;try{let l=new URL(t.slice(i-f,c));if(l.hostname.indexOf(".")===-1)throw new Error("invalid url");if(r!==i-f&&(yield{type:"text",text:t.slice(r,i-f)}),/\.(png|jpe?g|gif|webp|heic|svg)$/i.test(l.pathname)){yield{type:"image",url:l.toString()},o=c,r=o;continue t}if(/\.(mp4|avi|webm|mkv|mov)$/i.test(l.pathname)){yield{type:"video",url:l.toString()},o=c,r=o;continue t}if(/\.(mp3|aac|ogg|opus|wav|flac)$/i.test(l.pathname)){yield{type:"audio",url:l.toString()},o=c,r=o;continue t}yield{type:"url",url:l.toString()},o=c,r=o;continue t}catch{o=c+1;continue t}}else if(t.slice(i-3,i)==="wss"||t.slice(i-2,i)==="ws"){const a=t.slice(i+4).match(tr),c=a?i+4+a.index:n,f=t[i-1]==="s"?3:2;try{let l=new URL(t.slice(i-f,c));if(l.hostname.indexOf(".")===-1)throw new Error("invalid ws url");r!==i-f&&(yield{type:"text",text:t.slice(r,i-f)}),yield{type:"relay",url:l.toString()},o=c,r=o;continue t}catch{o=c+1;continue t}}else{for(let a=0;a<e.length;a++){const c=e[a];if(t[i+c.shortcode.length+1]===":"&&t.slice(i+1,i+c.shortcode.length+1)===c.shortcode){r!==i&&(yield{type:"text",text:t.slice(r,i)}),yield c,o=i+c.shortcode.length+2,r=o;continue t}}o=i+1;continue t}}r!==n&&(yield{type:"text",text:t.slice(r)})}var Ef={};q(Ef,{channelCreateEvent:()=>vf,channelHideMessageEvent:()=>Bf,channelMessageEvent:()=>_f,channelMetadataEvent:()=>Af,channelMuteUserEvent:()=>Sf});var vf=(t,e)=>{let n;if(typeof t.content=="object")n=JSON.stringify(t.content);else if(typeof t.content=="string")n=t.content;else return;return ut({kind:Xr,tags:[...t.tags??[]],content:n,created_at:t.created_at},e)},Af=(t,e)=>{let n;if(typeof t.content=="object")n=JSON.stringify(t.content);else if(typeof t.content=="string")n=t.content;else return;return ut({kind:Jr,tags:[["e",t.channel_create_event_id],...t.tags??[]],content:n,created_at:t.created_at},e)},_f=(t,e)=>{const n=[["e",t.channel_create_event_id,t.relay_url,"root"]];return t.reply_to_channel_message_event_id&&n.push(["e",t.reply_to_channel_message_event_id,t.relay_url,"reply"]),ut({kind:Yr,tags:[...n,...t.tags??[]],content:t.content,created_at:t.created_at},e)},Bf=(t,e)=>{let n;if(typeof t.content=="object")n=JSON.stringify(t.content);else if(typeof t.content=="string")n=t.content;else return;return ut({kind:Qr,tags:[["e",t.channel_message_event_id],...t.tags??[]],content:n,created_at:t.created_at},e)},Sf=(t,e)=>{let n;if(typeof t.content=="object")n=JSON.stringify(t.content);else if(typeof t.content=="string")n=t.content;else return;return ut({kind:to,tags:[["p",t.pubkey_to_mute],...t.tags??[]],content:n,created_at:t.created_at},e)},Lf={};q(Lf,{EMOJI_SHORTCODE_REGEX:()=>Lo,matchAll:()=>If,regex:()=>_n,replaceAll:()=>Uf});var Lo=/:(\w+):/,_n=()=>new RegExp(`\\B${Lo.source}\\B`,"g");function*If(t){const e=t.matchAll(_n());for(const n of e)try{const[r,o]=n;yield{shortcode:r,name:o,start:n.index,end:n.index+r.length}}catch{}}function Uf(t,e){return t.replaceAll(_n(),(n,r)=>e({shortcode:n,name:r}))}var $f={};q($f,{useFetchImplementation:()=>Tf,validateGithub:()=>kf});var Bn;try{Bn=fetch}catch{}function Tf(t){Bn=t}async function kf(t,e,n){try{return await(await Bn(`https://gist.github.com/${e}/${n}/raw`)).text()===`Verifying that I control the following Nostr public key: ${t}`}catch{return!1}}var Nf={};q(Nf,{makeNwcRequestEvent:()=>Of,parseConnectionString:()=>Rf});function Rf(t){const{host:e,pathname:n,searchParams:r}=new URL(t),o=n||e,i=r.get("relay"),s=r.get("secret");if(!o||!i||!s)throw new Error("invalid connection string");return{pubkey:o,relay:i,secret:s}}async function Of(t,e,n){const o=so(e,t,JSON.stringify({method:"pay_invoice",params:{invoice:n}})),i={kind:ro,created_at:Math.round(Date.now()/1e3),content:o,tags:[["p",t]]};return ut(i,e)}var Cf={};q(Cf,{normalizeIdentifier:()=>Hf});function Hf(t){return t=t.trim().toLowerCase(),t=t.normalize("NFKC"),Array.from(t).map(e=>/\p{Letter}/u.test(e)||/\p{Number}/u.test(e)?e:"-").join("")}var Mf={};q(Mf,{getSatoshisAmountFromBolt11:()=>Df,getZapEndpoint:()=>qf,makeZapReceipt:()=>jf,makeZapRequest:()=>Vf,useFetchImplementation:()=>Pf,validateZapRequest:()=>zf});var Sn;try{Sn=fetch}catch{}function Pf(t){Sn=t}async function qf(t){try{let e="",{lud06:n,lud16:r}=JSON.parse(t.content);if(r){let[s,a]=r.split("@");e=new URL(`/.well-known/lnurlp/${s}`,`https://${a}`).toString()}else if(n){let{words:s}=jt.decode(n,1e3),a=jt.fromWords(s);e=yt.decode(a)}else return null;let i=await(await Sn(e)).json();if(i.allowsNostr&&i.nostrPubkey)return i.callback}catch{}return null}function Vf(t){let e={kind:9734,created_at:Math.round(Date.now()/1e3),content:t.comment||"",tags:[["p","pubkey"in t?t.pubkey:t.event.pubkey],["amount",t.amount.toString()],["relays",...t.relays]]};if("event"in t){if(e.tags.push(["e",t.event.id]),cn(t.event.kind)){const n=["a",`${t.event.kind}:${t.event.pubkey}:`];e.tags.push(n)}else if(fn(t.event.kind)){let n=t.event.tags.find(([o,i])=>o==="d"&&i);if(!n)throw new Error("d tag not found or is empty");const r=["a",`${t.event.kind}:${t.event.pubkey}:${n[1]}`];e.tags.push(r)}e.tags.push(["k",t.event.kind.toString()])}return e}function zf(t){let e;try{e=JSON.parse(t)}catch{return"Invalid zap request JSON."}if(!rn(e))return"Zap request is not a valid Nostr event.";if(!an(e))return"Invalid signature on zap request.";let n=e.tags.find(([i,s])=>i==="p"&&s);if(!n)return"Zap request doesn't have a 'p' tag.";if(!n[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let r=e.tags.find(([i,s])=>i==="e"&&s);return r&&!r[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":e.tags.find(([i,s])=>i==="relays"&&s)?null:"Zap request doesn't have a 'relays' tag."}function jf({zapRequest:t,preimage:e,bolt11:n,paidAt:r}){let o=JSON.parse(t),i=o.tags.filter(([a])=>a==="e"||a==="p"||a==="a"),s={kind:9735,created_at:Math.round(r.getTime()/1e3),content:"",tags:[...i,["P",o.pubkey],["bolt11",n],["description",t]]};return e&&s.tags.push(["preimage",e]),s}function Df(t){if(t.length<50)return 0;t=t.substring(0,50);const e=t.lastIndexOf("1");if(e===-1)return 0;const n=t.substring(0,e);if(!n.startsWith("lnbc"))return 0;const r=n.substring(4);if(r.length<1)return 0;const o=r[r.length-1],i=o.charCodeAt(0)-48,s=i>=0&&i<=9;let a=r.length-1;if(s&&a++,a<1)return 0;const c=parseInt(r.substring(0,a));switch(o){case"m":return c*1e5;case"u":return c*100;case"n":return c/10;case"p":return c/1e4;default:return c*1e8}}var Ff={};q(Ff,{Negentropy:()=>Uo,NegentropyStorageVector:()=>Wf,NegentropySync:()=>Zf});var Te=97,qt=32,Io=16,Ut={Skip:0,Fingerprint:1,IdList:2},gt=class{_raw;length;constructor(t){typeof t=="number"?(this._raw=new Uint8Array(t),this.length=0):t instanceof Uint8Array?(this._raw=new Uint8Array(t),this.length=t.length):(this._raw=new Uint8Array(512),this.length=0)}unwrap(){return this._raw.subarray(0,this.length)}get capacity(){return this._raw.byteLength}extend(t){if(t instanceof gt&&(t=t.unwrap()),typeof t.length!="number")throw Error("bad length");const e=t.length+this.length;if(this.capacity<e){const n=this._raw,r=Math.max(this.capacity*2,e);this._raw=new Uint8Array(r),this._raw.set(n)}this._raw.set(t,this.length),this.length+=t.length}shift(){const t=this._raw[0];return this._raw=this._raw.subarray(1),this.length--,t}shiftN(t=1){const e=this._raw.subarray(0,t);return this._raw=this._raw.subarray(t),this.length-=t,e}};function Qt(t){let e=0;for(;;){if(t.length===0)throw Error("parse ends prematurely");let n=t.shift();if(e=e<<7|n&127,!(n&128))break}return e}function dt(t){if(t===0)return new gt(new Uint8Array([0]));let e=[];for(;t!==0;)e.push(t&127),t>>>=7;e.reverse();for(let n=0;n<e.length-1;n++)e[n]|=128;return new gt(new Uint8Array(e))}function Kf(t){return ee(t,1)[0]}function ee(t,e){if(t.length<e)throw Error("parse ends prematurely");return t.shiftN(e)}var Gf=class{buf;constructor(){this.setToZero()}setToZero(){this.buf=new Uint8Array(qt)}add(t){let e=0,n=0,r=new DataView(this.buf.buffer),o=new DataView(t.buffer);for(let i=0;i<8;i++){let s=i*4,a=r.getUint32(s,!0),c=o.getUint32(s,!0),f=a;f+=e,f+=c,f>4294967295&&(n=1),r.setUint32(s,f&4294967295,!0),e=n,n=0}}negate(){let t=new DataView(this.buf.buffer);for(let n=0;n<8;n++){let r=n*4;t.setUint32(r,~t.getUint32(r,!0))}let e=new Uint8Array(qt);e[0]=1,this.add(e)}getFingerprint(t){let e=new gt;return e.extend(this.buf),e.extend(dt(t)),Rt(e.unwrap()).subarray(0,Io)}},Wf=class{items;sealed;constructor(){this.items=[],this.sealed=!1}insert(t,e){if(this.sealed)throw Error("already sealed");const n=Ur(e);if(n.byteLength!==qt)throw Error("bad id size for added item");this.items.push({timestamp:t,id:n})}seal(){if(this.sealed)throw Error("already sealed");this.sealed=!0,this.items.sort(ke);for(let t=1;t<this.items.length;t++)if(ke(this.items[t-1],this.items[t])===0)throw Error("duplicate item inserted")}unseal(){this.sealed=!1}size(){return this._checkSealed(),this.items.length}getItem(t){if(this._checkSealed(),t>=this.items.length)throw Error("out of range");return this.items[t]}iterate(t,e,n){this._checkSealed(),this._checkBounds(t,e);for(let r=t;r<e&&n(this.items[r],r);++r);}findLowerBound(t,e,n){return this._checkSealed(),this._checkBounds(t,e),this._binarySearch(this.items,t,e,r=>ke(r,n)<0)}fingerprint(t,e){let n=new Gf;return n.setToZero(),this.iterate(t,e,r=>(n.add(r.id),!0)),n.getFingerprint(e-t)}_checkSealed(){if(!this.sealed)throw Error("not sealed")}_checkBounds(t,e){if(t>e||e>this.items.length)throw Error("bad range")}_binarySearch(t,e,n,r){let o=n-e;for(;o>0;){let i=e,s=Math.floor(o/2);i+=s,r(t[i])?(e=++i,o-=s+1):o=s}return e}},Uo=class{storage;frameSizeLimit;lastTimestampIn;lastTimestampOut;constructor(t,e=6e4){if(e<4096)throw Error("frameSizeLimit too small");this.storage=t,this.frameSizeLimit=e,this.lastTimestampIn=0,this.lastTimestampOut=0}_bound(t,e){return{timestamp:t,id:e||new Uint8Array(0)}}initiate(){let t=new gt;return t.extend(new Uint8Array([Te])),this.splitRange(0,this.storage.size(),this._bound(Number.MAX_VALUE),t),Ht(t.unwrap())}reconcile(t,e,n){const r=new gt(Ur(t));this.lastTimestampIn=this.lastTimestampOut=0;let o=new gt;o.extend(new Uint8Array([Te]));let i=Kf(r);if(i<96||i>111)throw Error("invalid negentropy protocol version byte");if(i!==Te)throw Error("unsupported negentropy protocol version requested: "+(i-96));let s=this.storage.size(),a=this._bound(0),c=0,f=!1;for(;r.length!==0;){let l=new gt,u=()=>{f&&(f=!1,l.extend(this.encodeBound(a)),l.extend(dt(Ut.Skip)))},g=this.decodeBound(r),y=Qt(r),p=c,h=this.storage.findLowerBound(c,s,g);if(y===Ut.Skip)f=!0;else if(y===Ut.Fingerprint){let d=ee(r,Io),w=this.storage.fingerprint(p,h);$o(d,w)!==0?(u(),this.splitRange(p,h,g,l)):f=!0}else if(y===Ut.IdList){let d=Qt(r),w={};for(let m=0;m<d;m++){let A=ee(r,qt);w[Ht(A)]=A}if(f=!0,this.storage.iterate(p,h,m=>{let A=m.id;const I=Ht(A);return w[I]?delete w[Ht(A)]:e?.(I),!0}),n)for(let m of Object.values(w))n(Ht(m))}else throw Error("unexpected mode");if(this.exceededFrameSizeLimit(o.length+l.length)){let d=this.storage.fingerprint(h,s);o.extend(this.encodeBound(this._bound(Number.MAX_VALUE))),o.extend(dt(Ut.Fingerprint)),o.extend(d);break}else o.extend(l);c=h,a=g}return o.length===1?null:Ht(o.unwrap())}splitRange(t,e,n,r){let o=e-t,i=16;if(o<i*2)r.extend(this.encodeBound(n)),r.extend(dt(Ut.IdList)),r.extend(dt(o)),this.storage.iterate(t,e,s=>(r.extend(s.id),!0));else{let s=Math.floor(o/i),a=o%i,c=t;for(let f=0;f<i;f++){let l=s+(f<a?1:0),u=this.storage.fingerprint(c,c+l);c+=l;let g;if(c===e)g=n;else{let y,p;this.storage.iterate(c-1,c+1,(h,d)=>(d===c-1?y=h:p=h,!0)),g=this.getMinimalBound(y,p)}r.extend(this.encodeBound(g)),r.extend(dt(Ut.Fingerprint)),r.extend(u)}}}exceededFrameSizeLimit(t){return t>this.frameSizeLimit-200}decodeTimestampIn(t){let e=Qt(t);return e=e===0?Number.MAX_VALUE:e-1,this.lastTimestampIn===Number.MAX_VALUE||e===Number.MAX_VALUE?(this.lastTimestampIn=Number.MAX_VALUE,Number.MAX_VALUE):(e+=this.lastTimestampIn,this.lastTimestampIn=e,e)}decodeBound(t){let e=this.decodeTimestampIn(t),n=Qt(t);if(n>qt)throw Error("bound key too long");let r=ee(t,n);return{timestamp:e,id:r}}encodeTimestampOut(t){if(t===Number.MAX_VALUE)return this.lastTimestampOut=Number.MAX_VALUE,dt(0);let e=t;return t-=this.lastTimestampOut,this.lastTimestampOut=e,dt(t+1)}encodeBound(t){let e=new gt;return e.extend(this.encodeTimestampOut(t.timestamp)),e.extend(dt(t.id.length)),e.extend(t.id),e}getMinimalBound(t,e){if(e.timestamp!==t.timestamp)return this._bound(e.timestamp);{let n=0,r=e.id,o=t.id;for(let i=0;i<qt&&r[i]===o[i];i++)n++;return this._bound(e.timestamp,e.id.subarray(0,n+1))}}};function $o(t,e){for(let n=0;n<t.byteLength;n++){if(t[n]<e[n])return-1;if(t[n]>e[n])return 1}return t.byteLength>e.byteLength?1:t.byteLength<e.byteLength?-1:0}function ke(t,e){return t.timestamp===e.timestamp?$o(t.id,e.id):t.timestamp-e.timestamp}var Zf=class{relay;storage;neg;filter;subscription;onhave;onneed;constructor(t,e,n,r={}){this.relay=t,this.storage=e,this.neg=new Uo(e),this.onhave=r.onhave,this.onneed=r.onneed,this.filter=n,this.subscription=this.relay.prepareSubscription([{}],{label:r.label||"negentropy"}),this.subscription.oncustom=o=>{switch(o[0]){case"NEG-MSG":{o.length<3&&console.warn(`got invalid NEG-MSG from ${this.relay.url}: ${o}`);try{const i=this.neg.reconcile(o[2],this.onhave,this.onneed);i?this.relay.send(`["NEG-MSG", "${this.subscription.id}", "${i}"]`):(this.close(),r.onclose?.())}catch(i){console.error("negentropy reconcile error:",i),r?.onclose?.(`reconcile error: ${i}`)}break}case"NEG-CLOSE":{const i=o[2];console.warn("negentropy error:",i),r.onclose?.(i);break}case"NEG-ERR":r.onclose?.()}}}async start(){const t=this.neg.initiate();this.relay.send(`["NEG-OPEN","${this.subscription.id}",${JSON.stringify(this.filter)},"${t}"]`)}close(){this.relay.send(`["NEG-CLOSE","${this.subscription.id}"]`),this.subscription.close()}},Xf={};q(Xf,{getToken:()=>Jf,hashPayload:()=>Ln,unpackEventFromToken:()=>ko,validateEvent:()=>Mo,validateEventKind:()=>Ro,validateEventMethodTag:()=>Co,validateEventPayloadTag:()=>Ho,validateEventTimestamp:()=>No,validateEventUrlTag:()=>Oo,validateToken:()=>Yf});var To="Nostr ";async function Jf(t,e,n,r=!1,o){const i={kind:dn,tags:[["u",t],["method",e]],created_at:Math.round(new Date().getTime()/1e3),content:""};o&&i.tags.push(["payload",Ln(o)]);const s=await n(i);return(r?To:"")+wt.encode(ot.encode(JSON.stringify(s)))}async function Yf(t,e,n){const r=await ko(t).catch(i=>{throw i});return await Mo(r,e,n).catch(i=>{throw i})}async function ko(t){if(!t)throw new Error("Missing token");t=t.replace(To,"");const e=yt.decode(wt.decode(t));if(!e||e.length===0||!e.startsWith("{"))throw new Error("Invalid token");return JSON.parse(e)}function No(t){return t.created_at?Math.round(new Date().getTime()/1e3)-t.created_at<60:!1}function Ro(t){return t.kind===dn}function Oo(t,e){const n=t.tags.find(r=>r[0]==="u");return n?n.length>0&&n[1]===e:!1}function Co(t,e){const n=t.tags.find(r=>r[0]==="method");return n?n.length>0&&n[1].toLowerCase()===e.toLowerCase():!1}function Ln(t){const e=Rt(ot.encode(JSON.stringify(t)));return G(e)}function Ho(t,e){const n=t.tags.find(o=>o[0]==="payload");if(!n)return!1;const r=Ln(e);return n.length>0&&n[1]===r}async function Mo(t,e,n,r){if(!an(t))throw new Error("Invalid nostr event, signature invalid");if(!Ro(t))throw new Error("Invalid nostr event, kind invalid");if(!No(t))throw new Error("Invalid nostr event, created_at timestamp invalid");if(!Oo(t,e))throw new Error("Invalid nostr event, url tag invalid");if(!Co(t,n))throw new Error("Invalid nostr event, method tag invalid");if(r&&typeof r=="object"&&Object.keys(r).length>0&&!Ho(t,r))throw new Error("Invalid nostr event, payload tag does not match request body hash");return!0}export{Vs as a,Xc as b,Rc as c,nl as d,el as e,ut as f,sn as g,Se as h,ft as i,ll as j,pe as k,fl as l,pc as m,_c as n,he as o,jt as p,G as q,vr as r,Rt as s,Zt as t,rl as u,Nt as v,hl as w,ul as x};
//# sourceMappingURL=C3bkP_Kp.js.map
