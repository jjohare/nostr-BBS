{"version":3,"file":"4.LqL3fqfq.js","sources":["../../../../../../src/routes/chat/+page.ts","../../../../../../src/routes/chat/+page.svelte"],"sourcesContent":["import type { PageLoad } from './$types';\nimport { browser } from '$app/environment';\n\n// Allow prerendering - data is loaded in component\nexport const prerender = true;\n\nexport const load: PageLoad = async () => {\n  // All data loading happens in the component to avoid SSR/prerender issues\n  return { channels: [] };\n};\n","<script lang=\"ts\">\n  import { onMount } from 'svelte';\n  import { goto } from '$app/navigation';\n  import { base } from '$app/paths';\n  import { channelStore, type Channel } from '$lib/stores/channels';\n  import { authStore } from '$lib/stores/auth';\n  import { ndk } from '$lib/nostr/ndk';\n  import type { PageData } from './$types';\n\n  export let data: PageData;\n\n  let channels: Channel[] = [];\n  let loading = true;\n\n  onMount(async () => {\n    if (!$authStore.isAuthenticated || !$authStore.publicKey) {\n      goto(`${base}/`);\n      return;\n    }\n\n    try {\n      const ndkInstance = await ndk.getNDK();\n      const userCohorts: ('business' | 'moomaa-tribe')[] = ['business', 'moomaa-tribe'];\n      channels = await channelStore.fetchChannels(ndkInstance, $authStore.publicKey, userCohorts);\n    } catch (error) {\n      console.error('Failed to load channels:', error);\n    } finally {\n      loading = false;\n    }\n  });\n\n  function navigateToChannel(channelId: string) {\n    goto(`${base}/chat/${channelId}`);\n  }\n\n  function formatDate(timestamp: number): string {\n    return new Date(timestamp * 1000).toLocaleDateString();\n  }\n</script>\n\n<svelte:head>\n  <title>Channels - Minimoomaa Noir</title>\n</svelte:head>\n\n<div class=\"container mx-auto p-4 max-w-4xl\">\n  <div class=\"mb-6\">\n    <h1 class=\"text-4xl font-bold gradient-text mb-2\">Channels</h1>\n    <p class=\"text-base-content/70\">Join conversations in public channels</p>\n  </div>\n\n  {#if loading}\n    <div class=\"flex justify-center items-center min-h-[400px]\">\n      <div class=\"loading loading-spinner loading-lg text-primary\"></div>\n    </div>\n  {:else if channels.length === 0}\n    <div class=\"card bg-base-200\">\n      <div class=\"card-body items-center text-center\">\n        <p class=\"text-base-content/70\">No channels found. Create one to get started!</p>\n      </div>\n    </div>\n  {:else}\n    <div class=\"grid gap-4 sm:grid-cols-2\">\n      {#each channels as channel (channel.id)}\n        <button\n          class=\"card bg-base-200 hover:bg-base-300 transition-base cursor-pointer text-left\"\n          on:click={() => navigateToChannel(channel.id)}\n        >\n          <div class=\"card-body\">\n            <div class=\"flex items-start gap-3\">\n              {#if channel.picture}\n                <img\n                  src={channel.picture}\n                  alt={channel.name}\n                  class=\"w-12 h-12 rounded-lg object-cover\"\n                />\n              {:else}\n                <div class=\"w-12 h-12 rounded-lg bg-primary flex items-center justify-center text-primary-content font-bold text-xl\">\n                  {channel.name.charAt(0).toUpperCase()}\n                </div>\n              {/if}\n\n              <div class=\"flex-1 min-w-0\">\n                <h3 class=\"card-title text-lg mb-1\">{channel.name}</h3>\n                {#if channel.description}\n                  <p class=\"text-sm text-base-content/70 line-clamp-2\">\n                    {channel.description}\n                  </p>\n                {/if}\n                <div class=\"flex items-center gap-3 mt-2 text-xs text-base-content/60\">\n                  <span>{channel.memberCount} members</span>\n                  <span>â€¢</span>\n                  <span>{formatDate(channel.createdAt)}</span>\n                  {#if channel.isEncrypted}\n                    <span class=\"badge badge-sm badge-primary\">Encrypted</span>\n                  {/if}\n                </div>\n              </div>\n            </div>\n          </div>\n        </button>\n      {/each}\n    </div>\n  {/if}\n</div>\n"],"names":["prerender","load","ctx","get_key","i","insert_hydration","target","div","anchor","div1","t_value","dirty","set_data","t","src_url_equal","img","img_src_value","attr","img_alt_value","p","span","t1_value","t4_value","formatDate","create_if_block_4","if_block1","create_if_block_3","if_block2","create_if_block_2","button","append_hydration","div3","div2","h3","div0","span0","span1","span2","t1","t4","t9","t9_value","create_if_block","create_if_block_1","timestamp","data","$$props","channels","loading","onMount","$authStore","goto","base","ndkInstance","ndk","userCohorts","$$invalidate","channelStore","error","navigateToChannel","channelId","channel"],"mappings":"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"}