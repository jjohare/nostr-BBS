{"version":3,"file":"3.D_H32AcE.js","sources":["../../../../../../src/routes/admin/+page.ts","../../../../../../src/lib/nostr/channels.ts","../../../../../../src/routes/admin/+page.svelte"],"sourcesContent":["import type { PageLoad } from './$types';\n\n// Allow prerendering - auth check happens in component\nexport const prerender = true;\n\nexport const load: PageLoad = async () => {\n  // Auth and admin check handled in component\n  return { stats: null };\n};\n","/**\n * Channel Service - Nostr channel operations using NDK\n * Implements NIP-28 (Public Chat) event kinds\n */\nimport { NDKEvent, type NDKFilter } from '@nostr-dev-kit/ndk';\nimport { ndk, connectNDK, hasSigner } from './ndk';\nimport { browser } from '$app/environment';\n\n// NIP-28 Event Kinds for Public Chat\nexport const CHANNEL_KINDS = {\n\tCREATE: 40,      // Channel creation\n\tMETADATA: 41,    // Channel metadata\n\tMESSAGE: 42,     // Channel message\n\tHIDE_MESSAGE: 43, // Hide message\n\tMUTE_USER: 44,   // Mute user in channel\n} as const;\n\nexport interface ChannelMetadata {\n\tname: string;\n\tabout?: string;\n\tpicture?: string;\n\trelays?: string[];\n}\n\nexport interface ChannelCreateOptions {\n\tname: string;\n\tdescription?: string;\n\tvisibility?: 'public' | 'cohort' | 'private';\n\tcohorts?: string[];\n\tencrypted?: boolean;\n}\n\nexport interface CreatedChannel {\n\tid: string;\n\tname: string;\n\tdescription?: string;\n\tvisibility: 'public' | 'cohort' | 'private';\n\tcohorts: string[];\n\tencrypted: boolean;\n\tcreatedAt: number;\n\tcreatorPubkey: string;\n}\n\n/**\n * Create a new channel (NIP-28 kind 40)\n */\nexport async function createChannel(options: ChannelCreateOptions): Promise<CreatedChannel> {\n\tif (!browser) {\n\t\tthrow new Error('Channel creation requires browser environment');\n\t}\n\n\tif (!hasSigner()) {\n\t\tthrow new Error('No signer configured. Please login first.');\n\t}\n\n\t// Ensure connected\n\tawait connectNDK();\n\n\t// Build channel metadata\n\tconst metadata: ChannelMetadata = {\n\t\tname: options.name,\n\t\tabout: options.description,\n\t};\n\n\t// Create the event\n\tconst event = new NDKEvent(ndk);\n\tevent.kind = CHANNEL_KINDS.CREATE;\n\tevent.content = JSON.stringify(metadata);\n\n\t// Add custom tags for visibility/cohorts\n\tif (options.visibility && options.visibility !== 'public') {\n\t\tevent.tags.push(['visibility', options.visibility]);\n\t}\n\n\tif (options.cohorts && options.cohorts.length > 0) {\n\t\tevent.tags.push(['cohort', options.cohorts.join(',')]);\n\t}\n\n\tif (options.encrypted) {\n\t\tevent.tags.push(['encrypted', 'true']);\n\t}\n\n\t// Sign and publish\n\tawait event.sign();\n\tawait event.publish();\n\n\tconsole.log('Channel created:', event.id);\n\n\treturn {\n\t\tid: event.id,\n\t\tname: options.name,\n\t\tdescription: options.description,\n\t\tvisibility: options.visibility || 'public',\n\t\tcohorts: options.cohorts || [],\n\t\tencrypted: options.encrypted || false,\n\t\tcreatedAt: event.created_at || Math.floor(Date.now() / 1000),\n\t\tcreatorPubkey: event.pubkey,\n\t};\n}\n\n/**\n * Update channel metadata (NIP-28 kind 41)\n */\nexport async function updateChannelMetadata(\n\tchannelId: string,\n\tmetadata: Partial<ChannelMetadata>\n): Promise<void> {\n\tif (!browser) {\n\t\tthrow new Error('Channel operations require browser environment');\n\t}\n\n\tif (!hasSigner()) {\n\t\tthrow new Error('No signer configured. Please login first.');\n\t}\n\n\tawait connectNDK();\n\n\tconst event = new NDKEvent(ndk);\n\tevent.kind = CHANNEL_KINDS.METADATA;\n\tevent.content = JSON.stringify(metadata);\n\tevent.tags.push(['e', channelId, '', 'root']);\n\n\tawait event.sign();\n\tawait event.publish();\n\n\tconsole.log('Channel metadata updated:', channelId);\n}\n\n/**\n * Send a message to a channel (NIP-28 kind 42)\n */\nexport async function sendChannelMessage(\n\tchannelId: string,\n\tcontent: string,\n\treplyTo?: string\n): Promise<string> {\n\tif (!browser) {\n\t\tthrow new Error('Channel operations require browser environment');\n\t}\n\n\tif (!hasSigner()) {\n\t\tthrow new Error('No signer configured. Please login first.');\n\t}\n\n\tawait connectNDK();\n\n\tconst event = new NDKEvent(ndk);\n\tevent.kind = CHANNEL_KINDS.MESSAGE;\n\tevent.content = content;\n\tevent.tags.push(['e', channelId, '', 'root']);\n\n\tif (replyTo) {\n\t\tevent.tags.push(['e', replyTo, '', 'reply']);\n\t}\n\n\tawait event.sign();\n\tawait event.publish();\n\n\tconsole.log('Message sent to channel:', channelId);\n\treturn event.id;\n}\n\n/**\n * Fetch channels from relays\n */\nexport async function fetchChannels(limit = 100): Promise<CreatedChannel[]> {\n\tif (!browser) {\n\t\treturn [];\n\t}\n\n\tawait connectNDK();\n\n\tconst filter: NDKFilter = {\n\t\tkinds: [CHANNEL_KINDS.CREATE],\n\t\tlimit,\n\t};\n\n\tconst events = await ndk.fetchEvents(filter);\n\tconst channels: CreatedChannel[] = [];\n\n\tfor (const event of events) {\n\t\ttry {\n\t\t\tconst metadata = JSON.parse(event.content) as ChannelMetadata;\n\t\t\tconst visibilityTag = event.tags.find(t => t[0] === 'visibility');\n\t\t\tconst cohortTag = event.tags.find(t => t[0] === 'cohort');\n\t\t\tconst encryptedTag = event.tags.find(t => t[0] === 'encrypted');\n\n\t\t\tchannels.push({\n\t\t\t\tid: event.id,\n\t\t\t\tname: metadata.name || 'Unnamed Channel',\n\t\t\t\tdescription: metadata.about,\n\t\t\t\tvisibility: (visibilityTag?.[1] as any) || 'public',\n\t\t\t\tcohorts: cohortTag?.[1]?.split(',').filter(Boolean) || [],\n\t\t\t\tencrypted: encryptedTag?.[1] === 'true',\n\t\t\t\tcreatedAt: event.created_at || 0,\n\t\t\t\tcreatorPubkey: event.pubkey,\n\t\t\t});\n\t\t} catch (e) {\n\t\t\tconsole.error('Failed to parse channel event:', e);\n\t\t}\n\t}\n\n\t// Sort by creation time (newest first)\n\tchannels.sort((a, b) => b.createdAt - a.createdAt);\n\n\treturn channels;\n}\n\n/**\n * Fetch messages for a channel\n */\nexport async function fetchChannelMessages(\n\tchannelId: string,\n\tlimit = 50\n): Promise<Array<{\n\tid: string;\n\tcontent: string;\n\tpubkey: string;\n\tcreatedAt: number;\n\treplyTo?: string;\n}>> {\n\tif (!browser) {\n\t\treturn [];\n\t}\n\n\tawait connectNDK();\n\n\tconst filter: NDKFilter = {\n\t\tkinds: [CHANNEL_KINDS.MESSAGE],\n\t\t'#e': [channelId],\n\t\tlimit,\n\t};\n\n\tconst events = await ndk.fetchEvents(filter);\n\tconst messages: Array<{\n\t\tid: string;\n\t\tcontent: string;\n\t\tpubkey: string;\n\t\tcreatedAt: number;\n\t\treplyTo?: string;\n\t}> = [];\n\n\tfor (const event of events) {\n\t\tconst replyTag = event.tags.find(t => t[0] === 'e' && t[3] === 'reply');\n\n\t\tmessages.push({\n\t\t\tid: event.id,\n\t\t\tcontent: event.content,\n\t\t\tpubkey: event.pubkey,\n\t\t\tcreatedAt: event.created_at || 0,\n\t\t\treplyTo: replyTag?.[1],\n\t\t});\n\t}\n\n\t// Sort by creation time (oldest first for messages)\n\tmessages.sort((a, b) => a.createdAt - b.createdAt);\n\n\treturn messages;\n}\n\n/**\n * Subscribe to channel messages in real-time\n */\nexport function subscribeToChannel(\n\tchannelId: string,\n\tonMessage: (message: {\n\t\tid: string;\n\t\tcontent: string;\n\t\tpubkey: string;\n\t\tcreatedAt: number;\n\t\treplyTo?: string;\n\t}) => void\n): { unsubscribe: () => void } {\n\tif (!browser) {\n\t\treturn { unsubscribe: () => {} };\n\t}\n\n\tconst filter: NDKFilter = {\n\t\tkinds: [CHANNEL_KINDS.MESSAGE],\n\t\t'#e': [channelId],\n\t\tsince: Math.floor(Date.now() / 1000),\n\t};\n\n\tconst sub = ndk.subscribe(filter, { closeOnEose: false });\n\n\tsub.on('event', (event: NDKEvent) => {\n\t\tconst replyTag = event.tags.find(t => t[0] === 'e' && t[3] === 'reply');\n\n\t\tonMessage({\n\t\t\tid: event.id,\n\t\t\tcontent: event.content,\n\t\t\tpubkey: event.pubkey,\n\t\t\tcreatedAt: event.created_at || 0,\n\t\t\treplyTo: replyTag?.[1],\n\t\t});\n\t});\n\n\treturn {\n\t\tunsubscribe: () => {\n\t\t\tsub.stop();\n\t\t},\n\t};\n}\n","<script lang=\"ts\">\n  import { onMount } from 'svelte';\n  import { goto } from '$app/navigation';\n  import { base } from '$app/paths';\n  import { authStore, isAdmin } from '$lib/stores/auth';\n  import { setSigner, connectNDK, getRelayUrls } from '$lib/nostr/ndk';\n  import { createChannel, fetchChannels, type CreatedChannel } from '$lib/nostr/channels';\n\n  let stats = {\n    totalUsers: 0,\n    totalChannels: 0,\n    totalMessages: 0,\n    pendingApprovals: 0\n  };\n\n  let channels: CreatedChannel[] = [];\n  let isLoading = false;\n  let error: string | null = null;\n  let showCreateForm = false;\n  let relayStatus = 'disconnected';\n\n  // Form fields\n  let formName = '';\n  let formDescription = '';\n  let formVisibility: 'public' | 'cohort' | 'private' = 'public';\n  let formCohorts = '';\n  let formEncrypted = false;\n\n  async function initializeAdmin() {\n    if (!$authStore.privateKey) {\n      error = 'Please login first to access admin features';\n      return;\n    }\n\n    try {\n      isLoading = true;\n      error = null;\n\n      // Set up signer with user's private key\n      setSigner($authStore.privateKey);\n\n      // Connect to relays\n      await connectNDK();\n      relayStatus = 'connected';\n\n      // Fetch existing channels\n      channels = await fetchChannels();\n      stats.totalChannels = channels.length;\n\n    } catch (e) {\n      error = e instanceof Error ? e.message : 'Failed to initialize admin';\n      relayStatus = 'error';\n    } finally {\n      isLoading = false;\n    }\n  }\n\n  async function handleCreateChannel() {\n    if (!formName.trim()) {\n      error = 'Channel name is required';\n      return;\n    }\n\n    try {\n      isLoading = true;\n      error = null;\n\n      const cohorts = formCohorts.split(',').map(c => c.trim()).filter(Boolean);\n\n      const newChannel = await createChannel({\n        name: formName.trim(),\n        description: formDescription.trim() || undefined,\n        visibility: formVisibility,\n        cohorts,\n        encrypted: formEncrypted,\n      });\n\n      channels = [newChannel, ...channels];\n      stats.totalChannels = channels.length;\n\n      // Reset form\n      formName = '';\n      formDescription = '';\n      formVisibility = 'public';\n      formCohorts = '';\n      formEncrypted = false;\n      showCreateForm = false;\n\n    } catch (e) {\n      error = e instanceof Error ? e.message : 'Failed to create channel';\n    } finally {\n      isLoading = false;\n    }\n  }\n\n  function formatTimestamp(ts: number): string {\n    return new Date(ts * 1000).toLocaleDateString();\n  }\n\n  function getVisibilityBadge(visibility: string): string {\n    const badges: Record<string, string> = {\n      public: 'badge-success',\n      cohort: 'badge-warning',\n      private: 'badge-error',\n    };\n    return badges[visibility] || 'badge-ghost';\n  }\n\n  onMount(() => {\n    if (!$isAdmin) {\n      goto(`${base}/chat`);\n      return;\n    }\n\n    initializeAdmin();\n  });\n</script>\n\n<svelte:head>\n  <title>Admin Dashboard - Minimoomaa Noir</title>\n</svelte:head>\n\n<div class=\"container mx-auto p-4 max-w-6xl\">\n  <div class=\"mb-6\">\n    <h1 class=\"text-4xl font-bold gradient-text mb-2\">Admin Dashboard</h1>\n    <p class=\"text-base-content/70\">System overview and management</p>\n    <div class=\"mt-2 flex items-center gap-2\">\n      <span class=\"badge {relayStatus === 'connected' ? 'badge-success' : relayStatus === 'error' ? 'badge-error' : 'badge-warning'}\">\n        {relayStatus}\n      </span>\n      <span class=\"text-sm text-base-content/50\">Relay Status</span>\n    </div>\n  </div>\n\n  <!-- Error Display -->\n  {#if error}\n    <div class=\"alert alert-error mb-4\">\n      <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"stroke-current shrink-0 h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\">\n        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n      </svg>\n      <span>{error}</span>\n      <button class=\"btn btn-ghost btn-sm\" on:click={() => error = null}>Dismiss</button>\n    </div>\n  {/if}\n\n  <div class=\"grid gap-4 sm:grid-cols-2 lg:grid-cols-4 mb-8\">\n    <div class=\"card bg-base-200\">\n      <div class=\"card-body items-center text-center\">\n        <div class=\"stat-value text-primary\">{stats.totalUsers}</div>\n        <div class=\"text-sm text-base-content/70 uppercase tracking-wide\">Total Users</div>\n      </div>\n    </div>\n\n    <div class=\"card bg-base-200\">\n      <div class=\"card-body items-center text-center\">\n        <div class=\"stat-value text-primary\">{stats.totalChannels}</div>\n        <div class=\"text-sm text-base-content/70 uppercase tracking-wide\">Total Channels</div>\n      </div>\n    </div>\n\n    <div class=\"card bg-base-200\">\n      <div class=\"card-body items-center text-center\">\n        <div class=\"stat-value text-primary\">{stats.totalMessages}</div>\n        <div class=\"text-sm text-base-content/70 uppercase tracking-wide\">Total Messages</div>\n      </div>\n    </div>\n\n    <div class=\"card bg-warning/20 border border-warning\">\n      <div class=\"card-body items-center text-center\">\n        <div class=\"stat-value text-warning\">{stats.pendingApprovals}</div>\n        <div class=\"text-sm text-base-content/70 uppercase tracking-wide\">Pending Approvals</div>\n      </div>\n    </div>\n  </div>\n\n  <!-- Channel Management Section -->\n  <div class=\"card bg-base-200 mb-6\">\n    <div class=\"card-body\">\n      <div class=\"flex items-center justify-between\">\n        <h2 class=\"card-title\">Channel Management</h2>\n        <button\n          class=\"btn btn-primary gap-2\"\n          on:click={() => showCreateForm = !showCreateForm}\n          disabled={isLoading}\n        >\n          <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 4v16m8-8H4\" />\n          </svg>\n          Create Channel\n        </button>\n      </div>\n\n      <!-- Create Channel Form -->\n      {#if showCreateForm}\n        <div class=\"mt-4 p-4 bg-base-300 rounded-lg\">\n          <h3 class=\"font-semibold mb-4\">New Channel</h3>\n\n          <div class=\"form-control mb-3\">\n            <label class=\"label\">\n              <span class=\"label-text\">Channel Name *</span>\n            </label>\n            <input\n              type=\"text\"\n              placeholder=\"Enter channel name\"\n              class=\"input input-bordered\"\n              bind:value={formName}\n            />\n          </div>\n\n          <div class=\"form-control mb-3\">\n            <label class=\"label\">\n              <span class=\"label-text\">Description</span>\n            </label>\n            <textarea\n              class=\"textarea textarea-bordered\"\n              placeholder=\"Channel description (optional)\"\n              rows=\"2\"\n              bind:value={formDescription}\n            ></textarea>\n          </div>\n\n          <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3\">\n            <div class=\"form-control\">\n              <label class=\"label\">\n                <span class=\"label-text\">Visibility</span>\n              </label>\n              <select class=\"select select-bordered\" bind:value={formVisibility}>\n                <option value=\"public\">Public</option>\n                <option value=\"cohort\">Cohort Only</option>\n                <option value=\"private\">Private</option>\n              </select>\n            </div>\n\n            <div class=\"form-control\">\n              <label class=\"label\">\n                <span class=\"label-text\">Cohorts (comma-separated)</span>\n              </label>\n              <input\n                type=\"text\"\n                placeholder=\"e.g., 2024, 2025\"\n                class=\"input input-bordered\"\n                bind:value={formCohorts}\n              />\n            </div>\n          </div>\n\n          <div class=\"form-control mb-4\">\n            <label class=\"label cursor-pointer justify-start gap-2\">\n              <input\n                type=\"checkbox\"\n                class=\"toggle toggle-primary\"\n                bind:checked={formEncrypted}\n              />\n              <span class=\"label-text\">Encrypted Messages</span>\n            </label>\n          </div>\n\n          <div class=\"flex justify-end gap-2\">\n            <button class=\"btn btn-ghost\" on:click={() => showCreateForm = false}>\n              Cancel\n            </button>\n            <button\n              class=\"btn btn-primary\"\n              on:click={handleCreateChannel}\n              disabled={isLoading || !formName.trim()}\n            >\n              {#if isLoading}\n                <span class=\"loading loading-spinner loading-sm\"></span>\n              {/if}\n              Create Channel\n            </button>\n          </div>\n        </div>\n      {/if}\n\n      <!-- Channels List -->\n      <div class=\"mt-4\">\n        {#if isLoading && channels.length === 0}\n          <div class=\"text-center py-8\">\n            <span class=\"loading loading-spinner loading-lg\"></span>\n            <p class=\"mt-2 text-base-content/70\">Loading channels...</p>\n          </div>\n        {:else if channels.length === 0}\n          <div class=\"text-center py-8 text-base-content/50\">\n            <p>No channels yet. Create your first channel above.</p>\n          </div>\n        {:else}\n          <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            {#each channels as channel (channel.id)}\n              <div class=\"card bg-base-300\">\n                <div class=\"card-body p-4\">\n                  <h3 class=\"font-semibold\">{channel.name}</h3>\n                  {#if channel.description}\n                    <p class=\"text-sm text-base-content/70 line-clamp-2\">{channel.description}</p>\n                  {/if}\n                  <div class=\"flex flex-wrap gap-1 mt-2\">\n                    <span class=\"badge {getVisibilityBadge(channel.visibility)} badge-sm\">\n                      {channel.visibility}\n                    </span>\n                    {#if channel.encrypted}\n                      <span class=\"badge badge-info badge-sm\">Encrypted</span>\n                    {/if}\n                    {#each channel.cohorts as cohort}\n                      <span class=\"badge badge-outline badge-sm\">{cohort}</span>\n                    {/each}\n                  </div>\n                  <div class=\"text-xs text-base-content/50 mt-2\">\n                    Created {formatTimestamp(channel.createdAt)}\n                  </div>\n                </div>\n              </div>\n            {/each}\n          </div>\n        {/if}\n      </div>\n    </div>\n  </div>\n\n  <!-- Quick Actions -->\n  <div class=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n    <div class=\"card bg-base-200\">\n      <div class=\"card-body\">\n        <h2 class=\"card-title\">User Management</h2>\n        <p class=\"text-sm text-base-content/70\">Manage user approvals and permissions</p>\n        <div class=\"card-actions justify-end mt-4\">\n          <button class=\"btn btn-primary btn-sm\">View Users</button>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"card bg-base-200\">\n      <div class=\"card-body\">\n        <h2 class=\"card-title\">Pending Approvals</h2>\n        <p class=\"text-sm text-base-content/70\">Review and approve join requests</p>\n        <div class=\"card-actions justify-end mt-4\">\n          <button class=\"btn btn-primary btn-sm\">View Requests</button>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"card bg-base-200\">\n      <div class=\"card-body\">\n        <h2 class=\"card-title\">System Settings</h2>\n        <p class=\"text-sm text-base-content/70\">Configure relay settings and policies</p>\n        <div class=\"card-actions justify-end mt-4\">\n          <button class=\"btn btn-primary btn-sm\">Settings</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n"],"names":["prerender","load","CHANNEL_KINDS","createChannel","options","hasSigner","connectNDK","metadata","event","NDKEvent","ndk","fetchChannels","limit","filter","events","channels","visibilityTag","t","cohortTag","encryptedTag","e","a","b","ctx","insert_hydration","target","div","anchor","append_hydration","svg","path","span","button","create_if_block_5","add_render_callback","select","div7","h3","div0","label0","input0","div1","label1","textarea","div4","div2","label2","option0","option1","option2","div3","label3","input1","div5","label4","input2","span4","div6","button0","button1","get_key","i","t_value","p","dirty","set_data","t0_value","t3_value","formatTimestamp","if_block0","create_if_block_3","if_block1","create_if_block_2","each_value_1","ensure_array_like","getVisibilityBadge","t0","t3","t8","t8_value","t10_value","t14_value","t18_value","t22_value","create_if_block_6","create_if_block_4","create_if_block","create_if_block_1","attr","span0","span0_class_value","div33","h1","p0","span1","div18","div9","div8","div13","div12","div10","div11","div17","div16","div14","div15","div22","div21","div19","h20","div20","div32","t10","t14","t18","t22","ts","visibility","stats","isLoading","error","showCreateForm","relayStatus","formName","formDescription","formVisibility","formCohorts","formEncrypted","initializeAdmin","$authStore","setSigner","$$invalidate","handleCreateChannel","cohorts","c","newChannel","onMount","$isAdmin","goto","base","click_handler","click_handler_1","select_value"],"mappings":"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"}