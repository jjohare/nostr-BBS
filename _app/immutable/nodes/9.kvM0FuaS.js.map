{"version":3,"file":"9.kvM0FuaS.js","sources":["../../../../../../src/lib/components/auth/Login.svelte","../../../../../../src/routes/setup/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte';\n  import { restoreFromMnemonic, restoreFromNsecOrHex } from '$lib/nostr/keys';\n  import { authStore } from '$lib/stores/auth';\n\n  const dispatch = createEventDispatcher<{ success: { publicKey: string; privateKey: string } }>();\n\n  let inputMode: 'paste' | 'individual' | 'privatekey' = 'paste';\n  let pastedMnemonic = '';\n  let wordInputs: string[] = Array(12).fill('');\n  let privateKeyInput = '';\n  let isRestoring = false;\n  let validationError = '';\n\n  function switchMode(mode: 'paste' | 'individual' | 'privatekey') {\n    inputMode = mode;\n    validationError = '';\n  }\n\n  async function handleRestore() {\n    isRestoring = true;\n    validationError = '';\n    authStore.clearError();\n\n    try {\n      await new Promise(resolve => setTimeout(resolve, 100));\n\n      let publicKey: string;\n      let privateKey: string;\n\n      if (inputMode === 'privatekey') {\n        // Handle nsec or hex private key\n        if (!privateKeyInput.trim()) {\n          validationError = 'Please enter your private key (nsec or hex format)';\n          return;\n        }\n        const result = restoreFromNsecOrHex(privateKeyInput);\n        publicKey = result.publicKey;\n        privateKey = result.privateKey;\n      } else {\n        // Handle mnemonic (paste or individual words)\n        const mnemonic = inputMode === 'paste'\n          ? pastedMnemonic.trim()\n          : wordInputs.map(w => w.trim().toLowerCase()).join(' ');\n\n        if (!mnemonic || mnemonic.split(' ').length !== 12) {\n          validationError = 'Please enter all 12 words';\n          return;\n        }\n\n        const result = await restoreFromMnemonic(mnemonic);\n        publicKey = result.publicKey;\n        privateKey = result.privateKey;\n      }\n\n      dispatch('success', { publicKey, privateKey });\n    } catch (error) {\n      validationError = error instanceof Error ? error.message : 'Invalid credentials';\n      authStore.setError(validationError);\n    } finally {\n      isRestoring = false;\n    }\n  }\n\n  function handlePaste(event: ClipboardEvent) {\n    event.preventDefault();\n    const text = event.clipboardData?.getData('text') || '';\n    const words = text.trim().toLowerCase().split(/\\s+/);\n\n    if (words.length === 12) {\n      wordInputs = words;\n    }\n  }\n</script>\n\n<div class=\"flex flex-col items-center justify-center min-h-screen p-4 bg-base-200\">\n  <div class=\"card w-full max-w-2xl bg-base-100 shadow-xl\">\n    <div class=\"card-body\">\n      <h2 class=\"card-title text-2xl justify-center mb-4\">Restore Your Account</h2>\n\n      <div class=\"alert alert-info mb-4\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" class=\"stroke-current shrink-0 w-6 h-6\">\n          <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"></path>\n        </svg>\n        <span class=\"text-sm\">Enter your 12-word recovery phrase to restore your account</span>\n      </div>\n\n      <div class=\"tabs tabs-boxed mb-4\">\n        <button\n          class=\"tab flex-1\"\n          class:tab-active={inputMode === 'paste'}\n          on:click={() => switchMode('paste')}\n        >\n          Paste Phrase\n        </button>\n        <button\n          class=\"tab flex-1\"\n          class:tab-active={inputMode === 'individual'}\n          on:click={() => switchMode('individual')}\n        >\n          Enter Words\n        </button>\n        <button\n          class=\"tab flex-1\"\n          class:tab-active={inputMode === 'privatekey'}\n          on:click={() => switchMode('privatekey')}\n        >\n          Private Key\n        </button>\n      </div>\n\n      {#if inputMode === 'paste'}\n        <div class=\"form-control\">\n          <textarea\n            class=\"textarea textarea-bordered h-32 font-mono\"\n            placeholder=\"Paste your 12-word recovery phrase here...\"\n            bind:value={pastedMnemonic}\n            disabled={isRestoring}\n          />\n        </div>\n      {:else if inputMode === 'privatekey'}\n        <div class=\"form-control\">\n          <label class=\"label\">\n            <span class=\"label-text\">Enter your nsec or hex private key</span>\n          </label>\n          <input\n            type=\"password\"\n            class=\"input input-bordered font-mono\"\n            placeholder=\"nsec1... or 64-character hex\"\n            bind:value={privateKeyInput}\n            disabled={isRestoring}\n            autocomplete=\"off\"\n          />\n          <label class=\"label\">\n            <span class=\"label-text-alt text-base-content/50\">\n              Supports nsec format (nsec1...) or raw 64-character hex\n            </span>\n          </label>\n        </div>\n      {:else}\n        <div class=\"grid grid-cols-2 sm:grid-cols-3 gap-3\" on:paste={handlePaste}>\n          {#each wordInputs as word, i}\n            <div class=\"form-control\">\n              <label class=\"label py-1\">\n                <span class=\"label-text text-xs\">Word {i + 1}</span>\n              </label>\n              <input\n                type=\"text\"\n                class=\"input input-bordered input-sm font-mono\"\n                placeholder={`Word ${i + 1}`}\n                bind:value={wordInputs[i]}\n                disabled={isRestoring}\n                autocomplete=\"off\"\n              />\n            </div>\n          {/each}\n        </div>\n      {/if}\n\n      {#if validationError || $authStore.error}\n        <div class=\"alert alert-error mt-4\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"stroke-current shrink-0 h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n          </svg>\n          <span>{validationError || $authStore.error}</span>\n        </div>\n      {/if}\n\n      <div class=\"card-actions justify-center mt-4\">\n        <button\n          class=\"btn btn-primary btn-lg w-full sm:w-auto px-8\"\n          on:click={handleRestore}\n          disabled={isRestoring}\n        >\n          {#if isRestoring}\n            <span class=\"loading loading-spinner\"></span>\n            Restoring...\n          {:else}\n            Restore Account\n          {/if}\n        </button>\n      </div>\n\n      <div class=\"divider\">OR</div>\n\n      <button\n        class=\"btn btn-ghost btn-sm\"\n        on:click={() => dispatch('success', { publicKey: '', privateKey: '' })}\n      >\n        Create a new account\n      </button>\n    </div>\n  </div>\n</div>\n","<script lang=\"ts\">\n  import Login from '$lib/components/auth/Login.svelte';\n  import { goto } from '$app/navigation';\n  import { base } from '$app/paths';\n  import { authStore } from '$lib/stores/auth';\n\n  function handleSuccess(event: CustomEvent<{ publicKey: string; privateKey: string }>) {\n    const { publicKey, privateKey } = event.detail;\n    authStore.setKeys(publicKey, privateKey);\n    goto(`${base}/chat`);\n  }\n</script>\n\n<svelte:head>\n  <title>Login - Minimoomaa Noir</title>\n</svelte:head>\n\n<Login on:success={handleSuccess} />\n"],"names":["ctx","i","insert_hydration","target","div","anchor","append_hydration","label0","input","label1","textarea","t1_value","attr","label","span","set_input_value","dirty","svg","path","set_data","t1","create_if_block_2","create_if_block_3","create_if_block_1","create_if_block","toggle_class","button0","button1","button2","div6","div5","div4","h2","div0","div1","div2","button3","div3","button4","dispatch","createEventDispatcher","inputMode","pastedMnemonic","wordInputs","privateKeyInput","isRestoring","validationError","switchMode","mode","handleRestore","authStore","resolve","publicKey","privateKey","result","restoreFromNsecOrHex","mnemonic","w","restoreFromMnemonic","error","$$invalidate","handlePaste","event","words","click_handler","click_handler_1","click_handler_2","handleSuccess","goto","base"],"mappings":"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"}