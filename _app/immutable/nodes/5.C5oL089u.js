import{s as fe,n as z,d,i as j,m as he,g as M,v as ae,j as N,k as ne,p as _e,w as pe,l as u,c as p,o as Q,h as m,r as me,a as O,x as re,b as c,q as R,y as ve,e as y,f as x,t as P}from"../chunks/KqBazuOQ.js";import{e as ie,u as be,d as ge}from"../chunks/C0GVxn2f.js";import{S as ye,i as ke}from"../chunks/327BRBa5.js";import{g as G}from"../chunks/BbCkqOyh.js";import{p as Ie}from"../chunks/B6kj3SMy.js";import{b as J}from"../chunks/BW0F1I6S.js";import{n as Ee,c as De}from"../chunks/Dv69-Pkj.js";import{a as Se}from"../chunks/BdGy27T3.js";const Te=!1,Ve=async({params:n})=>({channelId:n.channelId,channel:null,messages:[]}),ze=Object.freeze(Object.defineProperty({__proto__:null,load:Ve,prerender:Te},Symbol.toStringTag,{value:"Module"}));function oe(n,e,t){const s=n.slice();return s[13]=e[t],s}function Ce(n){let e,t,s,i,o="‚Üê Back to Channels",l,a,r=n[0].name+"",E,D,g,h,S,C,w,_,I,k,K,V,L=n[4]?"Sending...":"Send",B,F,A,W,b=n[0].description&&ce(n);function X(f,v){return f[1].length===0?Ne:Me}let U=X(n),T=U(n);return{c(){e=m("div"),t=m("div"),s=m("div"),i=m("button"),i.textContent=o,l=N(),a=m("h1"),E=P(r),D=N(),b&&b.c(),g=N(),h=m("div"),S=m("div"),T.c(),C=N(),w=m("div"),_=m("div"),I=m("form"),k=m("input"),K=N(),V=m("button"),B=P(L),this.h()},l(f){e=p(f,"DIV",{class:!0});var v=y(e);t=p(v,"DIV",{class:!0});var Y=y(t);s=p(Y,"DIV",{class:!0});var H=y(s);i=p(H,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(i)!=="svelte-1ccmdp8"&&(i.textContent=o),l=M(H),a=p(H,"H1",{class:!0});var Z=y(a);E=x(Z,r),Z.forEach(d),D=M(H),b&&b.l(H),H.forEach(d),Y.forEach(d),g=M(v),h=p(v,"DIV",{class:!0});var $=y(h);S=p($,"DIV",{class:!0});var ee=y(S);T.l(ee),ee.forEach(d),$.forEach(d),C=M(v),w=p(v,"DIV",{class:!0});var te=y(w);_=p(te,"DIV",{class:!0});var se=y(_);I=p(se,"FORM",{class:!0});var q=y(I);k=p(q,"INPUT",{type:!0,class:!0,placeholder:!0}),K=M(q),V=p(q,"BUTTON",{type:!0,class:!0});var le=y(V);B=x(le,L),le.forEach(d),q.forEach(d),se.forEach(d),te.forEach(d),v.forEach(d),this.h()},h(){u(i,"class","btn btn-ghost btn-sm mb-2"),u(a,"class","text-2xl font-bold"),u(s,"class","container mx-auto max-w-4xl"),u(t,"class","bg-base-200 border-b border-base-300 p-4"),u(S,"class","container mx-auto max-w-4xl"),u(h,"class","flex-1 overflow-y-auto p-4 bg-base-100"),u(k,"type","text"),u(k,"class","input input-bordered flex-1"),u(k,"placeholder","Type a message..."),k.disabled=n[4],u(V,"type","submit"),u(V,"class","btn btn-primary"),V.disabled=F=n[4]||!n[2].trim(),u(I,"class","flex gap-2"),u(_,"class","container mx-auto max-w-4xl"),u(w,"class","bg-base-200 border-t border-base-300 p-4"),u(e,"class","flex flex-col h-[calc(100vh-64px)]")},m(f,v){j(f,e,v),c(e,t),c(t,s),c(s,i),c(s,l),c(s,a),c(a,E),c(s,D),b&&b.m(s,null),c(e,g),c(e,h),c(h,S),T.m(S,null),n[9](h),c(e,C),c(e,w),c(w,_),c(_,I),c(I,k),re(k,n[2]),c(I,K),c(I,V),c(V,B),A||(W=[R(i,"click",n[8]),R(k,"input",n[10]),R(I,"submit",ve(n[6]))],A=!0)},p(f,v){v&1&&r!==(r=f[0].name+"")&&O(E,r),f[0].description?b?b.p(f,v):(b=ce(f),b.c(),b.m(s,null)):b&&(b.d(1),b=null),U===(U=X(f))&&T?T.p(f,v):(T.d(1),T=U(f),T&&(T.c(),T.m(S,null))),v&16&&(k.disabled=f[4]),v&4&&k.value!==f[2]&&re(k,f[2]),v&16&&L!==(L=f[4]?"Sending...":"Send")&&O(B,L),v&20&&F!==(F=f[4]||!f[2].trim())&&(V.disabled=F)},d(f){f&&d(e),b&&b.d(),T.d(),n[9](null),A=!1,me(W)}}}function we(n){let e,t='<div class="loading loading-spinner loading-lg text-primary"></div>';return{c(){e=m("div"),e.innerHTML=t,this.h()},l(s){e=p(s,"DIV",{class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-mo2ait"&&(e.innerHTML=t),this.h()},h(){u(e,"class","flex justify-center items-center h-[calc(100vh-64px)]")},m(s,i){j(s,e,i)},p:z,d(s){s&&d(e)}}}function ce(n){let e,t=n[0].description+"",s;return{c(){e=m("p"),s=P(t),this.h()},l(i){e=p(i,"P",{class:!0});var o=y(e);s=x(o,t),o.forEach(d),this.h()},h(){u(e,"class","text-base-content/70 text-sm")},m(i,o){j(i,e,o),c(e,s)},p(i,o){o&1&&t!==(t=i[0].description+"")&&O(s,t)},d(i){i&&d(e)}}}function Me(n){let e,t=[],s=new Map,i=ie(n[1]);const o=l=>l[13].id;for(let l=0;l<i.length;l+=1){let a=oe(n,i,l),r=o(a);s.set(r,t[l]=de(r,a))}return{c(){e=m("div");for(let l=0;l<t.length;l+=1)t[l].c();this.h()},l(l){e=p(l,"DIV",{class:!0});var a=y(e);for(let r=0;r<t.length;r+=1)t[r].l(a);a.forEach(d),this.h()},h(){u(e,"class","space-y-4")},m(l,a){j(l,e,a);for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(e,null)},p(l,a){a&2&&(i=ie(l[1]),t=be(t,a,o,1,l,i,s,e,ge,de,null,oe))},d(l){l&&d(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function Ne(n){let e,t="<p>No messages yet. Start the conversation!</p>";return{c(){e=m("div"),e.innerHTML=t,this.h()},l(s){e=p(s,"DIV",{class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-jcsddy"&&(e.innerHTML=t),this.h()},h(){u(e,"class","flex items-center justify-center h-full text-base-content/50")},m(s,i){j(s,e,i)},p:z,d(s){s&&d(e)}}}function de(n,e){let t,s,i=e[13].content+"",o,l,a,r=ue(e[13].created_at)+"",E,D;return{key:n,first:null,c(){t=m("div"),s=m("div"),o=P(i),l=N(),a=m("div"),E=P(r),D=N(),this.h()},l(g){t=p(g,"DIV",{class:!0});var h=y(t);s=p(h,"DIV",{class:!0});var S=y(s);o=x(S,i),S.forEach(d),l=M(h),a=p(h,"DIV",{class:!0});var C=y(a);E=x(C,r),C.forEach(d),D=M(h),h.forEach(d),this.h()},h(){u(s,"class","chat-bubble"),u(a,"class","chat-footer opacity-50 text-xs"),u(t,"class","chat chat-start"),this.first=t},m(g,h){j(g,t,h),c(t,s),c(s,o),c(t,l),c(t,a),c(a,E),c(t,D)},p(g,h){e=g,h&2&&i!==(i=e[13].content+"")&&O(o,i),h&2&&r!==(r=ue(e[13].created_at)+"")&&O(E,r)},d(g){g&&d(t)}}}function je(n){let e,t,s;document.title=e=(n[0]?.name||"Channel")+" - Fairfield Nostr";function i(a,r){if(a[3])return we;if(a[0])return Ce}let o=i(n),l=o&&o(n);return{c(){t=N(),l&&l.c(),s=ae()},l(a){he("svelte-1m1z3s6",document.head).forEach(d),t=M(a),l&&l.l(a),s=ae()},m(a,r){j(a,t,r),l&&l.m(a,r),j(a,s,r)},p(a,[r]){r&1&&e!==(e=(a[0]?.name||"Channel")+" - Fairfield Nostr")&&(document.title=e),o===(o=i(a))&&l?l.p(a,r):(l&&l.d(1),l=o&&o(a),l&&(l.c(),l.m(s.parentNode,s)))},i:z,o:z,d(a){a&&(d(t),d(s)),l&&l.d(a)}}}function ue(n){return new Date(n*1e3).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}function He(n,e,t){let s,i,o;ne(n,Se,_=>t(12,i=_)),ne(n,Ie,_=>t(7,o=_));let l=null,a=[],r="",E=!0,D=!1,g;_e(async()=>{if(!i.isAuthenticated){G(`${J}/`);return}try{const _=await Ee.getNDK(),I=await De.fetchChannels(_,i.publicKey,["business","moomaa-tribe"]);if(t(0,l=I.find(k=>k.id===s)||null),!l){G(`${J}/chat`);return}t(1,a=[])}catch(_){console.error("Error loading channel:",_)}finally{t(3,E=!1)}});async function h(){if(!r.trim()||D||!l)return;t(4,D=!0);const _=r;t(2,r="");try{console.log("Sending message:",_)}catch(I){console.error("Error sending message:",I),t(2,r=_)}finally{t(4,D=!1)}}const S=()=>G(`${J}/chat`);function C(_){pe[_?"unshift":"push"](()=>{g=_,t(5,g)})}function w(){r=this.value,t(2,r)}return n.$$.update=()=>{n.$$.dirty&128&&(s=o.params.channelId)},[l,a,r,E,D,g,h,o,S,C,w]}class Ke extends ye{constructor(e){super(),ke(this,e,He,je,fe,{})}}export{Ke as component,ze as universal};
//# sourceMappingURL=5.C5oL089u.js.map
