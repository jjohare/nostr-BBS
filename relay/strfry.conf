# Fairfield Private Relay Configuration
# strfry.conf - Private community relay with NIP-42 auth

##
## Database Location
##
db = "/app/strfry-db/"

relay {
    # Relay Information (NIP-11)
    name = "Fairfield Private Relay"
    description = "Private relay for Fairfield community"
    pubkey = ""  # Set to admin hex pubkey if desired
    contact = ""

    # Bind settings - internal only (nginx proxies)
    bind = "127.0.0.1"
    port = 7777

    # No TLS (cloudflared handles HTTPS)
    noTLS = true

    # Connection limits
    maxWebsocketPayloadKB = 131072

    # Rate limiting
    autoPingSeconds = 55
    enableTCPKeepalive = false

    # Query limits
    maxFilterLimit = 500
    maxSubsPerConnection = 20
}

##
## Event Validation
##
events {
    # Timestamp validation
    rejectEventsNewerThanSeconds = 900
    rejectEventsOlderThanSeconds = 94608000
    rejectEphemeralEventsOlderThanSeconds = 60
    ephemeralEventsLifetimeSeconds = 300

    # Size limits
    maxEventSize = 65536
    maxNumTags = 2000
    maxTagValSize = 1024
}

##
## Write Policy
## Uncomment to enable authentication plugin
##
# writePolicy {
#     plugin = "/app/plugins/auth-whitelist.js"
# }

##
## Negentropy Sync
##
negentropy {
    enabled = true
    maxSyncEvents = 1000000
}

##
## Database Parameters
##
dbParams {
    maxreaders = 256
    mapsize = 1073741824  # 1GB
}

##
## Compression
##
compression {
    enabled = true
    level = 3
}

##
## Logging
##
logging {
    level = "info"
}

##
## Supported NIPs: 1, 2, 9, 11, 28, 29, 42, 44, 52, 59
##
